<<<<<<< HEAD
module.exports=function(n){var o={};function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=n,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t){e.exports=require("path")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("jsonfile")},function(e,t,n){function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,t=function(){};return{s:t,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw r}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/** @license Anzii 
 * react.development.js
 *
 * Copyright (c) IIprodakts PTY (LTD), and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l=n(2),d=n(8),u=n(9),r=n(10),f=n(11),h=n(0),s=n(12);e.exports={EMAIL:"",PASSWORD:"",PROMPT:process.argv||[],p_o_freeze:function(e){return e instanceof Object?Object.freeze(e):null},p_clone:function(e){return e instanceof Object?JSON.parse(JSON.stringify(e)):null},p_deepMerge:function(e,t){return r(!0,t,e)},p_ane:function(e){if(d.isError(e))throw e},p_initArray:function(e,t){for(var n=[],o=this.p_isFunction(t),r=0;r<e;r++)n.push(o?t(r):t);return n},p_escapeRegExp:function(e){return RegExpUtils.escape(e)},p_merge:function(e,n){return p_forEach(e,function(e,t){n[t]=e}),n},p_union:function(e,t){var n={};return p_merge(e,n),p_merge(t,n),n},p_getTasks:function(e,t){for(var n=[],o=0;o<e.length;o++)n.push(t(e,o));return n},p_wrapTask:function(t,n,o){return d.isArray(o)||(o=[]),function(e){o.push(e),n.apply(t,o)}},p_wrapTimedTask:function(e,t,r,n){p_isString(n)&&(r=n,n=[]);var s=p_wrapTask(e,t,n);return function(n){var o=Date.now();s(function(e,t){n(e,{result:t,time:Date.now()-o,start:o,name:r})})}},p_forEach:function(n,o){var e,t;if(d.isArray(n))e=o,t=n;else{if(!p_isObject(n))return!1;t=Object.getOwnPropertyNames(n),e=function(e,t){o(n[e],e,n,t)}}t.forEach(e)},p_arrayToHash:function(e,t){if(!d.isArray(e))return null;p_isNullOrUndefined(t)&&(t=!0);for(var n={},o=0;o<e.length;o++)this.p_isFunction(t)?n[t(e,o)]=e[o]:n[e[o]]=t;return n},p_unikify:function(e){for(var t=e.concat(),n=0;n<t.length;++n)for(var o=n+1;o<t.length;++o)t[n]===t[o]&&t.splice(o--,1);return t},p_arrayToObj:function(e,t,n){if(!d.isArray(e))return null;var o=p_isString(t),r=this.p_isFunction(t);if(!o&&!r)return null;var s=p_isString(n),i=this.p_isFunction(n);s||i||(n=null);for(var a={},l=0;l<e.length;l++){var c=e[l],u=o?c[t]:t(e,l);a[u]=s?c[n]:i?n(e,l):c}return a},p_objArrayToHash:function(e,t){if(!d.isArray(e))return null;for(var n={},o=0;o<e.length;o++)n[e[o][t]]=e[o];return n},p_hashToArray:function(n,o){if(!p_isObject(n))return null;var r=p_isString(o);return Object.keys(n).reduce(function(e,t){return e.push(n[t]),r&&(n[t][o]=t),e},[])},p_invertHash:function(e){if(!p_isObject(e))return null;var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[e[t]]=t);return n},p_copyArray:function(e){if(!d.isArray(e))return null;for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},p_dedupeArray:function(e){e=p_arrayToHash(e);return Object.keys(e)},p_arrayPushAll:function(e,t){if(!d.isArray(e)||!d.isArray(t))return!1;for(var n=0;n<e.length;n++)t.push(e[n])},p_cb:function(){},p_generateUniqueID:function(){return s.v4()},p_isObject:function(e){return!this.p_isNullOrUndefined(e)&&"object"===o(e)},p_isString:function(e){return!this.p_isNullOrUndefined(e)&&"string"==typeof e},p_isFunction:function(e){return!this.p_isNullOrUndefined(e)&&"function"==typeof e},p_isNullOrUndefined:function(e){return null==e},p_isBoolean:function(e){return!0===e||!1===e},p_getDirectories:function(i){var a=this;return new Promise(function(n,r){var s=[];f.readdir(i,function(e,t){if(d.isError(e))return r(e);t=a.p_getTasks(t,function(e,t){return function(n){var o=h.join(i,e[t]);f.stat(o,function(e,t){return d.isError(e)?r(e):(a.p_isNullOrUndefined(t)?console.log("WARN: Util: unstatable file encountered: %s",o):t.isDirectory()&&s.push(o),void n(e))})}});u.parallel(t,function(e){n(s)})})})},p_getFiles:function(i,a,l){var c=this;return new Promise(function(o,n){a=a||{recursive:!1,filter:function(){return!0}},console.log("The directory path"),console.log(i),console.log(l),f.readdir(i,function(e,r){if(d.isError(e))return n(e);console.log("The readdir results q"),console.log(r);for(var t=0;t<r.length;t++)console.log(),r[t]=h.join(i,r[t]);var s=[];u.whilst(function(){return 0<r.length},function(n){var o=r.shift();f.stat(o,function(e,t){if(d.isError(e))return n(e);e=!0;if(c.p_isFunction(a.filter)&&(e=a.filter(o,t)),e&&s.push(o),!a.recursive||!t.isDirectory())return n(null);f.readdir(o,function(e,t){return d.isError(e)?n(e):(t.forEach(function(e){r.push(h.join(o,e))}),void n(null))})})},function(e){console.log("THE FILES ARRay");var t,n=i+h.sep+l;console.log(n),-1!==s.indexOf(n)?(console.log("THE IS A NEED FOR A SPECIFIC FILE"),n=(t=s[s.indexOf(n)]).substr(n.indexOf(l),t.length-1),console.log(t),console.log(n),o(n)):o(s)})})})},p_getFile:function(o){return new Promise(function(e,t){console.log("The directory path"),console.log(o);var n=f.createReadStream(o);n&&e(n)})},p_isDirectory:function(){},p_mkdirs:function(o,i){var a=this;return new Promise(function(t,n){if(a.p_isFunction(i)&&(i=!1),!a.p_isString(o))return n(new Error("absoluteDirPath must be a valid file path"));var e=o.split(h.sep),r="",s=-1!==l.type().toLowerCase().indexOf("windows"),e=a.p_getTasks(e,function(n,o){return function(t){var e=n[o];if(0===e.length||i&&o>=n.length-1)return t();r+=(s&&0===o?"":h.sep)+e,f.exists(r,function(e){return e?t():void f.mkdir(r,t)})}});u.series(e,function(e){return e?n(e):void t(!0)})})},p_mkdirsSync:function(e,n){if(!this.p_isString(e))throw new Error("absoluteDirPath must be a valid file path");var o=e.split(h.sep),r="",s=-1!==l.type().toLowerCase().indexOf("windows");o.forEach(function(e,t){0===e.length||n&&t>=o.length-1||(r+=(s&&0===t?"":h.sep)+e,f.existsSync(r)||f.mkdirSync(r))})},p_getExtension:function(e,t){if(!this.p_isString(e)||e.length<=0)return null;this.p_isObject(t)||(t={});var n=e.lastIndexOf(t.sep||h.sep)||0;-1<n&&(e=e.substr(n));var o=null,n=e.lastIndexOf(".");return 0<=n&&(o=e.substring(n+1),t.lower&&(o=o.toLowerCase())),o},p_getFileExtensionFilter:function(e){var t="."+e;return function(e){return e.lastIndexOf(t)===e.length-t.length}},p_inherits:function(e,t){if(p_isNullOrUndefined(e)||p_isNullOrUndefined(t))throw new Error("The type parameters must be objects or prototypes");d.inherits(e,t),p_merge(t,e)},js_to_json:function(e){return JSON.stringify(e)},json_to_js:function(e){return JSON.parse(e)},clone:function(e){var t=this;if(e instanceof Array){var n=[];return e.forEach(function(e){e instanceof Array||e instanceof Object?n.push(t.clone(e)):n.push(e)}),n}if(e instanceof Object&&"function"!=typeof e){var o,r={};for(o in e)e[o]instanceof Array||e[o]instanceof Object&&"function"!=typeof e[o]?r[o]=this.clone(e[o]):("callback"===o&&console.log("The current property is callback"),r[o]=e[o]);return r}},object_to_array:function(e,t){if(e instanceof Object){if(e instanceof Array)return e;var n=[],o=0;if(1<arguments.length&&void 0!==t&&t)for(var r in e)n[o]={key:r,value:e[r]},++o;else for(var s in e)n[o]=e[s],++o;return n}this.throwErrors("Argument 1 of object_to_array() must be an object")},array_to_object:function(e){if(e instanceof Array){for(var t={},n=0;n<e.length;n++){t["property_"+(n+1)]=e[n]}return t}this.throwErrors("Argument 1 of array_to_object() must be an array")},string_to_array:function(e,t){if(this.is_string(e))return e.split(t)},set_deeply:function(e,t,n,o){var r=2<arguments.length&&void 0!==n?n:null,s=3<arguments.length&&void 0!==o?o:null;return 1===e.length?(console.log("ABOUT TO SET DEEPLY NESTED PROP"),console.log("THE DEEP"),console.log(t),r?t[e[0]]=r:(console.log("THIS DEEP ARRAY"),console.log(this.js_to_json(t)),console.log("THE DEEP I,i"),t.splice(e[0],1),console.log(t)),console.log(e),console.log(e[0]),console.log(t[e]),!0):t[e[0]]?this.set_deeply(e.slice(1),t[e[0]],r,s):(console.log("THE PROPERTY BELOW DOES NOT EXIST"),console.log(e),console.log(e[0]),!1)},get_deeply:function(){},is_function:function(e){return"[object Function]"===Object.prototype.toString.call(e)},is_array:function(e){return"[object Array]"===Object.prototype.toString.call(e)},is_date:function(e){return"[object Date]"===Object.prototype.toString.call(e)},is_object:function(e){return"[object Object]"===Object.prototype.toString.call(e)},is_string:function(e){return"[object String]"===Object.prototype.toString.call(e)},is_value:function(e){return!this.isObject(e)&&!this.isArray(e)},is_not_falsey:function(e){return!!this.trim_spaces(e)},trim_spaces:function(e){return e instanceof String?e.trim():e},compare_values:function(e,t){e!==t&&(this.is_date(e)&&this.is_date(t)&&e.getTime()===t.getTime()||e!==t&&(e=t))},is_equal_ab:function(e,t,n){var o=2<arguments.length&&void 0!==n?n:"values";if(!this.is_object(e)||!this.is_object(t))return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;if("keys"!==o.trim())return this.js_to_json(e)===this.js_to_json(t);Object.keys(e).sort();o=Object.keys(t).sort();return JSON.stringify(aKeys)===JSON.stringify(o)},is_valid_email:function(){return!0},is_valid_password:function(){return!0},is_same_value:function(e,t){return this.isBrowserSupported("Object","is")?Object.is(e,t):this.polyFills().objectIs(e,t)},unlike_props:function(e,t){var n=Object.keys(e),o=Object.keys(t);if(e.length>t.length){var r=null,s=c(n);try{for(s.s();!(i=s.n()).done;){var i=i.value;e[i]!==t[i]&&(r?r.a.push(i):r={a:[i]})}}catch(e){s.e(e)}finally{s.f()}return r}var a=c(o);try{for(a.s();!(l=a.n()).done;){var l=l.value;t[l]!==e[l]&&(unlike?unlike.b.push(l):unlike={b:[l]})}}catch(e){a.e(e)}finally{a.f()}return unlike},throwErrors:function(e){throw new Error(e)},contains:function(e,t){if(this.is_array(e))return-1<e.indexOf(t);if(this.is_object(e)){if(this.is_array(t)){console.log("THE SPECIFED VALUE TO CHECK IS AN ARRAY"),console.log(t);for(var n="",o=0;o<t.length;o++){if(!e.hasOwnProperty(t[o])){n=!1;break}o===t.length-1&&(n=!0)}return console.log("THE OUTCOME"),console.log(n),n}return!!e.hasOwnProperty(t)}this.throwErrors("Contains() requires either an array pure js object")},for_of:function(e,t,n){var o=2<arguments.length&&void 0!==n?n:null;if(e=this.clone(e),this.is_array(e))e.forEach(t);else if(this.is_object(e)){if(!o){var r,s={};for(r in e){var i=t(r,e[r]);s[i.p]=i.v}return s}for(var a in e)t(a,e[a])}else this.throwErrors("Object of for_of() must be an Array or pure object")},add_values_to:function(o,e,r){if(this.is_array(o))o.forEach(action);else{if(this.is_object(o))return e.forEach(function(t,e){var n=Object.keys(r[t]);o[t]?n.forEach(function(e){o[t][e]=r[e]}):(o[t]={},n.forEach(function(e){o[t][e]=r[e]}))}),o;this.throwErrors("Object of for_of() must be an Array or pure object")}},find_in:function(e,t,n){if(this.is_array(e)){if(this.is_value(e[0]))return-1<e.indexOf(n)&&e[n];if(this.is_object(e[0]))for(var o=0;o<e.length;o++)if(sb.sb_contains(e[o],t)&&e[o][t]===n)return e[o]}}}},function(e,t,n){n(6),e.exports=n(7)},function(e,t){e.exports=require("@babel/polyfill")},function(e,t,n){var o=n(22).default;e.exports=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e?o.Activate([e]):o.Activate()}},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("async")},function(e,t){e.exports=require("node.extend")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("uuid")},function(e,t){e.exports=require("express")},function(e,t,n){"use strict";n.r(t),t.default={router:[{path:"/greeting/:name/:surname",alias:"hello",method:"GET",type:"public"}],logger:{level:"info"},cluster:{workers:3,spawn:!0},server:"server"}},function(e,t){e.exports=require("config")},function(e,t){e.exports=require("supports-color")},function(e,t){e.exports=require("winston")},function(e,t){e.exports=require("debug")},function(e,t){e.exports=require("cluster")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("mysql")},function(e,t,n){"use strict";n.r(t);var o=n(4),r=n.n(o);function s(e){this.PILLAR=e,this.modules={},this.globalModules=[],this.PROMPT=this.PILLAR.PROMPT}s.prototype.createModule=function(e,t,n,o){var r=this.modules;if(this.sanna().runForModules(e,o),0<Object.keys(r).length)for(var s in r)s===t||(this.modules[t]={}),this.modules[t][n]=e;else this.modules[t]={},this.modules[t][n]=e},s.prototype.events=function(){var o=this.PILLAR;return{addEventHandler:function(e,t,n){if("undefined"==typeof window)return o.ev_addHandler(e,t,n);o.ev_addHandler(e,t,n)},removeEventHandler:function(e,t,n){o.ev_removeHandler(e,t,n)},getEvent:function(e){return o.getEvent(e)},getTarget:function(e){return o.getTarget(e)},preventNormal:function(e){o.preventDefault(e)},stopEventBubble:function(e){o.stopPropagation(e)}}},s.prototype.ajax=function(){var s=this.PILLAR;return{get:function(e,t,n,o,r){s.ajax_get(e,t,n,o,r)},post:function(e,t,n,o,r){s.ajax_post(e,t,n,o,r)}}},s.prototype.validators=function(){var o=this.PILLAR;return{isFunction:function(e){return o.is_function(e)},isArray:function(e){return o.is_array(e)},isDate:function(e){return o.is_date(e)},isObject:function(e){return o.is_object(e)},isString:function(e){return o.is_string(e)},isValue:function(e){return o.is_value(e)},isNotFalsey:function(e){return o.is_not_falsey(e)},trimSpaces:function(e){return o.trim_spaces(e)},isEqualab:function(e,t,n){n=2<arguments.length&&void 0!==n?n:null;return o.is_equal_ab(e,t,n)},isSameValue:function(e,t){return o.is_same_value(e,t)},isValidEmail:function(e){return o.is_valid_email(e)},isValidPassword:function(e){return o.is_valid_password(e)},unlikeProps:function(e,t){return o.unlike_props(e,t)},contains:function(e,t){return o.contains(e,t)},forOf:function(e,t,n){return o.for_of(e,t,n)},addValuesTo:function(e,t,n){return o.add_values_to(e,t,n)},findIn:function(e,t,n){return o.find_in(e,t,n)}}},s.prototype.util=function(){var o=this.PILLAR;return{makeDirs:function(e,t,n){return o.p_mkdirs(e,t,n)},mkdirsSync:function(e,t,n){return o.p_mkdirs(e,t,n)},getFiles:function(e,t,n){return o.p_getFiles(e,t,n)},getFile:function(e){return o.p_getFile(e)},getDirectories:function(e){return o.p_getDirectories(e)},getExtension:function(e,t){return o.p_getExtension(e,t)},generateUniqueID:function(){return o.p_generateUniqueID()},unikify:function(e){return o.p_unikify(e)}}},s.prototype.registerEvents=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";e&&t&&n&&this.modules[t][n]&&(this.modules[t][n].events=e)},s.prototype.triggerEvent=function(e){if(e)for(var t in this.modules)if(this.modules.hasOwnProperty(t))for(var n in t=this.modules[t])t[n].events&&t[n].events[e.type]&&t[n].events[e.type](e.data)},s.prototype.startModule=function(e,t){this.modules[e][t]&&("anziiloger"!==e&&(console.log("not A LOGGER MODULE"),console.log(this.modules[e][t].getClassName),console.log(this.modules[e][t].getClassName()),this.modules.anziiloger.anziiloger.setDebugger(this.modules[e][t].getClassName())),this.modules[e][t].init(),"global"===e&&(console.log("THE GLOBAL MODULES IS ABOUT TO RECEIVE MODULES"),this.modules[e][t].globals=Object.keys(this.modules)))},s.prototype.startAllModules=function(){for(var e in this.modules){var t,n=this.modules[mod];for(t in n)try{this.modules[n][t].init()}catch(e){console.log(e)}}},s.prototype.stopModule=function(e,t){this.modules[e][t]&&this.modules[e][t].destroy()},s.prototype.stopAllModules=function(){for(var e in this.modules){var t,n=this.modules[mod];for(t in n)try{this.modules[n][t].destroy()}catch(e){console.log(e)}}},s.prototype.converts=function(){var n=this.PILLAR;return{jsToJson:function(e){return n.js_to_json(e)},jsonToJs:function(e){return n.json_to_js(e)},clone:function(e){return n.clone(e)},objectToArray:function(e,t){e=0<arguments.length&&void 0!==e?e:{},t=1<arguments.length&&void 0!==t&&t;return n.object_to_array(e,t)},stringToArray:function(e,t){return n.string_to_array(e,t)}}},s.prototype.sanna=function(){var t=this;return{modules:{validators:{emit:function(e){if(e.hasOwnProperty("emit")){if("function"!=typeof e.emit)throw new Error("Emit is a reserved Akii method")}else e.emit=t.sanna().modules.addiks.emit.bind(e)},listens:function(e){if(e.hasOwnProperty("listens")){if("function"!=typeof e.listens)throw new Error("Listens is a reserved ANZii method")}else e.listens=t.sanna().modules.addiks.listens.bind(e)},log:function(e){e.log=t.sanna().modules.addiks.log.bind(e)},logSync:function(e){e.logSync=t.sanna().modules.addiks.log.bind(e)},getClassName:function(e){e.getClassName=t.sanna().modules.addiks.getClassName.bind(e)},query:function(e){e.query=t.sanna().modules.addiks.query.bind(e)}},addiks:{emit:function(e){this.pao.pa_notifyEvent({type:e.type,data:e.data})},listens:function(e){var t=this.pao;this.log("MODULE",this.getClassName(),"listens to event(s):",e);var n=t.moduleMeta.moduleId,o=t.moduleMeta.modInstId;t.pa_notifyListen(e,n,o)},log:function(e,t){e=0<arguments.length&&void 0!==e?e:"No message provided",t=1<arguments.length&&void 0!==t?t:"console",this.pao,t={message:e,type:t};t.source=this.getClassName(),this.emit({type:"anziiloger-log",data:t})},logSync:function(e,t){e=0<arguments.length&&void 0!==e?e:"No message provided",t=1<arguments.length&&void 0!==t?t:"console",this.pao,t={message:e,type:t};t.source=this.getClassName(),t.sync=!0,this.emit({type:"anziiloger-log",data:t})},getClassName:function(){var e=this.pao;return console.log("GET CLASSNAME"),e.moduleMeta.className},query:function(e,t,n){var o=0<arguments.length&&void 0!==e?e:null,r=1<arguments.length&&void 0!==t?t:null,e=2<arguments.length&&void 0!==n?n:null,t=this.pao;if(!o||!r)throw new Error("Query method missing required parameters");n=t.pa_isString(o)?t.pa_stringToArray(o,"."):o;console.log(t.pa_stringToArray),console.log(n),3===n.length?(t={vendor:n[0],table:n[1],operation:n[2]},this.emit({type:"data-hive-request",data:{model:t,document:r,handler:e}})):(o[1].trim(),n={vendor:n[0],table:n[1].toLowerCase(),operation:n[1].toLowerCase()},this.emit({type:"data-hive-request",data:{model:n,document:r,handler:e}}))}}},runForModules:function(e,t){var n,o=this.modules.validators;for(n in o)o[n](e,t)}}};var i=s;function a(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function l(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function c(e){this.core=e,this.PROMPT=e.PROMPT}c.prototype.create=function(e,t,n){var o=this.core,r=o.validators().forOf(o.util(),function(e,t){return{p:["pa_".concat(e)],v:t}}),s=o.validators().forOf(o.converts(),function(e,t){return{p:["pa_".concat(e)],v:t}}),i=o.validators().forOf(o.validators(),function(e,t){return{p:["pa_".concat(e)],v:t}});return l(l(l(l({moduleMeta:t?{moduleId:e,modInstId:t,className:n}:{moduleId:e,modInstId:e,className:n}},r),i),s),{},{pa_notifyListen:function(e,t,n){e=0<arguments.length&&void 0!==e?e:{},t=1<arguments.length&&void 0!==t?t:"",n=2<arguments.length&&void 0!==n?n:"";console.log("The notifyListen event has been successfuly invoked"),console.log(e),console.log(t),console.log(n),o.registerEvents(e,t,n)},pa_notifyEvent:function(e){e=0<arguments.length&&void 0!==e?e:{};o.triggerEvent(e)}})};var u=c;var d=new function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.CORE=i,this.PAO=u,this.PILLAR=r.a};function f(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function h(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function p(){this.log("Middleware has been initialised"),this.listens({"config-middleware":this.handleConfigMiddleware.bind(this),"add-ext-middleware":this.handleAddExternalMiddleware.bind(this),"attach-middleware":this.handleAttachMiddleware.bind(this)})}function g(e){this.attachMiddleware(e)}function m(e){var t,o=this,r=e;for(t in r)!function(n){o.middlewares[n]?r[n].addMiddleware&&r[n].addMiddleware.forEach(function(e,t){o.middlewares[n].push(e)}):r[n].addMiddleware&&(o.middlewares[n]=h({},r[n].addMiddleware))}(t)}function E(e){var n=this,t=n.pao;n.log("ADD EXTERNAL MIDDLEWARE EVENT HAS OCCURED"),e.type&&("private"===e.type?"top"===e.level&&(t.pa_isArray(e.middleware.funk)?e.middleware.forEach(function(e,t){n.middleware.unshift({type:"function",value:e.funk,ext:!0})}):(n.log("THE MIDDLEWARES BEFORE"),n.log(n.middlewares),n.middlewares.pprivate&&(t=Object.keys(n.middlewares.pprivate).length,n.middlewares.pprivate[t]={type:"function",value:e.middleware.funk,ext:!0},n.log("Middlewares"),n.log(n.middlewares)))):"public"===e.type||"all"===e.type&&e.level)}function O(n){var e=this;n.app&&(0<e.all.length&&(console.log("THE Allwares is greater than zero"),n.xpress&&e.allWares(n.app,n.xpress)),e.middlewares.pprivate&&e.middlewares.ppublic?e.emit({type:"router-middleware",data:{middleware:{public:e.middlewares.ppublic,private:e.middlewares.pprivate}}}):e.middlewares.private?e.emit({type:"router-middleware",data:{middleware:{private:e.middlewares.pprivate}}}):e.middlewares.public&&e.emit({type:"router-middleware",data:{middleware:{public:e.middlewares.ppublic}}}),e.middlewares.all&&e.middlewares.all.forEach(function(e,t){"function"===e.type?n.app.use(e.value):e.type}))}function v(n,o){var r=this,s=r.pao;r.all.forEach(function(e,t){s.pa_isObject(e)?(console.log("Executing allwares"),e.use?(console.log("The public:",e.call),n.use(o[e.call]("public"))):(console.log("The none-public:",e.call),n.use(o[e.call]()))):(r.log("middleware is string"),n.use(o[e]()))})}function b(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),this.pao=e,this.all=[{call:"static",use:"public"},"json"],this.middlewares={all:[{type:"function",value:function(e,t,n){console.log("I am the zeenith ware"),t.header("Access-Control-Allow-Origin","*"),t.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),n()}}]},this.init=p,this.handleAttachMiddleware=g,this.attachMiddleware=O,this.handleConfigMiddleware=m,this.handleAddExternalMiddleware=E,this.allWares=v}function y(){this.log("Parsers has been initialised"),this.listens({"share-middleware":this.handleShareMiddleware.bind(this)})}function T(){console.log("HANLDE SHARE MIDDLEWARE EVENT HAS OCCURED"),this.emit({type:"add-ext-middleware",data:{type:"all",level:"top",middleware:{funk:[{body:this.dependiks.bodyParser,call:"json"}]}}})}n(1);function S(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,S),this.pao=e,this.path=w,this.dependiks={jsonfile:R,bodyParser:N},this.init=y,this.handleShareMiddleware=T}var R=n(3),w=n(0),N=n(1);function I(e,t,n,o,r,s,i){try{var a=e[s](i),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(o,r)}function k(a){return function(){var e=this,i=arguments;return new Promise(function(t,n){var o=a.apply(e,i);function r(e){I(o,t,n,r,s,"next",e)}function s(e){I(o,t,n,r,s,"throw",e)}r(void 0)})}}function A(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function C(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?A(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function D(){console.log("Router has been initialised"),this.listens({"config-router":this.handleConfigRouter.bind(this),"router-middleware":this.handleRouterMiddleware.bind(this),"attach-routes":this.handleAttachRoutes.bind(this)})}function x(e){console.log("THE HANDLE CONFIG ROUTER MODULE"),this.routes=e}function H(e){console.log("THE ROUTER MIDDLEWARE"),console.log(e),this.routerMiddleware=e.middleware}function P(e){this.attachRoutes(e)}function _(n){var o,r,s=this;n.app&&(o=[],r=[],n.app.use("/",n.router),s.routes?(s.routes.forEach(function(e,t){e.alias&&(o.push(e.path.split("/")[1]),r.push(e.alias)),e.router=n.router,s.renderRoute(e)}),0<o.length&&s.emit({type:"router-alias-list",data:{aliasList:o,handlers:r}})):(s.logSync("Anzii is rendering default routes::"),[{path:"/test",method:"POST",type:"public"},{path:"/test",method:"GET",type:"public"},{path:"/",method:"GET",type:"public"}].forEach(function(e,t){e.alias&&(o.push(e.path.split("/")[1]),r.push(e.alias)),e.router=n.router,s.renderRoute(e)})))}function j(e){var t=this,n=this.pao,o={router:e.router,method:e.method,path:e.path,handOver:t.handOver};e.middlewares?(t.routerMiddleware&&t.routerMiddleware[e.type]?(t.middlewareType(e.type,e.middlewares),t.middlewareType(e.type,n.pa_objectToArray(t.routerMiddleware[e.type]))):t.middlewareType(e.type,e.middlewares),t.appendRouter(C({middleware:t["filtered".concat(e.type,"Middlewares")]},o))):t.routerMiddleware&&t.routerMiddleware[e.type]?(t.middlewareType(e.type,n.pa_objectToArray(t.routerMiddleware[e.type])),t.appendRouter(C({middleware:t["filtered".concat(e.type,"Middlewares")]},o))):t.appendRouter(o)}function F(e){e.middleware?e.router[e.method.toLowerCase()](e.path,e.middleware,e.handOver.bind(this)):e.router[e.method.toLowerCase()](e.path,e.handOver.bind(this))}function L(n,e){var o=this;e.forEach(function(e,t){"function"===e.type?o["filtered".concat(n,"Middlewares")].push(e.value):"module"===e.type&&o.emit({type:"add-".concat(e.value,"-middleware"),data:{type:n,filterCallback:o.filterCallback.bind(o)}})})}var q=function(){var e=k(regeneratorRuntime.mark(function e(t,n){var o,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=this,e.next=3,o.log("THE OUTOFROUTERCONTEXT REQUESTS");case 3:return e.next=5,o.log(t.originalUrl);case 5:return r={error:!0,type:"NotFound",code:404,message:"Resource was not found: OutOfContext"},e.abrupt("return",o.emit({type:"write-server-request-response",data:{data:r,res:n}}));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();function M(e,t){return U.apply(this,arguments)}function U(){return(U=k(regeneratorRuntime.mark(function e(t,n){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=this,e.next=3,o.log("THE CAUGHT REQUEST INSIDE ROUTER::END POINT HIT");case 3:return e.next=5,o.log(t.originalUrl);case 5:return e.next=7,o.log(t.params);case 7:return e.next=9,o.log(t.body);case 9:return e.abrupt("return",o.emit({type:"request-handover",data:{req:t,res:n}}));case 10:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function B(e,t){("public"===e?this.filteredpublicMiddlewares:this.filteredprivateMiddlewares).push(t)}function G(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,G),this.pao=e,this.routes=null,this.routerMiddleware=null,this.filteredpublicMiddlewares=[],this.filteredprivateMiddlewares=[],this.init=D,this.handleConfigRouter=x,this.handleAttachRoutes=P,this.handleRouterMiddleware=H,this.attachRoutes=_,this.renderRoute=j,this.appendRouter=F,this.middlewareType=L,this.outOfRouterContext=q,this.handOver=M,this.filterCallback=B}function J(){console.log("Request has been initialised"),this.listens({"config-request":this.handleConfigRequest.bind(this),"request-handover":this.handleRequestHandOver.bind(this),"request-global-request-response":this.handleRequestGlobalResponse.bind(this),"request-global-request-error":this.handleRequestGlobalError.bind(this),"request-handler-error":this.handleHandlerError.bind(this),"router-alias-list":this.handleRouterAliasList.bind(this)})}function W(e){var t=this;e.forEach(function(e){e.view&&t.views.push(e.path)})}function K(e){var t=this;t.request.res=e.res;var n=t.routesAliasList,o=t.aliatikHandlers,r=t.parseRequest(e.req);console.log("THE ALIATIKS"),console.log(r),console.log(n),console.log(o),e.req.uploads&&(r.user?r.user.uploads=e.req.uploads:r.user={uploads:e.req.uploads});var s=r.handler;return 0<=n.indexOf(s)&&(s=o[n.indexOf(s)]),(t.handler=s)&&""!==s.trim()?(t.requestData={parsed:r,user:r.user,handler:s,request:{req:e.req,res:e.res}},t.views&&0!==t.views.length&&t.isView(e.req.originalUrl,r.user)?t.emit({type:"do-view-task",data:{payload:t.requestData,callback:t.taskerHandler.bind(t)}}):t.emit({type:"request-global-request",data:s})):t.views&&0!==t.views.length?(t.requestData={parsed:r,user:r.user,handler:s,request:{req:e.req,res:e.res}},t.isView("/home")?t.emit({type:"do-view-task",data:{payload:t.requestData,callback:t.taskerHandler.bind(t)}}):t.handlePathError()):t.handlePathError()}function V(e){console.log("The req"),console.log(e.body),console.log(e.query),console.log(e.params);var t,n,o={url:e.originalUrl},r=0===o.url.indexOf("/")?o.url.slice(1,o.url.length):o.url,s=0<r.indexOf("/");return e.query&&0<Object.keys(e.query).length?(console.log("THE QUERY"),console.log(e.query),o.user=e.query,n=r.split("?"),s?(t=n[0].split("/"),console.log("THE PATH FRAGS"),console.log(t),o.handler=t[0]):(console.log("THE REMAINING CONTENT AFTER SPLIT OF ?"),console.log(n),o.handler=n[0])):e.params&&0<Object.keys(e.params).length?(console.log("THE PARAMS"),console.log(e.params),o.user=e.params,s?(n=r.split("/"),console.log("THE PATH FRAGS"),console.log(n),o.handler=n[0]):o.handler=r):e.body&&0<Object.keys(e.body).length?(console.log("THE REQUEST BODY"),console.log(e.body),o.user=e.body,s?(e=r.split("/"),console.log("THE PATH FRAGS"),console.log(e),o.handler=e[0]):o.handler=r):(o.user={},s?(s=r.split("/"),console.log("THE PATH FRAGS"),console.log(s),o.handler=s[0]):o.handler=r),o}function Q(){this.writeResponse({error:!0,type:"serverError",code:502,message:"The server error"})}function z(){this.writeResponse({error:!0,type:"ServerError",code:502,message:"The requested task[handler] could not be completed"})}function Y(e){this.log("Router ALIATIKHANDLERS WITH DATA:"),this.log(e),this.routesAliasList=e.aliasList,this.aliatikHandlers=e.handlers}function X(e){var t=this;e?t.emit({type:"handle-".concat(t.requestData.handler,"-task"),data:{payload:t.requestData,callback:t.taskerHandler.bind(t)}}):t.handleByHandlerError()}function Z(e,t){var t=1<arguments.length&&void 0!==t?t:null,n=this,o=n.views;if(n.logSync("THE VIEW PATH"),n.logSync(e),n.logSync(t),n.logSync(o),!t)return n.logSync("THE PARSED USsER"),n.logSync(n.requestData),n.requestData.user&&(n.requestData.parsed.derivedUrl="/home"),0<=o.indexOf(e);if(0<=o.indexOf(e))return!0;var t=Object.keys(t),r="";n.logSync("THE PARALIST"),n.logSync(t),t.forEach(function(e,t){0===t?r=":".concat(e):r+="/:".concat(e)}),n.logSync("thE PARARSTRING"),n.logSync(r);for(var s=0;s<o.length;s++)if(0<o[s].indexOf(r)){var i=o[s].substr(0,o[s].indexOf(r)),a=i+r;return n.logSync("EXTRACTED VIEW PATH"),n.logSync(i),n.logSync(a),n.logSync(e),n.logSync(e.indexOf(i)),0<=e.indexOf(i)&&(n.logSync("Theviewpath matched"),n.requestData.parsed.derivedUrl=a,!0)}return!1}function $(){this.writeResponse({error:!0,type:"BadRequest",code:400,message:"Bad Request"})}function ee(){this.writeResponse({error:!0,type:"NotFound",code:404,message:"The requested task could not be completed"})}function te(){this.writeResponse({error:!0,type:"notFound",code:404,message:"The requested task could not be completed"})}function ne(){this.handleHandlerError()}function oe(e,t){var n=1<arguments.length&&void 0!==t?t:"regular",t=this.pao;"regular"===n&&(e=t.pa_isString()?t.pa_jsToJson({text:e}):t.pa_jsToJson(e)),this.emit({type:"write-server-request-response",data:{data:e,res:this.request.res,method:n}})}function re(e,t,n){e=0<arguments.length&&void 0!==e?e:null,t=1<arguments.length&&void 0!==t?t:null,n=2<arguments.length&&void 0!==n?n:null,this.pao,console.log("THE TASKER HANDLER"),console.log(e),console.log(n),e?this.failureHandle({error:!0,message:e}):t&&(n?this.successfullHandle(t,n):this.successfullHandle(t))}function se(e,t){this.writeResponse(e,t)}function ie(e){this.writeResponse(e)}function ae(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ae),this.pao=e,this.request={},this.routesAliasList=[],this.aliatikHandlers=[],this.requestData=null,this.views=[],this.init=J,this.handleConfigRequest=W,this.handleRequestHandOver=K,this.parseRequest=V,this.handleRequestGlobalError=Q,this.handleRequestGlobalResponse=X,this.isView=Z,this.handleBadRequestError=$,this.handleHandlerNotFound=ee,this.handleByHandlerError=te,this.handleHandlerError=ne,this.handlePathError=z,this.handleRouterAliasList=Y,this.writeResponse=oe,this.taskerHandler=re,this.successfullHandle=se,this.failureHandle=ie}function le(e,t,n,o,r,s,i){try{var a=e[s](i),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(o,r)}function ce(a){return function(){var e=this,i=arguments;return new Promise(function(t,n){var o=a.apply(e,i);function r(e){le(o,t,n,r,s,"next",e)}function s(e){le(o,t,n,r,s,"throw",e)}r(void 0)})}}function ue(){console.log("Server has been initialised"),this.listens({"config-server":this.handleConfigServer.bind(this),"config-domain-resources":this.handleDomainResources.bind(this),"write-server-request-response":this.handleWriteServerRequestResponse.bind(this)})}function de(){var e=this;e.emit({type:"attach-middleware",data:{app:e.http,xpress:e.xpress}}),e.emit({type:"attach-routes",data:{app:e.http,router:e.router}}),e.emit({type:"distribute-system-resources",data:""}),e.startServer()}function fe(){this.logSync("THE server is emitting system defaults event"),this.emit({type:"set-domain-defaults",data:{app:this.http,xpress:this.xpress}})}function he(){this.runServer()}function pe(){var e=this;e.http.use(e.dependiks.bodyParser.json()),e.http.use("*.js",function(e,t,n){return t.set("content-type","text/javascript"),n()}),e.http.use(e.xpress.static("public"))}function ge(){var e=this;e.http.get("/todo",e.renderHtml.bind(e)),e.http.get("/ibr",e.renderHtml.bind(e)),e.http.get("/home",e.renderHtml.bind(e)),e.http.use("/",e.renderHtml.bind(e))}function me(){this.emit({type:"attach-workers-to-server",data:{app:this.http}})}function Ee(e,t){console.log("A request has been made to one of the routes"),console.log("The html"),console.log("The request URL"),console.log(e.url),this.request={req:e,res:t},this.emit({type:"address-changed",data:{url:e.url}})}function Oe(n){var t=this,o=(t.pao,t.mimeTypes[n.data.ext]),r=n.data.rStream;r.on("open",ce(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.res.set("Content-Type",o),n.res.set("Connection","close"),e.abrupt("return",r.pipe(n.res));case 3:case"end":return e.stop()}},e)}))),r.on("end",ce(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.res.end(),e.next=3,t.log("Stream request has been successfully served WITH END");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))),r.on("error",function(){var t=ce(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("THE ERROR READSTREAM"),console.log(t),n.res.set("Content-Type","application/json"),n.res.set("Connection","close"),e.abrupt("return",n.res.status(404).send({error:!0,message:"Not found"}));case 5:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}())}function ve(o,r){var s=this;return s.pao,s.logSync("THE SET VIEW"),s.logSync(r),new Promise(function(n,e){var t=null,t=r.viewData?r.viewData:{title:r.title};o.render(r.view,t,function(e,t){return e?(s.logSync("THE ERROR BELOW OCCURED TRYING TO RENDER VIEW"),s.logSync(e),void o.render("main/500",{title:"Server error"},function(e,t){return n(e?{html:"<hl>The page could not be found</h1>",success:!1}:{html:t,success:!0})})):n({html:t,success:!0})})})}var be=function(){var e=ce(regeneratorRuntime.mark(function e(t){var n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this).logSync("THE DATA TO BE SENT TO CLIENT"),n.logSync(t.method),n.logSync("renderView"===t.method),"stream"===t.method)return e.abrupt("return",n.streamResponse(t));e.next=8;break;case 8:if("renderView"!==t.method){e.next=25;break}if(o=t.data.data,n.logSync("MAKING A VIEW request response"),t.res.set("Connection","close"),"template"===o.type.trim())return n.logSync("Rendering template view"),n.logSync(t.data.view),n.logSync("Rendering inside try"),n.getHtml(t.res,o).then(function(e){e.success?(t.res.status(200).send(e.html),n.logSync("SERVER HAS SENT A SUCCESSFULL RESPONSE BACK TO THE CLIENT::REGULAR")):(t.res.status(200).send(e.html),n.logSync("SERVER HAS SENT A FAILED RESPONSE BACK TO THE CLIENT::REGULAR"))}).catch(function(e){t.res.status(200).send(e.html)}),e.abrupt("return");e.next=20;break;case 20:if("modular"===o.type)return n.logSync("rENDEING MODULAR VIEW"),e.abrupt("return",t.res.status(200).send(o.view));e.next=23;break;case 23:e.next=46;break;case 25:return e.next=27,n.log("SERVER IS ABOUT TO SEND RESPONSE BACK TO CLIENT::REGULAR");case 27:return e.next=29,n.log(t.data);case 29:return e.next=31,t.res.set("Connection","close");case 31:if(!t.data.accepts){e.next=42;break}e.t0=t.data.accepts,e.next="json"===e.t0?35:"html"===e.t0?37:39;break;case 35:return t.res.status(200).send(t.data),e.abrupt("break",40);case 37:return n.getHtml(t.res,{view:"main/404",title:"Page could not be found"}).then(function(e){return t.res.status(200).send(e.html)}).catch(function(e){return t.res.status(200).send(e.html)}),e.abrupt("break",40);case 39:t.res.type("txt").status(200).send("Text not found");case 40:e.next=43;break;case 42:t.res.status(200).send(t.data);case 43:return e.next=45,n.log("SERVER HAS SENT A RESPONSE BACK TO THE CLIENT::REGULAR");case 45:return e.abrupt("return",e.sent);case 46:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();function ye(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ye),this.pao=e,this.xpress=we,this.http=this.xpress(),this.router=this.xpress.Router(),this.path=Ie,this.html=[],this.request=null,this.componentCount=0,this.componentId=[],this.ssrComponentLen=0,this.componentRefLen=0,this.workers=[],this.fixedCompS={before:[],after:[]},this.compData=[],this.dependiks={jsonfile:Ne,bodyParser:ke},this.mimeTypes={html:"text/html",txt:"text/plain",css:"text/css",gif:"image/gif",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",js:"application/javascript"},this.init=ue,this.handleConfigServer=de,this.handleDomainResources=fe,this.handleWriteServerRequestResponse=be,this.startServer=he,this.startPreRoutes=pe,this.startRouting=ge,this.streamResponse=Oe,this.runServer=me,this.renderHtml=Ee,this.streamResponse=Oe,this.getHtml=ve}function Te(){this.log("Config has been initialised"),this.configure()}function Se(){var e=this,t=e.config;if(!e.config)return e.emit({type:"config-anziiloger",data:{level:"info"}}),void e.emit({type:"config-server",data:"server"});if(e.config)for(var n in e.config.hasOwnProperty("logger")&&(console.log("THE LOGGER IS THE FIRST MODULE TO GET CONFIG"),e.emit({type:"config-anziiloger",data:e.config.logger})),e.enviroment(),e.config.hasOwnProperty("cluster")&&e.emit({type:"config-system",data:e.config.cluster}),t)console.log("The module in Config"),console.log(n),"router"===n&&(t.views?(e.emit({type:"config-request",data:t[n]}),e.emit({type:"config-view",data:{routes:t[n],handlers:t.views}})):(e.emit({type:"config-request",data:t[n]}),e.emit({type:"config-view",data:t[n]}))),"logger"===n&&"views"===n||(e.emit({type:"config-".concat(n),data:t[n]}),"domain"===n&&e.emit({type:"config-domain-resources",data:""}))}function Re(){var e=this,t=e.envObserver,n=e.supportsColor;if(console.log("THE CURRENT ENVIROMENT"),n.stdout&&console.log("Terminal stdout supports color"),n.stdout.has256&&console.log("Terminal stdout supports 256 colors"),n.stderr.has16m&&console.log("Terminal stderr supports 16 million colors (truecolor)"),e.envObserver.has("enviroment"))if(e.aliases.hasOwnProperty(t.enviroment)){e.env=e.aliases[t.enviroment];n=t.get(e.env);if(n.hasOwnProperty("database")){var o,r=[],s=n.database;for(o in console.log("THE DB"),console.log(s),s)console.log("THE VALUE Of C"),console.log(o),console.log(s[o]),r.push({name:o,connect:s[o].connect});console.log("THE DATABASE CLIENTS"),console.log(r),e.emit({type:"config-dman",data:{clients:r}})}t.has("appOrphic")?(console.log("THE JWT appOrphic"),console.log(t),console.log(t.appOrphic),console.log(t.appOrphic.flaDev),e.emit({type:"save-jwt-key",data:{key:t.appOrphic.flaDev}})):e.emit({type:"save-jwt-key",data:{key:"f124sfet48tq3dfmlvoszx1"}})}else e.log("Enviroment config invalid, resorting to default","warn")}var we=n(13),Ne=n(3),Ie=n(0),ke=n(1);var Ae=null;try{Ae=n(14).default;console.log("Config file has been successfully required")}catch(Ue){console.log("No configuration file has been configured"),Ae=null}console.log("THE CONFIG IN CONFIG"),console.log(Ae);function Ce(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Ce),this.pao=e,this.config=Ae,this.envObserver=De,this.supportsColor=xe,this.env="development",this.aliases={development:"dev",production:"prod",staging:"stage"},this.init=Te,this.configure=Se,this.enviroment=Re}var De=n(15),xe=n(16);function He(e,t,n,o,r,s,i){try{var a=e[s](i),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(o,r)}function Pe(a){return function(){var e=this,i=arguments;return new Promise(function(t,n){var o=a.apply(e,i);function r(e){He(o,t,n,r,s,"next",e)}function s(e){He(o,t,n,r,s,"throw",e)}r(void 0)})}}function _e(){this.setDebugger(this.constructor.name),console.log("Anziiloger has been initialised"),this.listens({"config-anziiloger":this.handleAnziilogerConfig.bind(this),"anziiloger-log":this.handleLogRequest.bind(this)})}function je(e){var t=this;if(t.logger)switch(e.type){case"info":t.info(e);break;case"warn":t.warn(e);break;case"error":t.error(e);default:t.debug(e)}else console.log(e.source,"logged message: ",e.message," of type ",e.type)}function Fe(){this.pao,new Date,this.logger=new this.winlo.createLogger({transports:[new this.winlo.transports.Console({level:"debug",label:"Anzilloger",timestamp:!0,colorize:!0})]})}var Le=function(){var e=Pe(regeneratorRuntime.mark(function e(t){var n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(n=this).pao,(0,o.pa_contains)(t,"sync"))return e.next=6,n.logger.info("".concat(t.source,": ").concat(t.message));e.next=8;break;case 6:e.next=9;break;case 8:n.logger.info("".concat(t.source,": ").concat(t.message));case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),qe=function(){var e=Pe(regeneratorRuntime.mark(function e(t){var n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(n=this).pao,!(0,o.pa_contains)(t,"sync")){e.next=13;break}if(n.debugas.hasOwnProperty(t.source.toLowerCase()))return e.next=7,n.debugas[t.source.toLowerCase()](t.message);e.next=9;break;case 7:e.next=11;break;case 9:return e.next=11,n.logger.debug("".concat(t.source,": ").concat(t.message));case 11:e.next=14;break;case 13:n.debugas.hasOwnProperty(t.source.toLowerCase())?n.debugas[t.source.toLowerCase()](t.message):n.logger.debug("".concat(t.source,": ").concat(t.message));case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),Me=function(){var e=Pe(regeneratorRuntime.mark(function e(t){var n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(n=this).pao,(0,o.pa_contains)(t,"sync"))return e.next=6,n.logger.warn("".concat(t.source,": ").concat(t.message));e.next=8;break;case 6:e.next=9;break;case 8:n.logger.warn("".concat(t.source,": ").concat(t.message));case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),Ue=function(){var e=Pe(regeneratorRuntime.mark(function e(t){var n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(n=this).pao,(0,o.pa_contains)(t,"sync"))return e.next=6,n.logger.error("".concat(t.source,": ").concat(t.message));e.next=8;break;case 6:e.next=9;break;case 8:n.logger.error("".concat(t.source,": ").concat(t.message));case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),Be=function(){var e=Pe(regeneratorRuntime.mark(function e(t){var n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this,o=t.toLowerCase(),n.debugas[o]=n.debugr("anzii:".concat(o));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();function Ge(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Ge),this.pao=e,this.winlo=Je,this.debugr=We,this.logger=null,this.debugas={},this.defaultTransports=[{trans:"File",level:"info",handleExceptions:!0,json:!0,label:"Anzilloger",maxsize:5242880,maxFiles:5,timestamp:!0,colorize:!1},{trans:"Console",level:"debug",handleExceptions:!0,json:!1,timestamp:!0,colorize:!0}],this.init=_e,this.handleLogRequest=je,this.handleAnziilogerConfig=Fe,this.info=Le,this.warn=Me,this.error=Ue,this.debug=qe,this.setDebugger=Be}var Je=n(17),We=n(18);function Ke(e,t,n,o,r,s,i){try{var a=e[s](i),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(o,r)}function Ve(){this.log("System has been initialised"),this.listens({"config-system":this.handleConfigureSystem.bind(this),"register-shutdown-candidate":this.handleRegisterShutDownCandidate.bind(this),"distribute-system-resources":this.handleDistributeSystemResources.bind(this),"attach-workers-to-server":this.handleServerAttachWorkers.bind(this)})}function Qe(e){var t=this;t.log("System ENVIROMENT IS: ".concat(t.env)),t.log(t.systemBase.DOCUMENT_ROOT),t.handleShutDowns(),t.clusterCustomConfig=e}function ze(e,t){var n=this;n.log("SHUTDOWN TYPE: ".concat(e,",code: ").concat(t)),n.systemIsShuttingDown=!0,0<n.shutDownServices.length&&n.shutDownServices.forEach(function(e,t){"function"!=typeof e?n.log("Service: ".concat(n.shutDownOrder[t]," must be a function,shutdown attempt failed"),"warn"):n.log("Service: ".concat(n.shutDownOrder[t]," is shutting down"),"info")}),n.log("System is shutting down through: ".concat(e,",with code: ").concat(t.stack)),"uncaughtException"===e?n.context.kill(1):n.context[e]()}function Ye(e){var o=this;if(o.log("THE STATUS OF isMaster: ".concat(o.cluster.isMaster)),o.cluster.isMaster)if(o.log("Master ".concat(o.context.pid," is running")),o.clusterCustomConfig&&o.clusterCustomConfig.spawn){var t=o.clusterCustomConfig.workers?o.clusterCustomConfig.workers:"auto";if("auto"===t){t=o.os.cpus().length;for(;t<t;0)o.cluster.fork()}else if("number"==typeof t)for(var n=0;n<t;n++)o.log("Forking slave number: ".concat(n)),o.cluster.fork();o.cluster.on("fork",function(e){o.log("cluster forking new worker",e.id)});var r=null;o.cluster.on("listening",function(e,t){o.log("cluster listening new worker",e.id),null===r&&(o.log("Making worker "+e.id+" to main worker"),r=e.id,e.send({singleProcessTasks:"startSingleProcessTasks"}))}),o.cluster.on("exit",function(e,t,n){o.log("worker ".concat(e.process.pid," died")),console.log("FORKING ANOTHER WORK"),console.log("Worker %d died :(",e.id),e.id===r&&(console.log("Main Worker is dead..."),r=null),console.trace("I am here"),o.log(e),o.log(t),o.log(n),o.cluster.fork()})}else o.logSync("System is running on a single thread/core"),e.listen(o.context.env.PORT||3e3,function(){o.logSync("The Server is listening via workers","info"),o.logSync("THIS WORKER RUNNING IP:")});else console.log("Worker ".concat(process.pid," started")),e.listen(o.context.env.PORT||3e3,function(){o.log("The Server is listening via workers","info"),o.log("THIS WORKER RUNNING IP:")}),process.on("message",function(e){o.log("Worker "+process.pid+" received message from master.",e),"startSingleProcessTasks"==e.singleProcessTasks&&o.emit({type:"start-single-process-tasks",data:""})})}function Xe(){}function Ze(){console.log("Shutdowns are being handled");var t=this;t.context.on("INT",function(e){t.systemIsShuttingDown?t.log("System is already ShuttingDown"):t.shutDown("kill",e)}),t.context.on("SIGTEM",function(e){t.systemIsShuttingDown?t.log("System is already ShuttingDown"):t.shutDown("exit",e)}),t.context.on("uncaughtException",function(e){t.systemIsShuttingDown?t.log("System is already ShuttingDown"):t.shutDown("uncaughtException",e)}),t.context.on("unhandledRejection",function(e){console.log("uncaughtException occured from unhandleredjected",e.stack),t.systemIsShuttingDown?t.log("System is already ShuttingDown"):t.shutDown("uncaughtException",e)})}function $e(e){this.masterWorker(e.app)}function et(e){e.hasOwnProperty("candidate")&&pao.pa_isFunction(e.candidate)&&e.hasOwnProperty("name")&&pao.pa_isString(name)?-1<this.shutDownServices.indexOf(e.name)||(this.shutDownServices.push(e.candidate),this.shutDownOrder.push(e.name)):this.log("Candidate could not be registered for shutdown","warn")}var tt=function(){var a,e=(a=regeneratorRuntime.mark(function e(t){var n,o,r,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=(n=this).pao,s.pa_getFiles,s.pa_getDirectories,s.pa_getFile,r=s.pa_makeDirs,o=s.pa_getExtension,s=n.path,"".concat(n.systemBase.DOCUMENT_ROOT),"".concat(n.systemBase.DOCUMENT_ROOT).concat(s.sep,"sev.js"),s="".concat(n.systemBase.DOCUMENT_ROOT).concat(s.sep),n.log("HandleDistributeSystemResources "),e.next=14,r(s);case 14:r=e.sent,s=o("sev.js"),console.log("GET FILES CALLBACK GETS A CALL"),console.log(s),console.log(r),n.emit({type:"take-system-base",data:{systemBase:n.systemBase}});case 20:case"end":return e.stop()}},e,this)}),function(){var e=this,i=arguments;return new Promise(function(t,n){var o=a.apply(e,i);function r(e){Ke(o,t,n,r,s,"next",e)}function s(e){Ke(o,t,n,r,s,"throw",e)}r(void 0)})});return function(){return e.apply(this,arguments)}}();function nt(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,nt),this.pao=e,this.context=process,this.env=this.context.env,this.cluster=ot,this.os=rt,this.path=st,this.shutDownServices=[],this.numOfDBSD=3,this.allowedDBSTR=1e4,this.systemIsShuttingDown=!1,this.shutDownOrder=[],this.systemBase={DOCUMENT_ROOT:process.cwd()},this.init=Ve,this.handleConfigureSystem=Qe,this.handleRegisterShutDownCandidate=et,this.handleServerAttachWorkers=$e,this.handleDistributeSystemResources=tt,this.masterWorker=Ye,this.folkSlaveWorkers=Xe,this.handleShutDowns=Ze,this.shutDown=ze}var ot=n(19),rt=(n(20),n(2)),st=n(0);function it(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function at(o){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?it(Object(r),!0).forEach(function(e){var t,n;t=o,e=r[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):it(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e,t,n,o,r,s,i){try{var a=e[s](i),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(o,r)}function ut(a){return function(){var e=this,i=arguments;return new Promise(function(t,n){var o=a.apply(e,i);function r(e){ct(o,t,n,r,s,"next",e)}function s(e){ct(o,t,n,r,s,"throw",e)}r(void 0)})}}function dt(e){return function(e){if(Array.isArray(e))return ft(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ft(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ft(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function ht(){console.log("Mysql has been initialised"),this.listens({"mysql-data-request":this.handleMysqlDataRequest.bind(this)})}function pt(e){var t=this,n=t.pao;n.pa_contains(e,["conn","table","opi","query","outComehandler"])?n.pa_isObject(e.conn)?n.pa_isString(e.table)?"deletemultiple"===e.opi.trim()||t[e.opi]?(console.log("THE CODE GOES THIS FAR"),"insert"===e.opi?(e.opi="insertOne",t[e.opi](e),console.log("this runs after opi finishes")):"find"===e.opi?t[e.opi](e):"updateOne"===e.opi?(e.opi="updateOne",t[e.opi](e)):"transaction"===e.opi?(e.opi="transaction",t[e.opi](e)):"procedure"===e.opi?(e.opi="procedure",t[e.opi](e)):"join"===e.opi?(e.opi="join",t[e.opi](e)):"search"===e.opi?(e.opi="search",t[e.opi](e)):"remove"===e.opi?(e.opi="remove",t[e.opi](e)):"updateandtake"!==e.opi&&"insertandtake"!==e.opi&&"deleteandtake"!==e.opi&&"deletemultiple"===e.opi?t.deleteandtake(e):t[e.opi](e)):(t.log("DATA.OPI IS NOT CONTAINED AS FUNCTION"),t.log("deletemultiple"!==e.opi.trim()),t.log(e.opi),e.outComehandler({message:"The specified operation is not supported"})):t.log("THE TABLE NAME IS NOT A STRING"):t.log("THE connection is not object"):(t.log("Data request operations failed"),e.outComehandler({message:"Database operation failed"}))}function gt(o){if(this.pao.pa_isObject(o))try{var r=o.outComehandler,e=o.conn,t=o.query;this.log("THE INSERT OBJECT"),this.log(o);var t=[o.table,["id"].concat(dt(t.fields)),[null].concat(dt(t.values))],t=e.format("INSERT INTO ?? (??) VALUES(?)",t);console.log("THE SQL STATEMENT"),console.log(t),e.query(t,function(e,t,n){return console.log("INSERT RESULT"),console.log(t),console.log(e),e?r(e,null):(t.user=o.values,console.log(t.user),void r(null,t))})}catch(e){console.log("CAUTH ERROR"),console.log(e),handler(e,null)}else;}function mt(e){if(pao.pa_isObject(data))try{var o="INSERT INTO ?? (?) VALUES(?)",r=[];e.bulk.forEach(function(e,t){var n=[e.table,dt(e.fields),dt(e.values)];o=conn.format(o,n),conn.query(o,e,function(e,t,n){e||r.push(t)})}),console.log("bulk insert completed"),handler(null,r)}catch(e){handler(e,null)}else;}function Et(e){console.log("THE UPDATIKS"),console.log(e);var t=this.pao,n=e.conn,o=e.outComehandler,r=at({table:e.table},e.query);if(t.pa_isObject(e))try{var s=this.queryTemplate(this.queryOptions(r),"update");console.log("THE SQLKIKS OBJECT UPDATE"),console.log(s),i=[s.attribs.from.table],s=s.statement;var i=i;console.log("THE SQL BEFORE FORMAT"),console.log(s),s=n.format(s,i),console.log(s),n.query(s,function(e,t,n){e&&o(e,null),o(null,t)})}catch(e){o(e,null)}else;}function Ot(e){this.log("UPDATE OPTIONS"),this.log(e);var t={};switch(t.attribs={from:e.from,tables:e.tables},e.length){case 2:t.statement="UPDATE ??\n                            JOIN ".concat(e.tables[0],"\n                              ON ").concat(e.joinPoints[0],"\n                            SET ").concat(e.set,"\n                            WHERE ").concat(e.from.condition,"\n                            ");break;case 3:t.statement="UPDATE ??,??,??\n                              JOIN ".concat(e.tables[0],"\n                                ON ").concat(e.conditions[0],"\n                              JOIN ").concat(e.tables[1],"\n                                ON ").concat(e.conditions[1],"\n                              SET ").concat(e.set,"\n                              WHERE ").concat(e.from.condition,"\n                              \n                              ");break;case 4:t.statement="UPDATE ??,??,??,??\n                            JOIN ".concat(e.tables[0],"\n                              ON ").concat(e.conditions[0],"\n                            JOIN ").concat(e.tables[1],"\n                              ON ").concat(e.conditions[1],"\n                            JOIN ").concat(e.tables[2],"\n                            ON ").concat(e.conditions[2],"\n                            SET ").concat(e.set,"\n                            WHERE ").concat(e.from.condition,"\n                            \n                            ");break;default:t.statement="UPDATE ??\n                            SET ".concat(e.set,"\n                            WHERE ").concat(e.from.condition,"\n                            \n                            ")}return t}function vt(s,i){var a=this,l=a.pao.pa_contains;return console.log("THE SEARCH"),console.log(en),new Promise(function(o,r){console.log("Executing the search promise");var e,t=null,n=a.searchStatement(s);console.log("THE SQLKIKS OBJECT"),console.log(n),t=l(n.attribs,"tables")?[n.attribs.from.table].concat(dt(n.attribs.tables)):[n.attribs.from.table],e=n.statement;console.log("THE SQL BEFORE FORMAT::"),console.log(e),e=i.format(e,t),console.log(e),i.query(e,function(e,t,n){e?(console.log("Promise is rejecting search"),console.log(e),r(e)):(console.log("Promise is Resolving search"),console.log(t),console.log(t[0]),o(t))})})}function bt(e){var t=this.pao,n=t.pa_contains,o=e.conn,r=e.outComehandler;if(t.pa_isObject(e))try{var s=null,i=this.queryTemplate(this.searchOptions(e),"delete");console.log("THE SQLKIKS OBJECT DELETEDANDTAKE[REMOVE]"),console.log(i),s=n(i.attribs,"tables")?[].concat(dt(i.attribs.tables),[i.attribs.from.table]):[i.attribs.from.table],i=i.statement;s=s;console.log("THE SQL BEFORE FORMAT"),console.log(i),i=o.format(i,s),console.log(i),o.query(i,function(e,t,n){return e?r(e,null):void r(null,t)})}catch(e){r(e,null)}else;}function yt(e){var t=this.pao,n=e.conn,o=e.outComehandler,r=at({table:e.table},e.query);if(t.pa_isObject(e))try{var s=this.queryTemplate(this.queryOptions(r),"delete");console.log("THE SQLKIKS OBJECT DELETED[REMOVE]"),console.log(s),i=[s.attribs.from.table],s=s.statement;var i=i;console.log("THE SQL BEFORE FORMAT"),console.log(s),s=n.format(s,i),console.log(s),n.query(s,function(e,t,n){e&&o(e,null),o(null,t)})}catch(e){o(e,null)}else;}function Tt(e){console.log("THE search BATCH ITEM"),console.log(e);var t=this,n=t.pao.pa_contains,o={};return e.conditions?o.from={table:e.table,condition:t.searchConditionsFormat(e.conditions)}:o.from={table:e.table},console.log("THE CODE GETS HERE"),console.log(o),n(e,["returnFields","opiks"])?o.fields=t.searchFieldsFormat(e.opiks,e.returnFields):n(e,"opiks")?o.fields=t.searchFieldsFormat(e.opiks):!n(e,"returnFields")||1===e.returnFields.length&&"all"===e.returnFields[0].trim()?o.fields="*":o.fields=e.returnFields,n(e,"take")&&(o.take=e.take),n(e,"range")&&(o.range=e.range),n(e,"sort")&&(o.sort=e.sort),n(e,"set")&&(o.set=t.set(e.set)),n(e,"takeFrom")&&(e.takeFrom.conditions?(o.takeFrom=e.takeFrom,o.takeFrom.condition=t.searchConditionsFormat(e.takeFrom.conditions)):o.takeFrom=e.takeFrom),console.log("THE OPTIONS"),console.log(o),o}function St(e,t){var n=this.pao.pa_contains;if(console.log("THE QUERY TEMPLATE"),console.log(e),"select"===t){var o={};o.attribs={from:e.from};var r=" ",s=e.sort?this.sort(e.sort):" ";return e.take?r=this.limit(e.take,"take"):e.range&&(r=this.limit(e.range,"range")),n(e.from,"condition")?o.statement="SELECT ".concat(e.fields,"\n                              FROM  ??\n                              WHERE ").concat(e.from.condition,"\n                              ").concat(s,"\n                              ").concat(r,"\n\n                              "):o.statement="SELECT ".concat(e.fields,"\n                              FROM  ??\n                              ").concat(s,"\n                              ").concat(r,"\n                              "),o}if("update"===t){o={};return o.attribs={from:e.from},o.statement="UPDATE ??\n                            SET ".concat(e.set,"\n                            WHERE ").concat(e.from.condition,"\n                            "),o}if("delete"===t){if(e.length){var i={};switch(i.attribs={from:e.from,tables:e.tables},e.tables.unshift(e.from.table),console.log("DELETE OPTIONS OBJECT"),console.log(e),console.log(e.tables),console.log(e.length),e.length){case 3:i.statement="DELETE ??,??,??\n                                  FROM ??\n                                  JOIN ".concat(e.tables[1],"\n                                    ON ").concat(e.joinPoints[0],"\n                                  JOIN ").concat(e.tables[2],"\n                                    ON ").concat(e.joinPoints[1],"\n                                  WHERE ").concat(e.from.condition,"\n                                  \n                                  ");break;case 4:i.statement="DELETE ??,??,??,??\n                                FROM ??\n                                JOIN ".concat(e.tables[1],"\n                                  ON ").concat(e.joinPoints[0],"\n                                JOIN ").concat(e.tables[2],"\n                                  ON ").concat(e.joinPoints[1],"\n                                JOIN ").concat(e.tables[3],"\n                                ON ").concat(e.joinPoints[3],"\n                                WHERE ").concat(e.from.condition,"\n                                \n                                ");break;default:i.statement="DELETE ??,??\n                                  FROM ??\n                                  JOIN ".concat(e.tables[1],"\n                                    ON ").concat(e.joinPoints[0],"\n                                  WHERE ").concat(e.from.condition,"\n                                  \n                                  ")}return console.log("SQL ATTRRIBS"),console.log(i),i}i={};return i.attribs={from:e.from},i.statement="DELETE\n                                FROM ??\n                                ",e.from.condition&&(i.statement+=" WHERE ".concat(e.from.condition)),i}}function Rt(e){"function"==typeof e.query?e.query():this.TRANSACTION(e.query,e.conn,e.outComehandler)}function wt(e){console.log("THE procedure got a call"),"function"==typeof e.query?e.query():(console.log("INSIDE PROCEDURE"),this.PROCEDURE(e.query,e.conn,e.outComehandler))}function Nt(e){console.log("THE procedure got a call"),"function"==typeof e.query?e.query():(console.log("INSIDE JOIN"),this.JOIN(e.query,e.conn,e.outComehandler))}function It(e,t,n){for(var o=2<arguments.length&&void 0!==n?n:null,r=this,s=r.pao,i=[],a=!1,l=0;l<e.length;l++){var c=e[l],u=null,d=null,f=null;if(!s.pa_contains(c,"fields")){o("Required collection/table field missing");break}if(s.pa_contains(c.fields,"tables")&&(d=c.fields.tables,f=c.fields.own),d&&(u=r.combineFields(d,f,i)),u&&(c.fields=u),r.insert(c,t).then(function(e){i.push(e)}).catch(function(e){r.rollback(i),o(e,null),a=!0}),a)break;l===e.length-1&&(console.log("Operation completed successfully"),o("Transaction Operation sucessful"))}}function kt(s,i){var a=this;return new Promise(function(r,o){console.log("Executing the insert promise");var e=[s.name,s.fields],t=i.format("INSERT INTO ?? SET ?",e);i.query(t,function(e,t,n){e?(console.log("Promise is rejecting"),o(e)):a.findOne({conn:i,table:s.name,query:{user:{id:t.insertId}},outComehandler:function(e,t,n){var o=0<arguments.length&&void 0!==e?e:null,e=1<arguments.length&&void 0!==t?t:null,t=2<arguments.length&&void 0!==n?n:null,n={};o?(console.log("the errorINSERT"),console.log(o),console.log(t),n.error=o,n.lastInsert=t.query.user.id,n.fields=null,n.collection=t.table,console.log("Promise is Resolving with findOne error")):(n.lastInsert=t.query.user.id,n.fields=e,n.collection=t.table,console.log("Promise is Resolving with FindOne SUCCESS")),console.log(n),r(n)}})})})}function At(e,n,o){var r={};return console.log("COMBINE FIELDS GETS A CALL"),e.forEach(function(e,t){for(var n=0;n<o.length;n++){if("break"===function(n){if(o[n].collection===e.name)return e.values.forEach(function(e,t){console.log("THE VV"),console.log(e);e=e.split(".");console.log("FIELD VALUE PAIR"),console.log(e),r[e[1]]=o[n].fields[e[0]]}),"break"}(n))break}}),e=Object.keys(n),console.log("THE KEYS OF OWN"),console.log(e),e.forEach(function(e,t){r[e]=n[e]}),console.log("THE FIELDS"),console.log(r),r}function Ct(e){var n=this;e.forEach(function(e,t){n.deleteOne({id:e.lastInsert},conn)})}function Dt(n,s){var i=this;return new Promise(function(o,r){console.log("Executing the JOIN promise");var e={fields:n.returnFields,from:{table:n.tables[0],condition:i.joinConditionsFormat(n.conditions)},joinPoints:i.joinConditionsFormat(n.joinPoints,"ON"),tables:n.tables.splice(1,n.tables.length),type:n.type.toUpperCase(),length:n.joins},t=i.joinStatement(e),e=[e.from.table,e.tables[0]];console.log("THE SQL BEFORE FORMAT"),console.log(t),t=s.format(t,e),console.log(t),s.query(t,function(e,t,n){e?(console.log("Promise is rejecting JOIN"),console.log(e),r(e)):(console.log("Promise is Resolving JOIN"),console.log(t),console.log(t[0]),o(t[0]))})})}function xt(e,t){if(t=1<arguments.length&&void 0!==t?t:null,console.log("CONDITIONS"),console.log(e),t){var n=[];return e.forEach(function(e,t){e=e.trim().split(" ");n.push("".concat(e[0]," ").concat("="," ").concat(e[2]))}),console.log("THE JOIN ON CONDITION"),console.log(n),n}var o="";return e.forEach(function(e,t){console.log("THE con ITEM"),console.log(e);var n=e.trim().split(" ");console.log("THE CONLIST"),console.log(n);e="";switch(n[1]){case"EQUALS":e="=";break;case"ISGREATEROREQUALS":e=">=";break;case"ISLESSOREQUALS":e="<=";break;default:e="="}o+="".concat(n[0]," ").concat(e," '").concat(n[2],"'")}),console.log("THE JOIN FROM CONDITION"),console.log(o),o.trim()}function Ht(e){switch(console.log("THE JOIN OPTIONS"),console.log(e),e.length){case 3:return"SELECT ".concat(e.fields,"\n               FROM ").concat(e.from.table,"\n               JOIN ").concat(e.tables[0],"\n                  ON ").concat(e.conditions[0],"\n               JOIN options.tables[1]\n                  ON ").concat(e.conditions[1],"\n               WHERE ").concat(e.from.condition,"\n               \n               ");case 4:return"SELECT ".concat(e.fields,"\n               FROM ").concat(e.from.table,"\n               JOIN ").concat(e.tables[0],"\n                  ON ").concat(e.conditions[0],"\n               JOIN options.tables[1]\n                  ON ").concat(e.conditions[1],"\n               JOIN options.tables[2]\n                  ON ").concat(e.conditions[2],"\n               WHERE ").concat(e.from.condition,"\n               \n               ");case 5:return"SELECT ".concat(e.fields,"\n               FROM ").concat(e.from.table,"\n               JOIN ").concat(e.tables[0],"\n                  ON ").concat(e.conditions[0],"\n               JOIN options.tables[1]\n                  ON ").concat(e.conditions[1],"\n               JOIN options.tables[2]\n                  ON ").concat(e.conditions[2]," \n               JOIN options.tables[3]\n                  ON ").concat(e.conditions[3],"\n               WHERE ").concat(e.from.condition,"\n               \n               ");default:return"SELECT ".concat(e.fields,"\n               FROM  ??\n               JOIN  ").concat(e.tables[0],"\n                  ON ").concat(e.joinPoints[0],"\n               WHERE ").concat(e.from.condition,"\n               ")}}function Pt(s,i){var a=this,l=a.pao.pa_contains;return console.log("THE SEARCH"),console.log(s),new Promise(function(o,r){console.log("Executing the search promise");var e,t=null,n=a.searchStatement(a.searchOptions(s));console.log("THE SQLKIKS OBJECT"),console.log(n),t=l(n.attribs,"tables")?[n.attribs.from.table].concat(dt(n.attribs.tables)):[n.attribs.from.table],e=n.statement;console.log("THE SQL BEFORE FORMAT"),console.log(e),e=i.format(e,t),console.log(e),i.query(e,function(e,t,n){e?(console.log("Promise is rejecting search"),console.log(e),r(e)):(console.log("Promise is Resolving search"),o(t))})})}function _t(e,t){t=1<arguments.length&&void 0!==t?t:null,console.log("CONDITIONS"),console.log(e);var n=this;if(n.pao,t){t=n.parseFormatCondition(e,t);return console.log("THE search ON CONDITION"),console.log(t),t}var o="";return e.forEach(function(e,t){0<=e.indexOf("GROUP::")?(console.log("CONDITION FROM SEARCHCONDITIONFORMAT"),console.log(e),o+=n.parseGroup(e)):o+=n.parseFormatCondition(e)}),console.log("THE search FROM CONDITION"),console.log(o),o.trim()}function jt(e){console.log("THE search OPTIONSSTATEMENT"),console.log(e);var t=this,n=t.pao.pa_contains;if(!e)return null;if(n(e,"length")){var o={};o.attribs={from:e.from,tables:e.tables},console.log("THE OPTIONS LENGTH"),console.log(e.length);var r=" ",s=e.sort?t.sort(e.sort):" ";switch(e.take?r=t.limit(e.take,"take"):e.range&&(r=t.limit(e.range,"range")),e.length){case 3:o.statement="SELECT ".concat(e.fields,"\n                FROM ??\n                JOIN ??\n                  ON ").concat(e.joinPoints[0],"\n                JOIN ??\n                  ON ").concat(e.joinPoints[1],"\n                WHERE ").concat(e.from.condition,"\n                ").concat(s,"\n                ").concat(r,"\n                \n                ");break;case 4:o.statement="SELECT ".concat(e.fields,"\n                FROM ").concat(e.from.table,"\n                JOIN ").concat(e.tables[0],"\n                  ON ").concat(e.joinPoints[0],"\n                JOIN ").concat(e.tables[1],"\n                  ON ").concat(e.joinPoints[1],"\n                JOIN ").concat(e.tables[2],"\n                  ON ").concat(e.joinPoints[2],"\n                WHERE ").concat(e.from.condition,"\n                ").concat(s,"\n                ").concat(r,"\n                ");break;case 5:o.statement="SELECT ".concat(e.fields,"\n                FROM ").concat(e.from.table,"\n                JOIN ").concat(e.tables[0],"\n                  ON ").concat(e.joinPoints[0],"\n                JOIN ").concat(e.tables[1],"\n                  ON ").concat(e.joinPoints[1],"\n                JOIN ").concat(e.tables[2],"\n                  ON ").concat(e.joinPoints[2]," \n                JOIN ").concat(e.tables[3],"\n                  ON ").concat(e.joinPoints[3],"\n                WHERE ").concat(e.from.condition,"\n                ").concat(s,"\n                ").concat(r,"\n                ");break;default:o.statement="SELECT ".concat(e.fields,"\n                FROM  ??\n                JOIN  ").concat(e.tables[0],"\n                  ON ").concat(e.joinPoints[0],"\n                WHERE ").concat(e.from.condition,"\n                ").concat(s,"\n                ").concat(r,"\n              ")}return o}return(s={}).attribs={from:e.from},r=" ",o=e.sort?t.sort(e.sort):" ",e.take?r=t.limit(e.take,"take"):e.range&&(r=t.limit(e.range,"range")),n(e.from,"condition")?s.statement="SELECT ".concat(e.fields,"\n              FROM  ??\n              WHERE ").concat(e.from.condition,"\n              ").concat(o,"\n              ").concat(r,"\n              "):s.statement="SELECT ".concat(e.fields,"\n                              FROM  ??\n                              ").concat(o,"\n                              ").concat(r,"\n                              "),s}function Ft(e,t){var n=1<arguments.length&&void 0!==t&&t,o=this,r=o.pao.pa_contains,s=n?dt(e.tables):"";if(o.log("THE search BATCH ITEM"),o.log(e),console.log(e),r(e,["joins","conditions","joinPoints"])){console.log("THE SEARCH ITEM CONTAINS BOTH JOINS,CONDITIONS, AND JOINPOINTS");t={};return t.from={table:e.tables[0],condition:o.searchConditionsFormat(e.conditions)},t.joinPoints=e.joinPoints?o.searchConditionsFormat(e.joinPoints,"ON"):null,t.length=e.tables.length,t.tables=e.tables.splice(1,e.tables.length),r(e,["returnFields","opiks"])?t.fields=o.searchFieldsFormat(e.opiks,e.returnFields):r(e,"opiks")?t.fields=o.searchFieldsFormat(e.opiks):r(e,"returnFields")&&(1===e.returnFields.length&&"all"===e.returnFields[0].trim()?t.fields="*":t.fields=e.returnFields),r(e,"type")&&(t.type=e.type),r(e,"take")&&(t.take=e.take),r(e,"range")&&(t.range=e.range),r(e,"soundex")&&(t.soundex=e.soundex),r(e,"sort")&&(t.sort=e.sort),r(e,"set")&&(t.set=n?o.set(e.set,s):o.set(e.set)),r(e,"takeFrom")&&(e.takeFrom.conditions?(t.takeFrom=e.takeFrom,t.takeFrom.condition=o.searchConditionsFormat(e.takeFrom.conditions)):t.takeFrom=e.takeFrom),t}if(r(e,["conditions"])){var i={};return i.from={table:e.tables[0],condition:o.searchConditionsFormat(e.conditions)},r(e,["returnFields","opiks"])?i.fields=o.searchFieldsFormat(e.opiks,e.returnFields):r(e,"opiks")?i.fields=o.searchFieldsFormat(e.opiks):r(e,"returnFields")&&(1===e.returnFields.length&&"all"===e.returnFields[0].trim()?i.fields="*":i.fields=e.returnFields),r(e,"type")&&(i.type=e.type),r(e,"take")&&(i.take=e.take),r(e,"range")&&(i.range=e.range),r(e,"soundex")&&(i.soundex=e.soundex),r(e,"sort")&&(i.sort=e.sort),r(e,"set")&&(i.set=n?o.set(e.set,s):o.set(e.set)),r(e,"takeFrom")&&(e.takeFrom.conditions?(i.takeFrom=e.takeFrom,i.takeFrom.condition=o.searchConditionsFormat(e.takeFrom.conditions)):i.takeFrom=e.takeFrom),i}if(r(e,"tables")&&e.tables instanceof Array){i={};return i.from={table:e.tables[0]},r(e,["returnFields","opiks"])?i.fields=o.searchFieldsFormat(e.opiks,e.returnFields):r(e,"opiks")?i.fields=o.searchFieldsFormat(e.opiks):r(e,"returnFields")&&(1===e.returnFields.length&&"all"===e.returnFields[0].trim()?i.fields="*":i.fields=e.returnFields),r(e,"type")&&(i.type=e.type),r(e,"take")&&(i.take=e.take),r(e,"range")&&(i.range=e.range),r(e,"soundex")&&(i.soundex=e.soundex),r(e,"sort")&&(i.sort=e.sort),r(e,"set")&&(i.set=n?o.set(e.set,s):o.set(e.set)),r(e,"takeFrom")&&(e.takeFrom.conditions?(i.takeFrom=e.takeFrom,i.takeFrom.condition=o.searchConditionsFormat(e.takeFrom.conditions)):i.takeFrom=e.takeFrom),i}return null}function Lt(e,t){var n=1<arguments.length&&void 0!==t?t:null;console.log("THE SELECT STATEMENT OPIKS OBJECT"),console.log(e),console.log(n);var o=this,r=(o.pao.pa_contains,e),s="",i=n?n.join(","):"",e="",a="",l=[],c=0<=i.indexOf("all"),u=!1;console.log("THE OTHER FIELDS"),console.log(i),console.log(0<=i.indexOf("all"));for(var d=0;d<r.length&&((0<=r[d].indexOf("fuxin")||0<=r[d].indexOf("field"))&&l.push(!0),!(1<l.length));d++);return r.forEach(function(e,t){e=o.fieldFormat(e);e instanceof Object?s=e.value.toUpperCase():(console.log("THE FORMATED"),console.log(e),console.log(c),console.log(i),t===r.length-1&&(u=!0),a+=c?l&&t!==r.length-1?"".concat(e,","):e:u&&null===n?"".concat(e):"".concat(e,","))}),!0==c&&(e="*,"),c?"".concat(e," ").concat(s," ").concat(a):"".concat(e," ").concat(s," ").concat(a," ").concat(i)}function qt(e,t){var n=1<arguments.length&&void 0!==t?t:null;console.log("THE SELECT STATEMENT OPIKS OBJECT FIELD FORMAT"),console.log(e),this.pao.pa_contains;var o="",t=0<=e.lastIndexOf(".as")?e.lastIndexOf(".as"):e.length;switch(0<=e.indexOf(".options[fuxin")&&(o=e.slice(e.indexOf(".options[fuxin"),t)),console.log("THE NESTEDINTFUXIN"),console.log(o),console.log(e),""!==o.trim()&&(e=e.substr(0,e.indexOf(o))),t=e.trim().split("."),""!==o.trim()&&t.push(o),console.log("THE FIELD LIST"),console.log(t),e=null,o="fuxin"===t[0]&&3<t.length?"AS ".concat(this.options("".concat(t[3]),"as")):" ",console.log("THE as"),console.log(o),t[0]){case"keyword":e=n?t[1].toUpperCase():{statement:"keyword",value:t[1].toUpperCase()};break;case"fuxin":e=" ".concat(t[1].toUpperCase(),"(").concat(this.options("".concat(t[2]),"option"),") ").concat(o," ");break;case"field":3===t.length&&(e="".concat(t[1]," AS ").concat(this.options(t[2],"as")));break;default:e=""}return e.trim()}function Mt(e,t){if(t=1<arguments.length&&void 0!==t?t:"",this.pao.pa_contains,console.log("THE CURRENT OPTION"),console.log(e),"undefined"===e)return console.log("THE OPTION IS UNDEFINED"),console.log(e),"";if(e=e.slice(e.indexOf("[")+1,e.lastIndexOf("]")),console.log("OPTIONS: STRIPEDOPTION"),console.log(e),"as"===t)return"".concat(e);if("option"===t){t=e.split(",");return t instanceof Array&&1<t.length?0<=t[0].indexOf("keyword")?this.fieldFormat(t[0],!0):0<=t[0].indexOf("fuxin")?t[1]?"".concat(this.fieldFormat(t[0]),",").concat(t[1].trim()):this.fieldFormat(t[0]):"".concat(e):t.join(",")}}function Ut(e){console.log("THE SORT GOT A RESPONSE"),console.log(e);var t=e.split("."),n=e.slice(e.indexOf("[")+1,e.lastIndexOf("]")),e="";return 0<=t[0].indexOf("order")?e=1<t.length&&"DESC"===t[1].toUpperCase()?"ORDER BY ".concat(n," DESC"):"ORDER BY ".concat(n):0<=t[0].indexOf("group")&&(e=1<t.length&&"DESC"===t[1].toUpperCase()?"GROUP BY ".concat(n," DESC"):"GROUP BY ".concat(n," ASC")),e}function Bt(e,t){var n=1<arguments.length&&void 0!==t?t:null,t="";return"take"===n?t="LIMIT ".concat(e):"range"===n&&(e=(n=e.split(","))[0],n=n[1],t="LIMIT ".concat(n," OFFSET ").concat(e)),t}function Gt(e,t){var n=1<arguments.length&&void 0!==t?t:1,o=this,r=o.pao.pa_isObject,s="",i="",t=o.conditionsConnector(e);return console.log("THE RES VALUE"),console.log(t),r(t)&&(console.log("THE RES IS AN OBJECT"),console.log(t),e=t.condixion,i=t.connector),0===e.trim().indexOf("GROUP::")&&(console.log("THE GROUP:: string is the first"),r=e.replace("GROUP::","").trim(),e=t="",console.log("THE extracted string"),console.log(r),"number"==typeof parseInt(r[0])&&(console.log("extStr type is a number"),parseInt(r[0]),0!==(t=r.slice(1).trim()).indexOf("START")&&0!==t.indexOf("$")||(e=t.replace("START","").trim(),console.log(t),r="",t=[],console.log("PARSEGROUP EXECUTES THIS FAR"),console.log(e),1===n?(r=e.split(";"),console.log("LEVEL 1 GROUPCONS"),console.log(r),t=r.map(function(e,t){return console.log("THE C CONDITION"),console.log(e),console.log(e.indexOf("GROUP::")),0<=e.indexOf("GROUP::")?o.parseGroup(e,2):o.parseFormatCondition(e)})):2===n?(r=e.split(","),console.log("LEVEL 2 GROUPCONS"),console.log(r),t=r.map(function(e,t){return 0<=e.indexOf("GROUP::")?o.parseGroup(e,3):o.parseFormatCondition(e)})):3===n&&(t=(r=e.split("|")).map(function(e,t){return o.parseFormatCondition(e)})),console.log("GROUPED"),console.log(t),console.log(r),s="".concat(i," (").concat(t.join(" "),")")))),console.log("THE FULL GROUPED CONDITION TO BE RETURNED:"),console.log(s),s}function Jt(e,t){var n=1<arguments.length&&void 0!==t?t:null;if(this.pao,n){var o=[];return e.forEach(function(e,t){e=e.trim().match(/(\[[^\]]+\]|\S+)/g);o.push("".concat(e[0]," ").concat("="," ").concat(e[2]))}),console.log("THE search ON CONDITION"),console.log(o),o}var r="";console.log("THE con ITEM"),console.log(e);var s=e.trim().match(/(\[[^\]]+\]|\S+)/g);console.log("THE CONLIST"),console.log(s);var i="",a="",l=!1,t=!1,n=!1;if("MATCH"===s[0].trim()||"MATCH"===s[1].trim()||"FUXIN"===s[1].trim()||"FUXIN"===s[2].trim())if(0<s.indexOf("AGAINST")&&5<=s.length){var c=s.slice(0);console.log("THE O CON"),console.log(c);var u="",e="",e=(l="MATCH"!==c[0].trim().toUpperCase())?(u=c[2].trim(),c[4].trim()):(u=c[1].trim(),c[3].trim());"["===u[0]&&(u=u.slice(1,u.length-1)),"["===e[0]&&(e=e.slice(1,e.length-1)),console.log("THE MATCH FIELDS"),console.log(u);var d="",i=(l?c[3]:c[2]).trim();switch(l?c[5]:c[4]){case"BOOLEAN":d='AGAINST ("'.concat(e,'"" IN BOOLEAN MODE) ');break;case"QUERY":d='AGAINST ("'.concat(e,'" IN QUERY EXPRESSION MODE) ');break;default:d='AGAINST ("'.concat(e,'" IN NATURAL LANGUAGE MODE) ')}s[0]=(l?"".concat(c[0]," MATCH ("):"MATCH (").concat(u,") ").concat(d),t=!0}else{c=s.slice(0),n=!0;console.log("THE O CON::FUXIN"),console.log(c);u=(l="FUXIN"!==c[1].trim().toUpperCase())?3:2,d=c.splice(u);c.push(d.join(" ")),console.log(u),console.log(c),0<=c[u].indexOf("[")&&(console.log("OTHER CONTENT IS IN THE SQUARE BRACKETS"),h=(h=c[u].slice(1,c[u].length-1)).trim(),console.log("AFTER THE STRIPED HAS BEEN TRIMMED"),console.log(h),f=h.substr(0,h.indexOf(" ")),h=h.substr(h.indexOf(" ")+1),console.log("THE SPLITFUXINCONS"),console.log(f),console.log(h),f=this.getOperand(f),h=this.fieldFormat(h),console.log(f),console.log(h),r=(l?"".concat(c[0]," ").concat(c[1]," "):"".concat(c[0]," ")).concat(f," ").concat(h),console.log("THE CONDITION IN FUXIN TEST"),console.log(r))}else{var f=s.slice(0);console.log("THE O CON"),console.log(f);var h=f[0].trim().toUpperCase(),h=(l="AND"===h||"OR"===h||"NOT"===h)?s[2]:s[1];console.log("THE MULTICON STATUS:::"),console.log(l),console.log(f),i=this.getOperand(h),a="["===(a=l?s[3]:s[2])[0]?"'".concat(a.slice(1,a.length-1),"'"):0<=a.indexOf("KEY::")?"".concat(a.replace("KEY::","").trim()):"'".concat(a,"'"),console.log("THE VALUE OF THE LEFFFFFT OPERAND"),console.log(a),console.log(a.indexOf("KEY::"))}return n||(r+=t?"".concat(s[0]):(l?"".concat(" "," ").concat(s[0]," ").concat(s[1]," "):"".concat(s[0]," ")).concat(i," ").concat(a)),console.log("THE search FROM CONDITION"),console.log(r),r}function Wt(e){var t="";switch(e){case"EQUALS":t="=";break;case"ISGREATEROREQUALS":t=">=";break;case"ISLESSOREQUALS":t="<=";break;case"ISLIKE":t="LIKE";break;case"ISIN":t="IN";break;case"ISREGEX":t="REGEXP";break;case"ISNOT":t="NOT";break;case"ISNOTNULL":t="IS NOT NULL";break;case"ISNULL":t="IS NULL";break;default:t="="}return t}function Kt(e){var t={};return console.log("THE INDEX OF GROUP:: IN CONDITIONS CONNECTOR"),console.log(e.trim().indexOf("GROUP::")),console.log(e),0<e.trim().indexOf("GROUP::")?(console.log("THE INDEX OF GROUP IS AT ONE"),0===e.trim().indexOf("AND")?(t.connector=" AND",t.condixion=e.replace("AND","").trim()):0===e.trim().indexOf("OR")?(t.connector=" OR",t.condixion=e.replace("OR","").trim()):0===e.trim().indexOf("NOT")&&(t.connector=" NOT",t.condixion=e.replace("NOT","").trim()),t):e}function Vt(t,e){var s=1<arguments.length&&void 0!==e&&e,i=this.pao.pa_objectToArray;this.log("THE SET"),this.log(t),this.log(s);var a="";return t.forEach(function(e,n){var o="",r=i(e,!0);console.log("THE CONVERTED SET OBJECT"),console.log(r),r.forEach(function(e,t){o+=s?t===r.length-1?"".concat(s[n],".").concat(e.key,' = "').concat(e.value,'"'):"".concat(s[n],".").concat(e.key,' = "').concat(e.value,'", '):t===r.length-1?"".concat(e.key,' = "').concat(e.value,'"'):"".concat(e.key,' = "').concat(e.value,'", ')}),a+=n===t.length-1?"".concat(o):"".concat(o,", ")}),console.log("THE SETSTRINGS"),console.log(a),a}var Qt=function(){var e=ut(regeneratorRuntime.mark(function e(u){var d,f,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((f=(d=this).pao).pa_isObject(u)){e.next=6;break}return e.abrupt("return");case 6:return e.delegateYield(regeneratorRuntime.mark(function e(){var s,i,a,l,c,t,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=u.conn,i=u.outComehandler,a=[],c=!(l=[]),"MULTIPLE"===u.table.toUpperCase().trim()?(c=!0,a=u.query):a.push(u.query),t=regeneratorRuntime.mark(function e(o){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,n=at(c?{table:a[o].table}:{table:u.table},a[o]),e.prev=2,n=d.queryTemplate(d.queryOptions(n),"select"),console.log("THE SQLKIKS OBJECT FIND"),console.log(n),r=[n.attribs.from.table],t=n.statement,r=r,console.log("THE SQL BEFORE FORMAT"),console.log(t),t=s.format(t,r),console.log(t),e.next=17,s.query(t,function(e,t,n){console.log("THE QUERY IS COMPLETED WITH RESULTS"),console.log(e),console.log(t),e&&l.push(e),f.pa_isArray(t)&&0<t.length&&1!==a.length?(t=t[0],l.push(t)):l=t,o===a.length-1&&(console.log("THE LOOP IS COMPLETE WITH DATA:"),console.log(l),i(null,l))});case 17:e.next=22;break;case 19:return e.prev=19,e.t0=e.catch(2),e.abrupt("return",{v:{v:i(e.t0,null)}});case 22:case"end":return e.stop()}},e,null,[[2,19]])}),n=0;case 8:if(n<a.length)return e.delegateYield(t(n),"t0",10);e.next=16;break;case 10:if("object"===lt(o=e.t0))return e.abrupt("return",o.v);e.next=13;break;case 13:n++,e.next=8;break;case 16:case"end":return e.stop()}},e)})(),"t0",7);case 7:if("object"===lt(t=e.t0))return e.abrupt("return",t.v);e.next=10;break;case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),zt=function(){var e=ut(regeneratorRuntime.mark(function e(t){var n,o,r,s,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("THE UPDATIKANDTAKE"),console.log(t),o=(n=this).pao,r=t.conn,s=t.outComehandler,i=t.query,o.pa_isObject(t)){e.next=10;break}e.next=20;break;case 10:return e.prev=10,e.next=13,n.searchOptions(i,!0);case 13:a=e.sent,n.multiTableUpdate(a,r).then(function(e){0<e.changedRows?n.take(a,r,i.conditions).then(function(e){s(null,{updated:!0,taken:e})}).catch(function(e){s(e,null)}):(console.log("NO CHANGED ROWS IN A MULTIPLE UPDATE"),console.log(a),n.take(a,r,i.conditions).then(function(e){s(null,{updated:!1,taken:e})}).catch(function(e){s(e,null)}))}).catch(function(e){s(e,null)}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(10),s(e.t0,null);case 20:case"end":return e.stop()}},e,this,[[10,17]])}));return function(){return e.apply(this,arguments)}}(),Yt=function(){var e=ut(regeneratorRuntime.mark(function e(t){var s,n,i,a,o,l,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("THE INSERTANDTAKE"),console.log(t),n=(s=this).pao,i=t.conn,a=t.outComehandler,o=t.query.insert,l=t.query.take,n.pa_isObject(t))try{r=function(){var e=ut(regeneratorRuntime.mark(function e(){var t,n,o,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<r.length&&void 0!==r[0]?r[0]:null,n=1<r.length&&void 0!==r[1]?r[1]:null,e.next=4,s.log("THE INSERTED RECORD UPDATE");case 4:return e.next=6,s.log(t);case 6:return e.next=8,s.log(n);case 8:return e.next=10,s.log(s.SEARCH);case 10:return l.conditions||(l.conditions=["id ISEQUAL ".concat(n.insertId)]),e.next=13,s.log(l);case 13:(o={}).conn=i,o.query=l,o.outComehandler=function(){a(null,{inserted:n,taken:1<arguments.length?arguments[1]:void 0})},s.search(o);case 18:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),o.outComehandler=r.bind(s),o.conn=i,s.insertOne(o)}catch(e){a(e,null)}else;case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),Xt=function(){var e=ut(regeneratorRuntime.mark(function e(t){var s,n,i,a,l,c,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("THE DELETEANDTAKE"),console.log(t),n=(s=this).pao,i=t.conn,a=t.outComehandler,c=l=null,t.query.remove&&(l=t.query.remove,c=t.query.take),n.pa_isObject(t))try{o=function(){var e=ut(regeneratorRuntime.mark(function e(){var t,n,o,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<r.length&&void 0!==r[0]?r[0]:null,n=1<r.length&&void 0!==r[1]?r[1]:null,e.next=4,s.log("THE deleted RECORD UPDATE");case 4:return e.next=6,s.log(t);case 6:return e.next=8,s.log(n);case 8:if(c){e.next=12;break}a(null,{deleted:n}),e.next=20;break;case 12:return c.conditions||(c.conditions=l.conditions),e.next=15,s.log(c);case 15:(o={}).conn=i,o.query=c,o.outComehandler=function(){var e=1<arguments.length?arguments[1]:void 0;console.log("DELETED AND TAKEN OPERATION"),console.log(n),console.log(e),a(null,{deleted:n,taken:e})},s.search(o);case 20:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),(l=l||t.query).outComehandler=o.bind(s),l.conn=i,s.removeJoin(l)}catch(e){a(e,null)}else;case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),Zt=function(){var e=ut(regeneratorRuntime.mark(function e(s,i){var a,t,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(a=this).pao,l=t.pa_contains,e.abrupt("return",new Promise(function(o,r){try{var e,t=null,n=a.updateJoinTemplate(s);console.log("THE SQLKIKS OBJECT"),console.log(n),t=l(n.attribs,"tables")&&n.attribs.tables?[n.attribs.from.table].concat(dt(n.attribs.tables)):[n.attribs.from.table],e=n.statement;t=t;console.log("THE SQL BEFORE FORMAT::MULTIUPDATE"),console.log(e),e=i.format(e,t),console.log(e),i.query(e,function(e,t,n){return e?r(e):void o(t)})}catch(e){r(e)}}));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),$t=function(){var e=ut(regeneratorRuntime.mark(function e(o,r,s){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(i=this).pao,console.log("TAKE:::"),console.log(o),e.abrupt("return",new Promise(function(t,n){var e;o.takeFrom?(e=o.takeFrom,console.log("THE TAKEFROM BY TAKEFROM"),console.log(e),e.condition?(i.log("THE TAKEFROM CONDITIION IS SET"),o.from.condition=e.condition,1<e.tables.length&&(o.length=e.tables.length),!o.length||e.joinPoints&&(o.joinPoints=e.joinPoints),i.takeSql(o,r).then(function(e){t(e)}).catch(function(e){n(e)})):(i.log("THE TAKEFROM HAS NO SET CONDITIONS"),i.log(o),delete o.length,o.from.condition=i.searchConditionsFormat([s[0]]),i.takeSql(o,r).then(function(e){t(e)}).catch(function(e){n(e)}))):(i.log("THE TAKEFROM IS NOT DEFINED"),i.takeSql(o,r).then(function(e){t(e)}).catch(function(e){n(e)}))}));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),en=function(e){console.log("THE search got a call");"function"==typeof e.query?e.query():(console.log("INSIDE SEARCH"),this.SEARCH(e.query,e.conn,e.outComehandler))},tn=function(){var e=ut(regeneratorRuntime.mark(function e(t,n){var o,r,s,i,a,l,c,u,d,f,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=2<h.length&&void 0!==h[2]?h[2]:null,s=(r=this).pao,r.log("THE PROCEDURE METHOD"),r.log(t),r.log(o),r.log(n),a=!(i=[]),l=0;case 10:if(!(l<t.length)){e.next=31;break}if(c=t[l],f=d=u=null,s.pa_contains(c,"fields")){e.next=20;break}return o("Required collection/table field missing"),e.abrupt("break",31);case 20:s.pa_contains(c.fields,"tables")&&(console.log("sources will be assigned A VALUE"),d=c.fields.tables,f=c.fields.own);case 21:return d&&(u=r.combineFields(d,f,i)),u&&(c.fields=u),e.next=25,r.insert(c,n).then(function(e){i.push(e)}).catch(function(e){o(e,null),a=!0});case 25:if(a)return e.abrupt("break",31);e.next=27;break;case 27:l===t.length-1&&(console.log("Operation completed successfully"),console.log(i),0<i.length?(console.log("PROCEDURE IS COMPLETED"),console.log(i),o(null,{user:{username:i[0].fields.email}})):o("An insert has went wrong"));case 28:l++,e.next=10;break;case 31:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),nn=function(){var e=ut(regeneratorRuntime.mark(function e(t,n){var o,r,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=2<s.length&&void 0!==s[2]?s[2]:null,(r=this).pao,r.joinExek(t,n).then(function(e){console.log("jOIN is successful, sending results to the requester"),console.log(e),o(null,e)}).catch(function(e){console.log("JOIN FAILED"),console.log(e),o(e,null)});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),on=function(){var e=ut(regeneratorRuntime.mark(function e(s,i){var a,l,t,n=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=2<n.length&&void 0!==n[2]?n[2]:null,t=(l=this).pao,console.log("THE SEARCH search object contents"),console.log(s),t.pa_contains(s,"batch")){e.next=9;break}l.searchExek(s,i).then(function(e){console.log("search is successful, sending results to the requester"),a(null,e)}).catch(function(e){console.log("search FAILED"),console.log(e),a(e,null)}),e.next=10;break;case 9:return e.delegateYield(regeneratorRuntime.mark(function e(){var n,o,t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],o=s.search,t=regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.searchExek(o[t],i).then(function(e){console.log("search is successful, pushing results to the resultSet"),n.push(e),t===o.length-1&&(console.log("Operation completed successfully"),a(null,n))}).catch(function(e){console.log("search FAILED"),console.log(e),n.push({item:t,errorMessage:"Item of ".concat(t," position has failed"),error:e})});case 2:case"end":return e.stop()}},e)}),r=0;case 4:if(r<o.length)return e.delegateYield(t(r),"t0",6);e.next=9;break;case 6:r++,e.next=4;break;case 9:case"end":return e.stop()}},e)})(),"t0",10);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();function rn(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,rn),this.pao=e,this.init=ht,this.handleMysqlDataRequest=pt,this.insertOne=gt,this.insertMany=mt,this.find=Qt,this.remove=yt,this.updateOne=Et,this.set=Vt,this.queryOptions=Tt,this.queryTemplate=St,this.TRANSACTION=It,this.PROCEDURE=tn,this.JOIN=nn,this.SEARCH=on,this.procedure=wt,this.transaction=Rt,this.join=Nt,this.joinExek=Dt,this.joinStatement=Ht,this.joinConditionsFormat=xt,this.search=en,this.searchExek=Pt,this.searchStatement=jt,this.searchConditionsFormat=_t,this.searchOptions=Ft,this.combineFields=At,this.insert=kt,this.rollback=Ct,this.searchFieldsFormat=Lt,this.fieldFormat=qt,this.options=Mt,this.sort=Ut,this.limit=Bt,this.parseGroup=Gt,this.parseFormatCondition=Jt,this.getOperand=Wt,this.conditionsConnector=Kt,this.updateandtake=zt,this.insertandtake=Yt,this.deleteandtake=Xt,this.updateJoinTemplate=Ot,this.multiTableUpdate=Zt,this.take=$t,this.takeSql=vt,this.removeJoin=bt}function sn(){console.log("Dao has been initialised"),this.listens({"dao-take-dbs":this.handleDaoTakeDbs.bind(this),"data-hive-request":this.handleDataHiveRequest.bind(this)})}function an(e){var t=this.pao;if(console.log("DAO"),console.log(e),!t.pa_contains(this.DBS,e.model.vendor))throw new Error("Specified database client is unknown");t=e.model,this.emit({type:"".concat(t.vendor,"-data-request"),data:{conn:this.DBS[t.vendor],table:t.table,opi:t.operation,query:e.document,outComehandler:e.handler}})}function ln(e){var t=this;t.log("Handling Hive Request"),null===t.DBS&&(t.DBS={}),t.DBS[e.vendor]=e.conn}function cn(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,cn),this.pao=e,this.DBS=null,this.init=sn,this.handleDataHiveRequest=an,this.handleDaoTakeDbs=ln}function un(){this.log("Dman has been initialised"),this.listens({"config-dman":this.handleConfigureDBMan.bind(this)})}function dn(e){var n=this,o=n.pao;if(o.pa_isObject(e))if(o.pa_contains(e,"clients"))if(o.pa_isArray(e.clients)){var r=n.supportedClients;try{e.clients.forEach(function(e,t){o.pa_contains(r,e.name)?(console.log("THE SYSTEM IS ABOUT TO CONNECT TO THE THE SERVER"),n.connectToClient(e)):n.throwError('Client: "'.concat(e.name,' is not supported by the system"'))}),0<n.DBS.length&&(n.log("Sending databases to the dao"),n.emit({type:"dao-take-dbs",data:{dbs:n.DBS}}))}catch(e){}}else;else n.error("System requires clients property with valid config to interface with database clients");else n.log("No Client database client specified,System will use default","warn")}function fn(e){this.log("System is about to connect to client: ".concat(e.name)),this.getClientDriver(e)}function hn(e){console.log("System is getting a client driver"),console.log("THE OTHER DETAILS BELOW"),console.log(e.name),console.log("mysql"===e.name);try{"mysql"===e.name&&(this.supportedClients[e.name].driver=n(21)),this.supportedClients[e.name].driver||(console.log("THE DRIVER REQUIREMENT FAILED"),this.throwError("Failed to get client driver module")),this.connect(e)}catch(e){console.log("THE DRIVER CONNECT ERROR"),console.log(e.stack)}}function pn(n){var o=this;o.logSync("System is connecting to client: ".concat(n.name));try{var e=o.supportedClients[n.name],t={host:n.connect.host,user:n.connect.user,password:n.connect.pass,database:n.connect.name},r=e.driver[e.connectMethod](t,function(e,t){e?(console.log("THE ACTUAL CONNECTION ERROR"),console.log(e.stack)):(o.DBS[n.name]=t,o.log("System has successfully connected to client"),o.log("Client ready to serve queries"))});r.connect(function(e){if(e)throw o.logSync("THE SYSTEM HAS FAILED TO CONNECT TO THE DATABASE, please refer to the error below:"),o.logSync(e.message),new Error(e);o.DBS[n.name]=r,o.log("System has successfully connected to client"),o.log("System is handing client connection"),o.emit({type:"dao-take-dbs",data:{vendor:n.name,conn:r}}),o.log("Client ready to serve queries")})}catch(e){console.log("THE CONNECTION EROR"),console.log(e.stack)}}function gn(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,gn),this.pao=e,this.DBS=[],this.supportedClients={mysql:{protocol:"",connectMethod:"createConnection"}},this.init=un,this.handleConfigureDBMan=dn,this.connectToClient=fn,this.getClientDriver=hn,this.connect=pn}function mn(){console.log("Global has been initialised"),this.listens({"request-global-request":this.handleRequestGlobalRequest.bind(this)})}function En(e){var t=this;t.log("The Modules: ",t.globals),t.globals&&0<t.globals.length?-1<t.globals.indexOf(e)?t.emit({type:"request-global-request-response",data:!0}):t.emit({type:"request-global-request-response",data:!1}):t.emit({type:"request-global-request-error",data:!1})}function On(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,On),this.pao=e,this.globals=[],this.init=mn,this.handleRequestGlobalRequest=En}function vn(e){var t=0<arguments.length&&void 0!==e?e:[];console.log("The Server"),console.log("THE LIBS"),console.log(t),console.log(this.ESM.Esm);var r=new this.ANZII.CORE(this.ANZII.PILLAR),s=new this.ANZII.PAO(r),e={Anziiloger:this.ESM.Esm.Anziiloger};delete this.ESM.Esm.Anziiloger,t.unshift(e),t.push(this.ESM.Esm),t.forEach(function(e){for(var t in e){console.log("Inside activate"),console.log(t);var n=t.toLowerCase(),o=n;r.createModule(new e[t](s.create(n,null,t)),n,o,t),r.startModule(n,o)}})}var bn=new function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Esm={Anziiloger:Ge,Mysql:rn,System:nt,Middleware:b,Parsers:S,Router:G,Request:ae,Dao:cn,Dman:gn,Server:ye,Config:Ce,Global:On}};o=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);this.ANZII=d,this.ESM=bn,this.Activate=vn},t.default=new o}]);
=======
module.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t){e.exports=require("path")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("jsonfile")},function(e,t,n){function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw s}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=n(2),a=n(8),c=n(9),l=n(10),u=n(11),h=n(0),f=n(12);e.exports={EMAIL:"",PASSWORD:"",p_o_freeze:function(e){return e instanceof Object?Object.freeze(e):null},p_clone:function(e){return e instanceof Object?JSON.parse(JSON.stringify(e)):null},p_deepMerge:function(e,t){return l(!0,t,e)},p_ane:function(e){if(a.isError(e))throw e},p_initArray:function(e,t){for(var n=[],o=this.p_isFunction(t),r=0;r<e;r++)n.push(o?t(r):t);return n},p_escapeRegExp:function(e){return RegExpUtils.escape(e)},p_merge:function(e,t){return p_forEach(e,(function(e,n){t[n]=e})),t},p_union:function(e,t){var n={};return p_merge(e,n),p_merge(t,n),n},p_getTasks:function(e,t){for(var n=[],o=0;o<e.length;o++)n.push(t(e,o));return n},p_wrapTask:function(e,t,n){return a.isArray(n)||(n=[]),function(o){n.push(o),t.apply(e,n)}},p_wrapTimedTask:function(e,t,n,o){p_isString(o)&&(n=o,o=[]);var r=p_wrapTask(e,t,o);return function(e){var t=Date.now();r((function(o,r){e(o,{result:r,time:Date.now()-t,start:t,name:n})}))}},p_forEach:function(e,t){var n,o;if(a.isArray(e))n=t,o=e;else{if(!p_isObject(e))return!1;o=Object.getOwnPropertyNames(e),n=function(n,o){t(e[n],n,e,o)}}o.forEach(n)},p_arrayToHash:function(e,t){if(!a.isArray(e))return null;p_isNullOrUndefined(t)&&(t=!0);for(var n={},o=0;o<e.length;o++)this.p_isFunction(t)?n[t(e,o)]=e[o]:n[e[o]]=t;return n},p_unikify:function(e){for(var t=e.concat(),n=0;n<t.length;++n)for(var o=n+1;o<t.length;++o)t[n]===t[o]&&t.splice(o--,1);return t},p_arrayToObj:function(e,t,n){if(!a.isArray(e))return null;var o=p_isString(t),r=this.p_isFunction(t);if(!o&&!r)return null;var i=p_isString(n),s=this.p_isFunction(n);i||s||(n=null);for(var c={},l=0;l<e.length;l++){var u=e[l],h=o?u[t]:t(e,l);c[h]=i?u[n]:s?n(e,l):u}return c},p_objArrayToHash:function(e,t){if(!a.isArray(e))return null;for(var n={},o=0;o<e.length;o++)n[e[o][t]]=e[o];return n},p_hashToArray:function(e,t){if(!p_isObject(e))return null;var n=p_isString(t);return Object.keys(e).reduce((function(o,r){return o.push(e[r]),n&&(e[r][t]=r),o}),[])},p_invertHash:function(e){if(!p_isObject(e))return null;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t},p_copyArray:function(e){if(!a.isArray(e))return null;for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},p_dedupeArray:function(e){var t=p_arrayToHash(e);return Object.keys(t)},p_arrayPushAll:function(e,t){if(!a.isArray(e)||!a.isArray(t))return!1;for(var n=0;n<e.length;n++)t.push(e[n])},p_cb:function(){},p_generateUniqueID:function(){return f.v4()},p_isObject:function(e){return!this.p_isNullOrUndefined(e)&&"object"===i(e)},p_isString:function(e){return!this.p_isNullOrUndefined(e)&&"string"==typeof e},p_isFunction:function(e){return!this.p_isNullOrUndefined(e)&&"function"==typeof e},p_isNullOrUndefined:function(e){return null==e},p_isBoolean:function(e){return!0===e||!1===e},p_getDirectories:function(e){var t=this;return new Promise((function(n,o){var r=[];u.readdir(e,(function(i,s){if(a.isError(i))return o(i);var l=t.p_getTasks(s,(function(n,i){return function(s){var c=h.join(e,n[i]);u.stat(c,(function(e,n){if(a.isError(e))return o(e);t.p_isNullOrUndefined(n)?console.log("WARN: Util: unstatable file encountered: %s",c):n.isDirectory()&&r.push(c),s(e)}))}}));c.parallel(l,(function(e){n(r)}))}))}))},p_getFiles:function(e,t,n){var o=this;return new Promise((function(r,i){t||(t={recursive:!1,filter:function(){return!0}}),console.log("The directory path"),console.log(e),console.log(n),u.readdir(e,(function(s,l){if(a.isError(s))return i(s);console.log("The readdir results q"),console.log(l);for(var f=0;f<l.length;f++)console.log(),l[f]=h.join(e,l[f]);var d=[];c.whilst((function(){return l.length>0}),(function(e){var n=l.shift();u.stat(n,(function(r,i){if(a.isError(r))return e(r);var s=!0;if(o.p_isFunction(t.filter)&&(s=t.filter(n,i)),s&&d.push(n),!t.recursive||!i.isDirectory())return e(null);u.readdir(n,(function(t,o){if(a.isError(t))return e(t);o.forEach((function(e){l.push(h.join(n,e))})),e(null)}))}))}),(function(t){console.log("THE FILES ARRay");var o=e+h.sep+n;if(console.log(o),-1!==d.indexOf(o)){console.log("THE IS A NEED FOR A SPECIFIC FILE");var i=d[d.indexOf(o)],s=i.substr(o.indexOf(n),i.length-1);console.log(i),console.log(s),r(s)}else r(d)}))}))}))},p_getFile:function(e){return new Promise((function(t,n){console.log("The directory path"),console.log(e);var o=u.createReadStream(e);o&&t(o)}))},p_isDirectory:function(e){},p_mkdirs:function(e,t,n){var o=this;return new Promise((function(n,r){if(o.p_isFunction(t)&&(t,t=!1),!o.p_isString(e))return r(new Error("absoluteDirPath must be a valid file path"));var i=e.split(h.sep),a="",l=-1!==s.type().toLowerCase().indexOf("windows"),f=o.p_getTasks(i,(function(e,n){return function(o){var r=e[n];if(0===r.length||t&&n>=e.length-1)return o();a+=(l&&0===n?"":h.sep)+r,u.exists(a,(function(e){if(e)return o();u.mkdir(a,o)}))}}));c.series(f,(function(e){if(e)return r(e);n(!0)}))}))},p_mkdirsSync:function(e,t){if(!this.p_isString(e))throw new Error("absoluteDirPath must be a valid file path");var n=e.split(h.sep),o="",r=-1!==s.type().toLowerCase().indexOf("windows");n.forEach((function(e,i){0===e.length||t&&i>=n.length-1||(o+=(r&&0===i?"":h.sep)+e,u.existsSync(o)||u.mkdirSync(o))}))},p_getExtension:function(e,t){if(!this.p_isString(e)||e.length<=0)return null;this.p_isObject(t)||(t={});var n=e.lastIndexOf(t.sep||h.sep)||0;n>-1&&(e=e.substr(n));var o=null,r=e.lastIndexOf(".");return r>=0&&(o=e.substring(r+1),t.lower&&(o=o.toLowerCase())),o},p_getFileExtensionFilter:function(e){var t="."+e;return function(e){return e.lastIndexOf(t)===e.length-t.length}},p_inherits:function(e,t){if(p_isNullOrUndefined(e)||p_isNullOrUndefined(t))throw new Error("The type parameters must be objects or prototypes");a.inherits(e,t),p_merge(t,e)},js_to_json:function(e,t,n){return JSON.stringify(e)},json_to_js:function(e,t){return JSON.parse(e)},clone:function(e){var t=this;if(e instanceof Array){var n=[];return e.forEach((function(e){e instanceof Array||e instanceof Object?n.push(t.clone(e)):n.push(e)})),n}if(e instanceof Object&&"function"!=typeof e){var o={};for(var r in e)e[r]instanceof Array||e[r]instanceof Object&&"function"!=typeof e[r]?o[r]=this.clone(e[r]):("callback"===r&&console.log("The current property is callback"),o[r]=e[r]);return o}},object_to_array:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(console.log("THE CAST OBJECT"),console.log(e),e instanceof Object){if(e instanceof Array)return e;var n=[],o=0;if(t)for(var r in e)n[o]={key:r,value:e[r]},++o;else for(var i in e)n[o]=e[i],++o;return console.log("THE RETURN OF CONVERTED OBJECT"),console.log(n),n}this.throwErrors("Argument 1 of object_to_array() must be an object")},array_to_object:function(e){if(e instanceof Array){for(var t={},n=0;n<e.length;n++){t["property_"+(n+1)]=e[n]}return t}this.throwErrors("Argument 1 of array_to_object() must be an array")},string_to_array:function(e,t){if(console.log("STRING TO ARRAY"),console.log(e),console.log(t),this.is_string(e))return console.log("THE STRING IS AN INSTANCE OF STRING"),e.split(t)},set_deeply:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return 1===e.length?(console.log("ABOUT TO SET DEEPLY NESTED PROP"),console.log("THE DEEP"),console.log(t),n?t[e[0]]=n:(console.log("THIS DEEP ARRAY"),console.log(this.js_to_json(t)),console.log("THE DEEP I,i"),t.splice(e[0],1),console.log(t)),console.log(e),console.log(e[0]),console.log(t[e]),!0):t[e[0]]?this.set_deeply(e.slice(1),t[e[0]],n,o):(console.log("THE PROPERTY BELOW DOES NOT EXIST"),console.log(e),console.log(e[0]),!1)},get_deeply:function(e){},is_function:function(e){return"[object Function]"===Object.prototype.toString.call(e)},is_array:function(e){return"[object Array]"===Object.prototype.toString.call(e)},is_date:function(e){return"[object Date]"===Object.prototype.toString.call(e)},is_object:function(e){return"[object Object]"===Object.prototype.toString.call(e)},is_string:function(e){return"[object String]"===Object.prototype.toString.call(e)},is_value:function(e){return!this.isObject(e)&&!this.isArray(e)},is_not_falsey:function(e){return!!this.trim_spaces(e)},trim_spaces:function(e){return e instanceof String?e.trim():e},compare_values:function(e,t){e!==t&&(this.is_date(e)&&this.is_date(t)&&e.getTime()===t.getTime()||e===t||(e=t))},is_equal_ab:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"values";if(!this.is_object(e)||!this.is_object(t))return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;if("keys"===n.trim()){Object.keys(e).sort();var o=Object.keys(t).sort();return JSON.stringify(aKeys)===JSON.stringify(o)}return this.js_to_json(e)===this.js_to_json(t)},is_valid_email:function(e){return!0},is_valid_password:function(e){return!0},is_same_value:function(e,t){return this.isBrowserSupported("Object","is")?Object.is(e,t):this.polyFills().objectIs(e,t)},unlike_props:function(e,t){var n=Object.keys(e),r=Object.keys(t);if(e.length>t.length){var i,s=null,a=o(n);try{for(a.s();!(i=a.n()).done;){var c=i.value;e[c]!==t[c]&&(s?s.a.push(c):s={a:[c]})}}catch(e){a.e(e)}finally{a.f()}return s}var l,u=o(r);try{for(u.s();!(l=u.n()).done;){var h=l.value;t[h]!==e[h]&&(unlike?unlike.b.push(h):unlike={b:[h]})}}catch(e){u.e(e)}finally{u.f()}return unlike},throwErrors:function(e){throw new Error(e)},contains:function(e,t){if(this.is_array(e))return e.indexOf(t)>-1;if(this.is_object(e)){if(this.is_array(t)){console.log("THE SPECIFED VALUE TO CHECK IS AN ARRAY"),console.log(t);for(var n="",o=0;o<t.length;o++){if(!e.hasOwnProperty(t[o])){n=!1;break}o===t.length-1&&(n=!0)}return console.log("THE OUTCOME"),console.log(n),n}return!!e.hasOwnProperty(t)}this.throwErrors("Contains() requires either an array pure js object")},for_of:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e=this.clone(e),this.is_array(e))e.forEach(t);else if(this.is_object(e)){if(!n){console.log("THE Y IS DEFINED");var o={};for(var r in e){var i=t(r,e[r]);o[i.p]=i.v}return o}for(var s in e)t(s,e[s])}else this.throwErrors("Object of for_of() must be an Array or pure object")},add_values_to:function(e,t,n){if(this.is_array(e))e.forEach(action);else{if(this.is_object(e))return t.forEach((function(t,o){var r=Object.keys(n[t]);e[t]||(e[t]={}),r.forEach((function(o){e[t][o]=n[o]}))})),e;this.throwErrors("Object of for_of() must be an Array or pure object")}},find_in:function(e,t,n){if(this.is_array(e)){if(this.is_value(e[0]))return e.indexOf(n)>-1&&e[n];if(this.is_object(e[0]))for(var o=0;o<e.length;o++)if(sb.sb_contains(e[o],t)&&e[o][t]===n)return e[o]}}}},function(e,t,n){n(6),e.exports=n(7)},function(e,t){e.exports=require("@babel/polyfill")},function(e,t,n){var o=n(22).default;e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;console.log("ANZII OBJECT"),console.log(o),console.log(o.Activate),e?o.Activate([e]):o.Activate()}},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("async")},function(e,t){e.exports=require("node.extend")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("uuid")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("config")},function(e,t){e.exports=require("supports-color")},function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=16},function(e,t){e.exports=require("winston")},function(e,t){e.exports=require("debug")},function(e,t){e.exports=require("cluster")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("mysql")},function(e,t,n){"use strict";n.r(t);var o=n(4),r=n.n(o);function i(e){this.PILLAR=e,this.modules={},this.globalModules=[]}i.prototype.createModule=function(e,t,n){var o=this.modules;if(this.sanna().runForModules(e),Object.keys(o).length>0)for(var r in o)r===t||(this.modules[t]={}),this.modules[t][n]=e;else this.modules[t]={},this.modules[t][n]=e},i.prototype.events=function(){var e=this.PILLAR;return{addEventHandler:function(t,n,o){if("undefined"==typeof window)return e.ev_addHandler(t,n,o);e.ev_addHandler(t,n,o)},removeEventHandler:function(t,n,o){e.ev_removeHandler(t,n,o)},getEvent:function(t){return e.getEvent(t)},getTarget:function(t){return e.getTarget(t)},preventNormal:function(t){e.preventDefault(t)},stopEventBubble:function(t){e.stopPropagation(t)}}},i.prototype.ajax=function(){var e=this.PILLAR;return{get:function(t,n,o,r,i){e.ajax_get(t,n,o,r,i)},post:function(t,n,o,r,i){e.ajax_post(t,n,o,r,i)}}},i.prototype.validators=function(){var e=this.PILLAR;return{isFunction:function(t){return e.is_function(t)},isArray:function(t){return e.is_array(t)},isDate:function(t){return e.is_date(t)},isObject:function(t){return e.is_object(t)},isString:function(t){return e.is_string(t)},isValue:function(t){return e.is_value(t)},isNotFalsey:function(t){return e.is_not_falsey(t)},trimSpaces:function(t){return e.trim_spaces(t)},isEqualab:function(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.is_equal_ab(t,n,o)},isSameValue:function(t,n){return e.is_same_value(t,n)},isValidEmail:function(t){return e.is_valid_email(t)},isValidPassword:function(t){return e.is_valid_password(t)},unlikeProps:function(t,n){return e.unlike_props(t,n)},contains:function(t,n){return e.contains(t,n)},forOf:function(t,n,o){return e.for_of(t,n,o)},addValuesTo:function(t,n,o){return e.add_values_to(t,n,o)},findIn:function(t,n,o){return e.find_in(t,n,o)}}},i.prototype.util=function(){var e=this.PILLAR;return{makeDirs:function(t,n,o){return e.p_mkdirs(t,n,o)},mkdirsSync:function(t,n,o){return e.p_mkdirs(t,n,o)},getFiles:function(t,n,o){return e.p_getFiles(t,n,o)},getFile:function(t){return e.p_getFile(t)},getDirectories:function(t){return e.p_getDirectories(t)},getExtension:function(t,n){return e.p_getExtension(t,n)},generateUniqueID:function(){return e.p_generateUniqueID()},unikify:function(t){return e.p_unikify(t)}}},i.prototype.registerEvents=function(e,t,n){e&&t&&n&&this.modules[t][n]&&(this.modules[t][n].events=e)},i.prototype.triggerEvent=function(e){if(e)for(var t in this.modules)if(this.modules.hasOwnProperty(t))for(var n in t=this.modules[t])t[n].events&&t[n].events[e.type]&&t[n].events[e.type](e.data)},i.prototype.startModule=function(e,t){var n=e;this.modules[n][t]&&("anziiloger"!==n&&this.modules.anziiloger.anziiloger.setDebugger(this.modules[n][t].constructor.name),this.modules[n][t].init(),"global"===n&&(console.log("THE GLOBAL MODULES IS ABOUT TO RECEIVE MODULES"),this.modules[n][t].globals=Object.keys(this.modules)))},i.prototype.startAllModules=function(){for(var e in this.modules){var t=this.modules[mod];for(var n in t)try{this.modules[t][n].init()}catch(e){console.log(e)}}},i.prototype.stopModule=function(e,t){var n=e;this.modules[n][t]&&this.modules[n][t].destroy()},i.prototype.stopAllModules=function(){for(var e in this.modules){var t=this.modules[mod];for(var n in t)try{this.modules[t][n].destroy()}catch(e){console.log(e)}}},i.prototype.converts=function(){var e=this.PILLAR;return{jsToJson:function(t){return e.js_to_json(t)},jsonToJs:function(t){return e.json_to_js(t)},clone:function(t){return e.clone(t)},objectToArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.object_to_array(t,n)},stringToArray:function(t,n){return e.string_to_array(t,n)}}},i.prototype.sanna=function(){var e=this;return{modules:{validators:{emit:function(t){if(t.hasOwnProperty("emit")){if("function"!=typeof t.emit)throw new Error("Emit is a reserved Akii method")}else t.emit=e.sanna().modules.addiks.emit.bind(t)},listens:function(t){if(t.hasOwnProperty("listens")){if("function"!=typeof t.listens)throw new Error("Listens is a reserved ANZii method")}else t.listens=e.sanna().modules.addiks.listens.bind(t)},log:function(t){t.log=e.sanna().modules.addiks.log.bind(t)},logSync:function(t){t.logSync=e.sanna().modules.addiks.log.bind(t)},query:function(t){t.query=e.sanna().modules.addiks.query.bind(t)}},addiks:{emit:function(e){this.pao.pa_notifyEvent({type:e.type,data:e.data})},listens:function(e){var t=this.pao;this.log("MODULE",this.constructor.name,"listens to event(s):",e);var n=this.constructor.name.toLowerCase(),o=this.constructor.name.toLowerCase();t.pa_notifyListen(e,n,o)},log:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"No message provided",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"console",n=this,o=(this.pao,{message:e,type:t});o.source=n.constructor.name,n.emit({type:"anziiloger-log",data:o})},logSync:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"No message provided",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"console",n=this,o=(this.pao,{message:e,type:t});o.source=n.constructor.name,o.sync=!0,n.emit({type:"anziiloger-log",data:o})},query:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this,r=o.pao;if(!e||!t)throw new Error("Query method missing required parameters");var i=r.pa_isString(e)?r.pa_stringToArray(e,"."):e;if(console.log(r.pa_stringToArray),console.log(i),3===i.length){var s={vendor:i[0],table:i[1],operation:i[2]};o.emit({type:"data-hive-request",data:{model:s,document:t,handler:n}})}else{e[1].trim();var a={vendor:i[0],table:i[1].toLowerCase(),operation:i[1].toLowerCase()};o.emit({type:"data-hive-request",data:{model:a,document:t,handler:n}})}}}},runForModules:function(e){var t=this.modules.validators;for(var n in t)t[n](e)}}};var s=i;function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){this.core=e}u.prototype.create=function(e,t){var n=this.core,o=n.validators().forOf(n.util(),(function(e,t){return{p:["pa_".concat(e)],v:t}})),r=n.validators().forOf(n.converts(),(function(e,t){return{p:["pa_".concat(e)],v:t}})),i=n.validators().forOf(n.validators(),(function(e,t){return{p:["pa_".concat(e)],v:t}}));if(t)var s={moduleId:e,modInstId:t};else s={moduleId:e,modInstId:e};return c(c(c(c({moduleMeta:s},o),i),r),{},{pa_notifyListen:function(e,t,o){n.registerEvents(e,t,o)},pa_notifyEvent:function(e){n.triggerEvent(e)}})};var h=u;var f=new function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.CORE=s,this.PAO=h,this.PILLAR=r.a};function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(){this.log("Middleware has been initialised"),this.listens({"config-middleware":this.handleConfigMiddleware.bind(this),"add-ext-middleware":this.handleAddExternalMiddleware.bind(this),"attach-middleware":this.handleAttachMiddleware.bind(this)})},m=function(e){this.attachMiddleware(e)},E=function(e){var t=this,n=e,o=function(e){t.middlewares[e]?n[e].addMiddleware&&n[e].addMiddleware.forEach((function(n,o){t.middlewares[e].push(n)})):n[e].addMiddleware&&(t.middlewares[e]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n[e].addMiddleware))};for(var r in n)o(r)},v=function(e){var t=this,n=t.pao;if(t.log("ADD EXTERNAL MIDDLEWARE EVENT HAS OCCURED"),e.type)if("private"===e.type){if("top"===e.level)if(n.pa_isArray(e.middleware.funk))e.middleware.forEach((function(e,n){t.middleware.unshift({type:"function",value:e.funk,ext:!0})}));else if(t.log("THE MIDDLEWARES BEFORE"),t.log(t.middlewares),t.middlewares.pprivate){var o=Object.keys(t.middlewares.pprivate).length;t.middlewares.pprivate[o]={type:"function",value:e.middleware.funk,ext:!0},t.log("Middlewares"),t.log(t.middlewares)}}else"public"===e.type||"all"===e.type&&e.level},O=function(e){e.app&&(this.all.length>0&&(console.log("THE Allwares is greater than zero"),e.xpress&&this.allWares(e.app,e.xpress)),this.middlewares.pprivate&&this.middlewares.ppublic?this.emit({type:"router-middleware",data:{middleware:{public:this.middlewares.ppublic,private:this.middlewares.pprivate}}}):this.middlewares.private?this.emit({type:"router-middleware",data:{middleware:{private:this.middlewares.pprivate}}}):this.middlewares.public&&this.emit({type:"router-middleware",data:{middleware:{public:this.middlewares.ppublic}}}),this.middlewares.all&&this.middlewares.all.forEach((function(t,n){"function"===t.type?e.app.use(t.value):t.type})))},y=function(e,t){var n=this,o=n.pao;n.all.forEach((function(r,i){o.pa_isObject(r)?(console.log("Executing allwares"),r.use?(console.log("The public:",r.call),e.use(t[r.call]("public"))):(console.log("The none-public:",r.call),e.use(t[r.call]()))):(n.log("middleware is string"),e.use(t[r]()))}))};n(1);var b=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.all=[{call:"static",use:"public"},"json"],this.middlewares={all:[{type:"function",value:function(e,t,n){console.log("I am the zeenith ware"),t.header("Access-Control-Allow-Origin","*"),t.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),n()}}]},this.init=g,this.handleAttachMiddleware=m,this.attachMiddleware=O,this.handleConfigMiddleware=E,this.handleAddExternalMiddleware=v,this.allWares=y},T=function(){this.log("Parsers has been initialised"),this.listens({"share-middleware":this.handleShareMiddleware.bind(this)})},S=function(){console.log("HANLDE SHARE MIDDLEWARE EVENT HAS OCCURED"),this.emit({type:"add-ext-middleware",data:{type:"all",level:"top",middleware:{funk:[{body:this.dependiks.bodyParser,call:"json"}]}}})};var R=n(3),w=n(0),N=n(1),I=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.path=w,this.dependiks={jsonfile:R,bodyParser:N},this.init=T,this.handleShareMiddleware=S};function k(e,t,n,o,r,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(o,r)}function A(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function s(e){k(i,o,r,s,a,"next",e)}function a(e){k(i,o,r,s,a,"throw",e)}s(void 0)}))}}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=function(){console.log("Router has been initialised"),this.listens({"config-router":this.handleConfigRouter.bind(this),"router-middleware":this.handleRouterMiddleware.bind(this),"attach-routes":this.handleAttachRoutes.bind(this)})},H=function(e){console.log("THE HANDLE CONFIG ROUTER MODULE");this.routes=e},j=function(e){console.log("THE ROUTER MIDDLEWARE"),console.log(e),this.routerMiddleware=e.middleware},F=function(e){this.attachRoutes(e)},P=function(e){var t=this;if(e.app){var n=[],o=[];if(e.app.use("/",e.router),!t.routes){t.logSync("Anzii is rendering default routes::");return void[{path:"/test",method:"POST",type:"public"},{path:"/test",method:"GET",type:"public"},{path:"/",method:"GET",type:"public"}].forEach((function(r,i){r.alias&&(n.push(r.path.split("/")[1]),o.push(r.alias)),r.router=e.router,t.renderRoute(r)}))}t.routes.forEach((function(r,i){r.alias&&(n.push(r.path.split("/")[1]),o.push(r.alias)),r.router=e.router,t.renderRoute(r)})),n.length>0&&t.emit({type:"router-alias-list",data:{aliasList:n,handlers:o}})}},L=function(e){var t=this.pao,n={router:e.router,method:e.method,path:e.path,handOver:this.handOver};e.middlewares?this.routerMiddleware&&this.routerMiddleware[e.type]?(this.middlewareType(e.type,e.middlewares),this.middlewareType(e.type,t.pa_objectToArray(this.routerMiddleware[e.type])),this.appendRouter(D({middleware:this["filtered".concat(e.type,"Middlewares")]},n))):(this.middlewareType(e.type,e.middlewares),this.appendRouter(D({middleware:this["filtered".concat(e.type,"Middlewares")]},n))):this.routerMiddleware&&this.routerMiddleware[e.type]?(this.middlewareType(e.type,t.pa_objectToArray(this.routerMiddleware[e.type])),this.appendRouter(D({middleware:this["filtered".concat(e.type,"Middlewares")]},n))):this.appendRouter(n)},q=function(e){e.middleware?e.router[e.method.toLowerCase()](e.path,e.middleware,e.handOver.bind(this)):e.router[e.method.toLowerCase()](e.path,e.handOver.bind(this))},M=function(e,t){var n=this;t.forEach((function(t,o){"function"===t.type?n["filtered".concat(e,"Middlewares")].push(t.value):"module"===t.type&&n.emit({type:"add-".concat(t.value,"-middleware"),data:{type:e,filterCallback:n.filterCallback.bind(n)}})}))},U=function(){var e=A(regeneratorRuntime.mark((function e(t,n){var o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this,e.next=3,o.log("THE OUTOFROUTERCONTEXT REQUESTS");case 3:return e.next=5,o.log(t.originalUrl);case 5:return r={error:!0,type:"NotFound",code:404,message:"Resource was not found: OutOfContext"},e.abrupt("return",o.emit({type:"write-server-request-response",data:{data:r,res:n}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}();function B(e,t){return J.apply(this,arguments)}function J(){return(J=A(regeneratorRuntime.mark((function e(t,n){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this,e.next=3,o.log("THE CAUGHT REQUEST INSIDE ROUTER::END POINT HIT");case 3:return e.next=5,o.log(t.originalUrl);case 5:return e.next=7,o.log(t.params);case 7:return e.next=9,o.log(t.body);case 9:return e.abrupt("return",o.emit({type:"request-handover",data:{req:t,res:n}}));case 10:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}var G=function(e,t){"public"===e?this.filteredpublicMiddlewares.push(t):this.filteredprivateMiddlewares.push(t)};var W=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.routes=null,this.routerMiddleware=null,this.filteredpublicMiddlewares=[],this.filteredprivateMiddlewares=[],this.init=_,this.handleConfigRouter=H,this.handleAttachRoutes=F,this.handleRouterMiddleware=j,this.attachRoutes=P,this.renderRoute=L,this.appendRouter=q,this.middlewareType=M,this.outOfRouterContext=U,this.handOver=B,this.filterCallback=G},K=function(){console.log("Request has been initialised"),this.listens({"request-handover":this.handleRequestHandOver.bind(this),"request-global-request-response":this.handleRequestGlobalResponse.bind(this),"request-global-request-error":this.handleRequestGlobalError.bind(this),"request-handler-error":this.handleHandlerError.bind(this),"router-alias-list":this.handleRouterAliasList.bind(this)})},Q=function(e){this.request.res=e.res;var t=this.routesAliasList,n=this.aliatikHandlers,o=this.parseRequest(e.req);this.logSync("THE ALIATIKS"),this.logSync(o),this.logSync(t),this.logSync(n),e.req.uploads&&(o.user?o.user.uploads=e.req.uploads:o.user={uploads:e.req.uploads});var r=o.handler;t.indexOf(r)>=0&&(r=n[t.indexOf(r)]),r?(this.requestData={parsed:o,user:o.user,handler:r,request:{req:e.req,res:e.res}},this.emit({type:"request-global-request",data:r})):(this.logSync("The current request has no handler"),this.handlePathError())},V=function(e){this.logSync("The req"),this.logSync(e.body),this.logSync(e.query),this.logSync(e.params);var t={url:e.originalUrl},n=0===t.url.indexOf("/")?t.url.slice(1,t.url.length):t.url,o=n.indexOf("/")>0;if(e.query&&Object.keys(e.query).length>0){this.logSync("THE QUERY"),this.logSync(e.query),t.user=e.query;var r=n.split("?");if(o){var i=r[0].split("/");this.logSync("THE PATH FRAGS"),this.logSync(i),t.handler=i[0]}else this.logSync("THE REMAINING CONTENT AFTER SPLIT OF ?"),this.logSync(r),t.handler=r[0]}else if(e.params&&Object.keys(e.params).length>0)if(this.logSync("THE PARAMS"),this.logSync(e.params),t.user=e.params,o){var s=n.split("/");this.logSync("THE PATH FRAGS"),this.logSync(s),t.handler=s[0]}else t.handler=n;else if(e.body&&Object.keys(e.body).length>0)if(this.logSync("THE REQUEST BODY"),this.logSync(e.body),t.user=e.body,o){var a=n.split("/");this.logSync("THE PATH FRAGS"),this.logSync(a),t.handler=a[0]}else t.handler=n;else if(t.user={},o){var c=n.split("/");this.logSync("THE PATH FRAGS"),this.logSync(c),t.handler=c[0]}else t.handler=n;return t},z=function(e){this.writeResponse({error:!0,type:"serverError",code:502,message:"The server error"})},Y=function(e){this.writeResponse({error:!0,type:"ServerError",code:502,message:"The requested task[handler] could not be completed"})},X=function(e){this.log("Router ALIATIKHANDLERS WITH DATA:"),this.log(e),this.routesAliasList=e.aliasList,this.aliatikHandlers=e.handlers},Z=function(e){e?this.emit({type:"handle-".concat(this.requestData.handler,"-task"),data:{payload:this.requestData,callback:this.taskerHandler.bind(this)}}):this.handleByHandlerError()},$=function(){this.writeResponse({error:!0,type:"BadRequest",code:400,message:"Bad Request"})},ee=function(){this.writeResponse({error:!0,type:"NotFound",code:404,message:"The requested task could not be completed"})},te=function(){this.writeResponse({error:!0,type:"notFound",code:404,message:"The requested task could not be completed"})},ne=function(){this.handleHandlerError()},oe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"regular",n=this,o=n.pao;"stream"!==t&&(e=o.pa_isString()?o.pa_jsToJson({text:e}):o.pa_jsToJson(e)),n.emit({type:"write-server-request-response",data:{data:e,res:n.request.res,method:t}})},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this;o.pao;o.logSync("THE TASKER HANDLER"),o.logSync(e),o.logSync(n),e?o.failureHandle({error:!0,message:e}):t&&(n?o.successfullHandle(t,n):o.successfullHandle(t))},ie=function(e,t){this.writeResponse(e,t)},se=function(e){this.writeResponse(e)};var ae=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.request={},this.routesAliasList=[],this.aliatikHandlers=[],this.requestData=null,this.init=K,this.handleRequestHandOver=Q,this.parseRequest=V,this.handleRequestGlobalError=z,this.handleRequestGlobalResponse=Z,this.handleBadRequestError=$,this.handleHandlerNotFound=ee,this.handleByHandlerError=te,this.handleHandlerError=ne,this.handlePathError=Y,this.handleRouterAliasList=X,this.writeResponse=oe,this.taskerHandler=re,this.successfullHandle=ie,this.failureHandle=se};function ce(e,t,n,o,r,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(o,r)}function le(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function s(e){ce(i,o,r,s,a,"next",e)}function a(e){ce(i,o,r,s,a,"throw",e)}s(void 0)}))}}var ue=function(){console.log("Server has been initialised"),this.listens({"config-server":this.handleConfigServer.bind(this),"write-server-request-response":this.handleWriteServerRequestResponse.bind(this)})},he=function(e){this.emit({type:"attach-middleware",data:{app:this.http,xpress:this.xpress}}),this.emit({type:"attach-routes",data:{app:this.http,router:this.router}}),this.emit({type:"distribute-system-resources",data:""}),this.startServer()},fe=function(e){this.runServer()},de=function(){this.http.use(this.dependiks.bodyParser.json()),this.http.use("*.js",(function(e,t,n){return t.set("content-type","text/javascript"),n()})),this.http.use(this.xpress.static("public"))},pe=function(){this.http.get("/todo",this.renderHtml.bind(this)),this.http.get("/ibr",this.renderHtml.bind(this)),this.http.get("/home",this.renderHtml.bind(this)),this.http.use("/",this.renderHtml.bind(this))},ge=function(){this.emit({type:"attach-workers-to-server",data:{app:this.http}})},me=function(e,t){console.log("A request has been made to one of the routes"),console.log("The html"),console.log("The request URL"),console.log(e.url),this.request={req:e,res:t},this.emit({type:"address-changed",data:{url:e.url}})},Ee=function(){var e=le(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,"stream"===t.method){e.next=14;break}return e.next=4,n.log("SERVER IS ABOUT TO SEND RESPONSE BACK TO CLIENT::REGULAR");case 4:return e.next=6,n.log(t.data);case 6:return e.next=8,t.res.set("Connection","close");case 8:return t.res.status(200).send(t.data),e.next=11,n.log("SERVER HAS SENT A RESPONSE BACK TO THE CLIENT::REGULAR");case 11:return e.abrupt("return",e.sent);case 14:n.streamResponse(t);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),ve=function(e){var t=this,n=(t.pao,t.mimeTypes[e.data.ext]),o=e.data.rStream;o.on("open",le(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.res.set("Content-Type",n),e.res.set("Connection","close"),t.abrupt("return",o.pipe(e.res));case 3:case"end":return t.stop()}}),t)})))),o.on("end",le(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.res.end(),n.next=3,t.log("Stream request has been successfully served WITH END");case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))),o.on("error",function(){var t=le(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("THE ERROR READSTREAM"),console.log(n),e.res.set("Content-Type","application/json"),e.res.set("Connection","close"),t.abrupt("return",e.res.status(404).send({error:!0,message:"Not found"}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())};var Oe=n(13),ye=n(3),be=n(0),Te=n(1),Se=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.xpress=Oe,this.http=this.xpress(),this.router=this.xpress.Router(),this.path=be,this.html=[],this.request=null,this.componentCount=0,this.componentId=[],this.ssrComponentLen=0,this.componentRefLen=0,this.workers=[],this.fixedCompS={before:[],after:[]},this.compData=[],this.dependiks={jsonfile:ye,bodyParser:Te},this.mimeTypes={html:"text/html",txt:"text/plain",css:"text/css",gif:"image/gif",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",js:"application/javascript"},this.init=ue,this.handleConfigServer=he,this.handleWriteServerRequestResponse=Ee,this.startServer=fe,this.startPreRoutes=de,this.startRouting=pe,this.streamResponse=ve,this.runServer=ge,this.renderHtml=me,this.streamResponse=ve},Re=function(){this.log("Config has been initialised"),console.log(this.config),this.configure()},we=function(){var e=this.config;if(!this.config)return this.emit({type:"config-anziiloger",data:{level:"info"}}),void this.emit({type:"config-server",data:"server"});if(this.config)for(var t in this.config.hasOwnProperty("logger")&&(console.log("THE LOGGER IS THE FIRST MODULE TO GET CONFIG"),this.emit({type:"config-anziiloger",data:this.config.logger})),this.enviroment(),this.config.hasOwnProperty("cluster")&&this.emit({type:"config-system",data:this.config.cluster}),e)console.log("The module in Config"),console.log(t),"router"===t&&(e.views?(this.emit({type:"config-request",data:e[t]}),this.emit({type:"config-view",data:{routes:e[t],handlers:e.views}})):(this.emit({type:"config-request",data:e[t]}),this.emit({type:"config-view",data:e[t]}))),"logger"===t&&"views"===t||(this.emit({type:"config-".concat(t),data:e[t]}),"domain"===t&&this.emit({type:"config-domain-resources",data:""}))},Ne=function(){var e=this.envObserver,t=this.supportsColor;if(console.log("THE CURRENT ENVIROMENT"),t.stdout&&console.log("Terminal stdout supports color"),t.stdout.has256&&console.log("Terminal stdout supports 256 colors"),t.stderr.has16m&&console.log("Terminal stderr supports 16 million colors (truecolor)"),this.envObserver.has("enviroment"))if(this.aliases.hasOwnProperty(e.enviroment)){this.env=this.aliases[e.enviroment];var n=e.get(this.env);if(n.hasOwnProperty("database")){var o=[],r=n.database;for(var i in console.log("THE DB"),console.log(r),r)console.log("THE VALUE Of C"),console.log(i),console.log(r[i]),o.push({name:i,connect:r[i].connect});console.log("THE DATABASE CLIENTS"),console.log(o),this.emit({type:"config-dman",data:{clients:o}})}e.has("appOrphic")?(console.log("THE JWT appOrphic"),console.log(e),console.log(e.appOrphic),console.log(e.appOrphic.flaDev),this.emit({type:"save-jwt-key",data:{key:e.appOrphic.flaDev}})):this.emit({type:"save-jwt-key",data:{key:"f124sfet48tq3dfmlvoszx1"}})}else this.log("Enviroment config invalid, resorting to default","warn")};var Ie=n(0),ke=n(14),Ae=n(15),Ce=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.config=n(16)("".concat(this.pao.getWorkingFolder()).concat(Ie.sep,".config.js"))||null,this.envObserver=ke,this.supportsColor=Ae,this.env="development",this.aliases={development:"dev",production:"prod",staging:"stage"},this.init=Re,this.configure=we,this.enviroment=Ne};function De(e,t,n,o,r,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(o,r)}function xe(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function s(e){De(i,o,r,s,a,"next",e)}function a(e){De(i,o,r,s,a,"throw",e)}s(void 0)}))}}var _e=function(){this.setDebugger(this.constructor.name),console.log("Anziiloger has been initialised"),this.listens({"config-anziiloger":this.handleAnziilogerConfig.bind(this),"anziiloger-log":this.handleLogRequest.bind(this)})},He=function(e){if(this.logger)switch(e.type){case"info":this.info(e);break;case"warn":this.warn(e);break;case"error":this.error(e);default:this.debug(e)}else console.log(e.source,"logged message: ",e.message," of type ",e.type)},je=function(e){this.pao,new Date;this.logger=new this.winlo.createLogger({transports:[new this.winlo.transports.Console({level:"debug",label:"Anzilloger",timestamp:!0,colorize:!0})]})},Fe=function(){var e=xe(regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(n=this).pao,!(0,o.pa_contains)(t,"sync")){e.next=8;break}return e.next=6,n.logger.info("".concat(t.source,": ").concat(t.message));case 6:e.next=9;break;case 8:n.logger.info("".concat(t.source,": ").concat(t.message));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),Pe=function(){var e=xe(regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(n=this).pao,!(0,o.pa_contains)(t,"sync")){e.next=13;break}if(!n.debugas.hasOwnProperty(t.source.toLowerCase())){e.next=9;break}return e.next=7,n.debugas[t.source.toLowerCase()](t.message);case 7:e.next=11;break;case 9:return e.next=11,n.logger.debug("".concat(t.source,": ").concat(t.message));case 11:e.next=14;break;case 13:n.debugas.hasOwnProperty(t.source.toLowerCase())?n.debugas[t.source.toLowerCase()](t.message):n.logger.debug("".concat(t.source,": ").concat(t.message));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),Le=function(){var e=xe(regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(n=this).pao,!(0,o.pa_contains)(t,"sync")){e.next=8;break}return e.next=6,n.logger.warn("".concat(t.source,": ").concat(t.message));case 6:e.next=9;break;case 8:n.logger.warn("".concat(t.source,": ").concat(t.message));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),qe=function(){var e=xe(regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(n=this).pao,!(0,o.pa_contains)(t,"sync")){e.next=8;break}return e.next=6,n.logger.error("".concat(t.source,": ").concat(t.message));case 6:e.next=9;break;case 8:n.logger.error("".concat(t.source,": ").concat(t.message));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),Me=function(){var e=xe(regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this,o=t.toLowerCase(),n.debugas[o]=n.debugr("anzii:".concat(o));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();var Ue=n(17),Be=n(18),Je=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.winlo=Ue,this.debugr=Be,this.logger=null,this.debugas={},this.defaultTransports=[{trans:"File",level:"info",handleExceptions:!0,json:!0,label:"Anzilloger",maxsize:5242880,maxFiles:5,timestamp:!0,colorize:!1},{trans:"Console",level:"debug",handleExceptions:!0,json:!1,timestamp:!0,colorize:!0}],this.init=_e,this.handleLogRequest=He,this.handleAnziilogerConfig=je,this.info=Fe,this.warn=Le,this.error=qe,this.debug=Pe,this.setDebugger=Me};function Ge(e,t,n,o,r,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(o,r)}var We=function(){this.log("System has been initialised"),this.listens({"config-system":this.handleConfigureSystem.bind(this),"register-shutdown-candidate":this.handleRegisterShutDownCandidate.bind(this),"distribute-system-resources":this.handleDistributeSystemResources.bind(this),"attach-workers-to-server":this.handleServerAttachWorkers.bind(this)})},Ke=function(e){this.log("System ENVIROMENT IS: ".concat(this.env)),this.log(this.systemBase.DOCUMENT_ROOT),this.handleShutDowns(),this.clusterCustomConfig=e},Qe=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,o,r,i,s,a,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=(n=this).pao).pa_getFiles,o.pa_getDirectories,o.pa_getFile,r=o.pa_makeDirs,i=o.pa_getExtension,s=n.path,"".concat(n.systemBase.DOCUMENT_ROOT),"".concat(n.systemBase.DOCUMENT_ROOT).concat(s.sep,"sev.js"),a="".concat(n.systemBase.DOCUMENT_ROOT).concat(s.sep),n.log("HandleDistributeSystemResources "),e.next=14,r(a);case 14:c=e.sent,l=i("sev.js"),console.log("GET FILES CALLBACK GETS A CALL"),console.log(l),console.log(c),n.emit({type:"take-system-base",data:{systemBase:n.systemBase}});case 20:case"end":return e.stop()}}),e,this)})),function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function s(e){Ge(i,o,r,s,a,"next",e)}function a(e){Ge(i,o,r,s,a,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}(),Ve=function(e,t){var n=this;n.log("SHUTDOWN TYPE: ".concat(e,",code: ").concat(t)),n.systemIsShuttingDown=!0,n.shutDownServices.length>0&&n.shutDownServices.forEach((function(e,t){"function"!=typeof e?n.log("Service: ".concat(n.shutDownOrder[t]," must be a function,shutdown attempt failed"),"warn"):n.log("Service: ".concat(n.shutDownOrder[t]," is shutting down"),"info")})),n.log("System is shutting down through: ".concat(e,",with code: ").concat(t.stack)),"uncaughtException"===e?n.context.kill(1):n.context[e]()},ze=function(e){var t=this;if(t.log("THE STATUS OF isMaster: ".concat(t.cluster.isMaster)),t.cluster.isMaster)if(t.log("Master ".concat(t.context.pid," is running")),t.clusterCustomConfig.spawn){var n=t.clusterCustomConfig.workers?t.clusterCustomConfig.workers:"auto";if("auto"===n){n=t.os.cpus().length;for(var o=0;n<n;o++)t.cluster.fork()}else if("number"==typeof n)for(var r=0;r<n;r++)t.log("Forking slave number: ".concat(r)),t.cluster.fork();t.cluster.on("fork",(function(e){t.log("cluster forking new worker",e.id)}));var i=null;t.cluster.on("listening",(function(e,n){t.log("cluster listening new worker",e.id),null===i&&(t.log("Making worker "+e.id+" to main worker"),i=e.id,e.send({singleProcessTasks:"startSingleProcessTasks"}))})),t.cluster.on("exit",(function(e,n,o){t.log("worker ".concat(e.process.pid," died")),console.log("FORKING ANOTHER WORK"),console.log("Worker %d died :(",e.id),e.id===i&&(console.log("Main Worker is dead..."),i=null),console.trace("I am here"),t.log(e),t.log(n),t.log(o),t.cluster.fork()}))}else t.log("System is running on a single thread/core");else console.log("Worker ".concat(process.pid," started")),e.listen(t.context.env.PORT||3e3,(function(){t.log("The Server is listening via workers","info"),t.log("THIS WORKER RUNNING IP:")})),process.on("message",(function(e){t.log("Worker "+process.pid+" received message from master.",e),"startSingleProcessTasks"==e.singleProcessTasks&&t.emit({type:"start-single-process-tasks",data:""})}))},Ye=function(e){},Xe=function(){console.log("Shutdowns are being handled");var e=this;e.context.on("INT",(function(t){e.systemIsShuttingDown?e.log("System is already ShuttingDown"):e.shutDown("kill",t)})),e.context.on("SIGTEM",(function(t){e.systemIsShuttingDown?e.log("System is already ShuttingDown"):e.shutDown("exit",t)})),e.context.on("uncaughtException",(function(t){e.systemIsShuttingDown?e.log("System is already ShuttingDown"):e.shutDown("uncaughtException",t)})),e.context.on("unhandledRejection",(function(t){console.log("uncaughtException occured from unhandleredjected",t.stack),e.systemIsShuttingDown?e.log("System is already ShuttingDown"):e.shutDown("uncaughtException",t)}))},Ze=function(e){this.masterWorker(e.app)},$e=function(e){e.hasOwnProperty("candidate")&&pao.pa_isFunction(e.candidate)&&e.hasOwnProperty("name")&&pao.pa_isString(name)?this.shutDownServices.indexOf(e.name)>-1||(this.shutDownServices.push(e.candidate),this.shutDownOrder.push(e.name)):this.log("Candidate could not be registered for shutdown","warn")};var et=n(19),tt=(n(20),n(2)),nt=n(0),ot=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.context=process,this.env=this.context.env,this.cluster=et,this.os=tt,this.path=nt,this.shutDownServices=[],this.numOfDBSD=3,this.allowedDBSTR=1e4,this.systemIsShuttingDown=!1,this.shutDownOrder=[],this.systemBase={DOCUMENT_ROOT:process.cwd()},this.init=We,this.handleConfigureSystem=Ke,this.handleRegisterShutDownCandidate=$e,this.handleServerAttachWorkers=Ze,this.handleDistributeSystemResources=Qe,this.masterWorker=ze,this.folkSlaveWorkers=Ye,this.handleShutDowns=Xe,this.shutDown=Ve};function rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rt(Object(n),!0).forEach((function(t){st(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e,t,n,o,r,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(o,r)}function lt(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function s(e){ct(i,o,r,s,a,"next",e)}function a(e){ct(i,o,r,s,a,"throw",e)}s(void 0)}))}}function ut(e){return function(e){if(Array.isArray(e))return ht(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ht(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ht(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var ft=function(){console.log("Mysql has been initialised"),this.listens({"mysql-data-request":this.handleMysqlDataRequest.bind(this)})},dt=function(e){var t=this.pao;t.pa_contains(e,["conn","table","opi","query","outComehandler"])?t.pa_isObject(e.conn)?t.pa_isString(e.table)?"deletemultiple"===e.opi.trim()||this[e.opi]?(console.log("THE CODE GOES THIS FAR"),"insert"===e.opi?(e.opi="insertOne",this[e.opi](e),console.log("this runs after opi finishes")):"find"===e.opi?this[e.opi](e):"updateOne"===e.opi?(e.opi="updateOne",this[e.opi](e)):"transaction"===e.opi?(e.opi="transaction",this[e.opi](e)):"procedure"===e.opi?(e.opi="procedure",this[e.opi](e)):"join"===e.opi?(e.opi="join",this[e.opi](e)):"search"===e.opi?(e.opi="search",this[e.opi](e)):"remove"===e.opi?(e.opi="remove",this[e.opi](e)):"updateandtake"===e.opi||"insertandtake"===e.opi||"deleteandtake"===e.opi?this[e.opi](e):"deletemultiple"===e.opi?this.deleteandtake(e):this[e.opi](e)):(this.log("DATA.OPI IS NOT CONTAINED AS FUNCTION"),this.log("deletemultiple"!==e.opi.trim()),this.log(e.opi),e.outComehandler({message:"The specified operation is not supported"})):this.log("THE TABLE NAME IS NOT A STRING"):this.log("THE connection is not object"):(this.log("Data request operations failed"),e.outComehandler({message:"Database operation failed"}))},pt=function(e){if(this.pao.pa_isObject(e))try{var t=e.outComehandler,n=e.conn,o=e.query;this.log("THE INSERT OBJECT"),this.log(e);var r="INSERT INTO ?? (??) VALUES(?)",i=[e.table,["id"].concat(ut(o.fields)),[null].concat(ut(o.values))];r=n.format(r,i),console.log("THE SQL STATEMENT"),console.log(r),n.query(r,(function(n,o,r){if(console.log("INSERT RESULT"),console.log(o),console.log(n),n)return t(n,null);o.user=e.values,console.log(o.user),t(null,o)}))}catch(e){console.log("CAUTH ERROR"),console.log(e),handler(e,null)}else;},gt=function(e){if(pao.pa_isObject(data))try{var t="INSERT INTO ?? (?) VALUES(?)",n=[];e.bulk.forEach((function(e,o){var r=[e.table,ut(e.fields),ut(e.values)];t=conn.format(t,r),conn.query(t,e,(function(e,t,o){e?!1:n.push(t)}))})),console.log("bulk insert completed"),handler(null,n)}catch(e){handler(e,null)}else;},mt=function(){var e=lt(regeneratorRuntime.mark((function e(t){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=(n=this).pao).pa_isObject(t)){e.next=6;break}return e.abrupt("return");case 6:return e.delegateYield(regeneratorRuntime.mark((function e(){var r,i,s,a,c,l,u,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.conn,i=t.outComehandler,s=[],a=[],c=!1,"MULTIPLE"===t.table.toUpperCase().trim()?(c=!0,s=t.query):s.push(t.query),l=regeneratorRuntime.mark((function e(l){var u,h,f,d,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=null,u=it(c?{table:s[l].table}:{table:t.table},s[l]),e.prev=2,h="",null,d=n.queryTemplate(n.queryOptions(u),"select"),console.log("THE SQLKIKS OBJECT FIND"),console.log(d),f=[d.attribs.from.table],h=d.statement,p=f,console.log("THE SQL BEFORE FORMAT"),console.log(h),h=r.format(h,p),console.log(h),e.next=17,r.query(h,(function(e,t,n){console.log("THE QUERY IS COMPLETED WITH RESULTS"),console.log(e),console.log(t),e&&a.push(e),o.pa_isArray(t)&&t.length>0&&1!==s.length?(t=t[0],a.push(t)):a=t,l===s.length-1&&(console.log("THE LOOP IS COMPLETE WITH DATA:"),console.log(a),i(null,a))}));case 17:e.next=22;break;case 19:return e.prev=19,e.t0=e.catch(2),e.abrupt("return",{v:{v:i(e.t0,null)}});case 22:case"end":return e.stop()}}),e,null,[[2,19]])})),u=0;case 8:if(!(u<s.length)){e.next=16;break}return e.delegateYield(l(u),"t0",10);case 10:if("object"!==at(h=e.t0)){e.next=13;break}return e.abrupt("return",h.v);case 13:u++,e.next=8;break;case 16:case"end":return e.stop()}}),e)}))(),"t0",7);case 7:if("object"!==at(r=e.t0)){e.next=10;break}return e.abrupt("return",r.v);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),Et=function(e){console.log("THE UPDATIKS"),console.log(e);var t=this.pao,n=e.conn,o=e.outComehandler,r=it({table:e.table},e.query);if(t.pa_isObject(e))try{var i,s="",a=this.queryTemplate(this.queryOptions(r),"update");console.log("THE SQLKIKS OBJECT UPDATE"),console.log(a),i=[a.attribs.from.table],s=a.statement;var c=i;console.log("THE SQL BEFORE FORMAT"),console.log(s),s=n.format(s,c),console.log(s),n.query(s,(function(e,t,n){e&&o(e,null),o(null,t)}))}catch(e){o(e,null)}else;},vt=function(){var e=lt(regeneratorRuntime.mark((function e(t){var n,o,r,i,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("THE UPDATIKANDTAKE"),console.log(t),o=(n=this).pao,r=t.conn,i=t.outComehandler,s=t.query,o.pa_isObject(t)){e.next=10;break}e.next=20;break;case 10:return e.prev=10,e.next=13,n.searchOptions(s,!0);case 13:a=e.sent,n.multiTableUpdate(a,r).then((function(e){e.changedRows>0?n.take(a,r,s.conditions).then((function(e){i(null,{updated:!0,taken:e})})).catch((function(e){i(e,null)})):(console.log("NO CHANGED ROWS IN A MULTIPLE UPDATE"),console.log(a),n.take(a,r,s.conditions).then((function(e){i(null,{updated:!1,taken:e})})).catch((function(e){i(e,null)})))})).catch((function(e){i(e,null)})),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(10),i(e.t0,null);case 20:case"end":return e.stop()}}),e,this,[[10,17]])})));return function(t){return e.apply(this,arguments)}}(),Ot=function(){var e=lt(regeneratorRuntime.mark((function e(t){var n,o,r,i,s,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("THE INSERTANDTAKE"),console.log(t),o=(n=this).pao,r=t.conn,i=t.outComehandler,s=t.query.insert,a=t.query.take,o.pa_isObject(t))try{c=function(){var e=lt(regeneratorRuntime.mark((function e(){var t,o,s,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:null,o=c.length>1&&void 0!==c[1]?c[1]:null,e.next=4,n.log("THE INSERTED RECORD UPDATE");case 4:return e.next=6,n.log(t);case 6:return e.next=8,n.log(o);case 8:return e.next=10,n.log(n.SEARCH);case 10:return!a.conditions&&(a.conditions=["id ISEQUAL ".concat(o.insertId)]),e.next=13,n.log(a);case 13:(s={}).conn=r,s.query=a,s.outComehandler=function(){var e=arguments.length>1?arguments[1]:void 0;i(null,{inserted:o,taken:e})},n.search(s);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s.outComehandler=c.bind(n),s.conn=r,n.insertOne(s)}catch(e){i(e,null)}else;case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),yt=function(){var e=lt(regeneratorRuntime.mark((function e(t){var n,o,r,i,s,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("THE DELETEANDTAKE"),console.log(t),o=(n=this).pao,r=t.conn,i=t.outComehandler,s=null,a=null,t.query.remove&&(s=t.query.remove,a=t.query.take),o.pa_isObject(t))try{c=function(){var e=lt(regeneratorRuntime.mark((function e(){var t,o,c,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:null,o=l.length>1&&void 0!==l[1]?l[1]:null,e.next=4,n.log("THE deleted RECORD UPDATE");case 4:return e.next=6,n.log(t);case 6:return e.next=8,n.log(o);case 8:if(a){e.next=12;break}i(null,{deleted:o}),e.next=20;break;case 12:return!a.conditions&&(a.conditions=s.conditions),e.next=15,n.log(a);case 15:(c={}).conn=r,c.query=a,c.outComehandler=function(){var e=arguments.length>1?arguments[1]:void 0;console.log("DELETED AND TAKEN OPERATION"),console.log(o),console.log(e),i(null,{deleted:o,taken:e})},n.search(c);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s||(s=t.query),s.outComehandler=c.bind(n),s.conn=r,n.removeJoin(s)}catch(e){i(e,null)}else;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),bt=function(e){this.log("UPDATE OPTIONS"),this.log(e);var t={};switch(t.attribs={from:e.from,tables:e.tables},e.length){case 2:t.statement="UPDATE ??\n                            JOIN ".concat(e.tables[0],"\n                              ON ").concat(e.joinPoints[0],"\n                            SET ").concat(e.set,"\n                            WHERE ").concat(e.from.condition,"\n                            ");break;case 3:t.statement="UPDATE ??,??,??\n                              JOIN ".concat(e.tables[0],"\n                                ON ").concat(e.conditions[0],"\n                              JOIN ").concat(e.tables[1],"\n                                ON ").concat(e.conditions[1],"\n                              SET ").concat(e.set,"\n                              WHERE ").concat(e.from.condition,"\n                              \n                              ");break;case 4:t.statement="UPDATE ??,??,??,??\n                            JOIN ".concat(e.tables[0],"\n                              ON ").concat(e.conditions[0],"\n                            JOIN ").concat(e.tables[1],"\n                              ON ").concat(e.conditions[1],"\n                            JOIN ").concat(e.tables[2],"\n                            ON ").concat(e.conditions[2],"\n                            SET ").concat(e.set,"\n                            WHERE ").concat(e.from.condition,"\n                            \n                            ");break;default:t.statement="UPDATE ??\n                            SET ".concat(e.set,"\n                            WHERE ").concat(e.from.condition,"\n                            \n                            ")}return t},Tt=function(){var e=lt(regeneratorRuntime.mark((function e(t,n){var o,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(o=this).pao,i=r.pa_contains,e.abrupt("return",new Promise((function(e,r){try{var s="",a=null,c=o.updateJoinTemplate(t);console.log("THE SQLKIKS OBJECT"),console.log(c),a=i(c.attribs,"tables")&&c.attribs.tables?[c.attribs.from.table].concat(ut(c.attribs.tables)):[c.attribs.from.table],s=c.statement;var l=a;console.log("THE SQL BEFORE FORMAT::MULTIUPDATE"),console.log(s),s=n.format(s,l),console.log(s),n.query(s,(function(t,n,o){if(t)return r(t);e(n)}))}catch(e){r(e)}})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),St=function(){var e=lt(regeneratorRuntime.mark((function e(t,n,o){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=this).pao,console.log("TAKE:::"),console.log(t),e.abrupt("return",new Promise((function(e,i){if(t.takeFrom){var s=t.takeFrom;console.log("THE TAKEFROM BY TAKEFROM"),console.log(s),s.condition?(r.log("THE TAKEFROM CONDITIION IS SET"),t.from.condition=s.condition,s.tables.length>1&&(t.length=s.tables.length),t.length&&(s.joinPoints&&(t.joinPoints=s.joinPoints)),r.takeSql(t,n).then((function(t){e(t)})).catch((function(e){i(e)}))):(r.log("THE TAKEFROM HAS NO SET CONDITIONS"),r.log(t),delete t.length,t.from.condition=r.searchConditionsFormat([o[0]]),r.takeSql(t,n).then((function(t){e(t)})).catch((function(e){i(e)})))}else r.log("THE TAKEFROM IS NOT DEFINED"),r.takeSql(t,n).then((function(t){e(t)})).catch((function(e){i(e)}))})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,o){return e.apply(this,arguments)}}(),Rt=function(e,t){var n=this,o=n.pao.pa_contains;return console.log("THE SEARCH"),console.log(xt),new Promise((function(r,i){console.log("Executing the search promise");var s="",a=null,c=n.searchStatement(e);console.log("THE SQLKIKS OBJECT"),console.log(c),a=o(c.attribs,"tables")?[c.attribs.from.table].concat(ut(c.attribs.tables)):[c.attribs.from.table],s=c.statement;var l=a;console.log("THE SQL BEFORE FORMAT::"),console.log(s),s=t.format(s,l),console.log(s),t.query(s,(function(e,t,n){e?(console.log("Promise is rejecting search"),console.log(e),i(e)):(console.log("Promise is Resolving search"),console.log(t),console.log(t[0]),r(t))}))}))},wt=function(e){var t=this.pao,n=t.pa_contains,o=e.conn,r=e.outComehandler;if(t.pa_isObject(e))try{var i="",s=null,a=this.queryTemplate(this.searchOptions(e),"delete");console.log("THE SQLKIKS OBJECT DELETEDANDTAKE[REMOVE]"),console.log(a),s=n(a.attribs,"tables")?[].concat(ut(a.attribs.tables),[a.attribs.from.table]):[a.attribs.from.table],i=a.statement;var c=s;console.log("THE SQL BEFORE FORMAT"),console.log(i),i=o.format(i,c),console.log(i),o.query(i,(function(e,t,n){if(e)return r(e,null);r(null,t)}))}catch(e){r(e,null)}else;},Nt=function(e){var t=this.pao,n=e.conn,o=e.outComehandler,r=it({table:e.table},e.query);if(t.pa_isObject(e))try{var i,s="",a=this.queryTemplate(this.queryOptions(r),"delete");console.log("THE SQLKIKS OBJECT DELETED[REMOVE]"),console.log(a),i=[a.attribs.from.table],s=a.statement;var c=i;console.log("THE SQL BEFORE FORMAT"),console.log(s),s=n.format(s,c),console.log(s),n.query(s,(function(e,t,n){e&&o(e,null),o(null,t)}))}catch(e){o(e,null)}else;},It=function(e){console.log("THE search BATCH ITEM"),console.log(e);var t=this.pao.pa_contains,n={};return e.conditions?n.from={table:e.table,condition:this.searchConditionsFormat(e.conditions)}:n.from={table:e.table},console.log("THE CODE GETS HERE"),console.log(n),t(e,["returnFields","opiks"])?n.fields=this.searchFieldsFormat(e.opiks,e.returnFields):t(e,"opiks")?n.fields=this.searchFieldsFormat(e.opiks):t(e,"returnFields")?1===e.returnFields.length&&"all"===e.returnFields[0].trim()?n.fields="*":n.fields=e.returnFields:n.fields="*",t(e,"take")&&(n.take=e.take),t(e,"range")&&(n.range=e.range),t(e,"sort")&&(n.sort=e.sort),t(e,"set")&&(n.set=this.set(e.set)),t(e,"takeFrom")&&(e.takeFrom.conditions?(n.takeFrom=e.takeFrom,n.takeFrom.condition=this.searchConditionsFormat(e.takeFrom.conditions)):n.takeFrom=e.takeFrom),console.log("THE OPTIONS"),console.log(n),n},kt=function(e,t){var n=this.pao.pa_contains;if(console.log("THE QUERY TEMPLATE"),console.log(e),"select"===t){var o={};o.attribs={from:e.from};var r=" ",i=e.sort?this.sort(e.sort):" ";return e.take?r=this.limit(e.take,"take"):!e.range||(r=this.limit(e.range,"range")),n(e.from,"condition")?o.statement="SELECT ".concat(e.fields,"\n                              FROM  ??\n                              WHERE ").concat(e.from.condition,"\n                              ").concat(i,"\n                              ").concat(r,"\n\n                              "):o.statement="SELECT ".concat(e.fields,"\n                              FROM  ??\n                              ").concat(i,"\n                              ").concat(r,"\n                              "),o}if("update"===t){var s={};return s.attribs={from:e.from},s.statement="UPDATE ??\n                            SET ".concat(e.set,"\n                            WHERE ").concat(e.from.condition,"\n                            "),s}if("delete"===t){if(e.length){var a={};switch(a.attribs={from:e.from,tables:e.tables},e.tables.unshift(e.from.table),console.log("DELETE OPTIONS OBJECT"),console.log(e),console.log(e.tables),console.log(e.length),e.length){case 3:a.statement="DELETE ??,??,??\n                                  FROM ??\n                                  JOIN ".concat(e.tables[1],"\n                                    ON ").concat(e.joinPoints[0],"\n                                  JOIN ").concat(e.tables[2],"\n                                    ON ").concat(e.joinPoints[1],"\n                                  WHERE ").concat(e.from.condition,"\n                                  \n                                  ");break;case 4:a.statement="DELETE ??,??,??,??\n                                FROM ??\n                                JOIN ".concat(e.tables[1],"\n                                  ON ").concat(e.joinPoints[0],"\n                                JOIN ").concat(e.tables[2],"\n                                  ON ").concat(e.joinPoints[1],"\n                                JOIN ").concat(e.tables[3],"\n                                ON ").concat(e.joinPoints[3],"\n                                WHERE ").concat(e.from.condition,"\n                                \n                                ");break;default:a.statement="DELETE ??,??\n                                  FROM ??\n                                  JOIN ".concat(e.tables[1],"\n                                    ON ").concat(e.joinPoints[0],"\n                                  WHERE ").concat(e.from.condition,"\n                                  \n                                  ")}return console.log("SQL ATTRRIBS"),console.log(a),a}var c={};return c.attribs={from:e.from},c.statement="DELETE\n                                FROM ??\n                                ",e.from.condition&&(c.statement+=" WHERE ".concat(e.from.condition)),c}},At=function(e){"function"==typeof e.query?e.query():this.TRANSACTION(e.query,e.conn,e.outComehandler)},Ct=function(e){console.log("THE procedure got a call");"function"==typeof e.query?e.query():(console.log("INSIDE PROCEDURE"),this.PROCEDURE(e.query,e.conn,e.outComehandler))},Dt=function(e){console.log("THE procedure got a call");"function"==typeof e.query?e.query():(console.log("INSIDE JOIN"),this.JOIN(e.query,e.conn,e.outComehandler))},xt=function(e){console.log("THE search got a call");"function"==typeof e.query?e.query():(console.log("INSIDE SEARCH"),this.SEARCH(e.query,e.conn,e.outComehandler))},_t=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this,r=o.pao,i=[],s=!1,a=0;a<e.length;a++){var c=e[a],l=null,u=null,h=null;if(!r.pa_contains(c,"fields")){n("Required collection/table field missing");break}if(r.pa_contains(c.fields,"tables")&&(u=c.fields.tables,h=c.fields.own),u&&(l=o.combineFields(u,h,i)),l&&(c.fields=l),o.insert(c,t).then((function(e){i.push(e)})).catch((function(e){o.rollback(i),n(e,null),s=!0})),s)break;a===e.length-1&&(console.log("Operation completed successfully"),n("Transaction Operation sucessful"))}},Ht=function(){var e=lt(regeneratorRuntime.mark((function e(t,n){var o,r,i,s,a,c,l,u,h,f,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=d.length>2&&void 0!==d[2]?d[2]:null,i=(r=this).pao,r.log("THE PROCEDURE METHOD"),r.log(t),r.log(o),r.log(n),s=[],a=!1,c=0;case 10:if(!(c<t.length)){e.next=31;break}if(l=t[c],u=null,h=null,f=null,i.pa_contains(l,"fields")){e.next=20;break}return o("Required collection/table field missing"),e.abrupt("break",31);case 20:i.pa_contains(l.fields,"tables")&&(console.log("sources will be assigned A VALUE"),h=l.fields.tables,f=l.fields.own);case 21:return h&&(u=r.combineFields(h,f,s)),u&&(l.fields=u),e.next=25,r.insert(l,n).then((function(e){s.push(e)})).catch((function(e){o(e,null),a=!0}));case 25:if(!a){e.next=27;break}return e.abrupt("break",31);case 27:c===t.length-1&&(console.log("Operation completed successfully"),console.log(s),s.length>0?(console.log("PROCEDURE IS COMPLETED"),console.log(s),o(null,{user:{username:s[0].fields.email}})):o("An insert has went wrong"));case 28:c++,e.next=10;break;case 31:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),jt=function(e,t){var n=this;return new Promise((function(o,r){console.log("Executing the insert promise");var i="INSERT INTO ?? SET ?",s=[e.name,e.fields];i=t.format(i,s),t.query(i,(function(i,s,a){i?(console.log("Promise is rejecting"),r(i)):n.findOne({conn:t,table:e.name,query:{user:{id:s.insertId}},outComehandler:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={};e?(console.log("the errorINSERT"),console.log(e),console.log(n),r.error=e,r.lastInsert=n.query.user.id,r.fields=null,r.collection=n.table,console.log("Promise is Resolving with findOne error"),console.log(r),o(r)):(r.lastInsert=n.query.user.id,r.fields=t,r.collection=n.table,console.log("Promise is Resolving with FindOne SUCCESS"),console.log(r),o(r))}})}))}))},Ft=function(){var e=lt(regeneratorRuntime.mark((function e(t,n){var o,r,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=i.length>2&&void 0!==i[2]?i[2]:null,(r=this).pao,r.joinExek(t,n).then((function(e){console.log("jOIN is successful, sending results to the requester"),console.log(e),o(null,e)})).catch((function(e){console.log("JOIN FAILED"),console.log(e),o(e,null)}));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),Pt=function(){var e=lt(regeneratorRuntime.mark((function e(t,n){var o,r,i,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=s.length>2&&void 0!==s[2]?s[2]:null,i=(r=this).pao,console.log("THE SEARCH search object contents"),console.log(t),i.pa_contains(t,"batch")){e.next=9;break}r.searchExek(t,n).then((function(e){console.log("search is successful, sending results to the requester"),o(null,e)})).catch((function(e){console.log("search FAILED"),console.log(e),o(e,null)})),e.next=10;break;case 9:return e.delegateYield(regeneratorRuntime.mark((function e(){var i,s,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],s=t.search,a=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.searchExek(s[t],n).then((function(e){console.log("search is successful, pushing results to the resultSet"),i.push(e),t===s.length-1&&(console.log("Operation completed successfully"),o(null,i))})).catch((function(e){console.log("search FAILED"),console.log(e),i.push({item:t,errorMessage:"Item of ".concat(t," position has failed"),error:e})}));case 2:case"end":return e.stop()}}),e)})),c=0;case 4:if(!(c<s.length)){e.next=9;break}return e.delegateYield(a(c),"t0",6);case 6:c++,e.next=4;break;case 9:case"end":return e.stop()}}),e)}))(),"t0",10);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),Lt=function(e,t,n){var o={};console.log("COMBINE FIELDS GETS A CALL"),e.forEach((function(e,t){for(var r=function(t){if(n[t].collection===e.name)return e.values.forEach((function(e,r){console.log("THE VV"),console.log(e);var i=e.split(".");console.log("FIELD VALUE PAIR"),console.log(i),o[i[1]]=n[t].fields[i[0]]})),"break"},i=0;i<n.length;i++){if("break"===r(i))break}}));var r=Object.keys(t);return console.log("THE KEYS OF OWN"),console.log(r),r.forEach((function(e,n){o[e]=t[e]})),console.log("THE FIELDS"),console.log(o),o},qt=function(e){var t=this;e.forEach((function(e,n){t.deleteOne({id:e.lastInsert},conn)}))},Mt=function(e,t){var n=this;return new Promise((function(o,r){console.log("Executing the JOIN promise");var i={fields:e.returnFields,from:{table:e.tables[0],condition:n.joinConditionsFormat(e.conditions)},joinPoints:n.joinConditionsFormat(e.joinPoints,"ON"),tables:e.tables.splice(1,e.tables.length),type:e.type.toUpperCase(),length:e.joins},s=n.joinStatement(i),a=[i.from.table,i.tables[0]];console.log("THE SQL BEFORE FORMAT"),console.log(s),s=t.format(s,a),console.log(s),t.query(s,(function(e,t,n){e?(console.log("Promise is rejecting JOIN"),console.log(e),r(e)):(console.log("Promise is Resolving JOIN"),console.log(t),console.log(t[0]),o(t[0]))}))}))},Ut=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(console.log("CONDITIONS"),console.log(e),t){var n=e,o=[];return n.forEach((function(e,t){var n=e.trim().split(" ");o.push("".concat(n[0]," ").concat("="," ").concat(n[2]))})),console.log("THE JOIN ON CONDITION"),console.log(o),o}var r=e,i="";return r.forEach((function(e,t){console.log("THE con ITEM"),console.log(e);var n=e.trim().split(" ");console.log("THE CONLIST"),console.log(n);var o="";switch(n[1]){case"EQUALS":o="=";break;case"ISGREATEROREQUALS":o=">=";break;case"ISLESSOREQUALS":o="<=";break;default:o="="}i+="".concat(n[0]," ").concat(o," '").concat(n[2],"'")})),console.log("THE JOIN FROM CONDITION"),console.log(i),i.trim()},Bt=function(e){switch(console.log("THE JOIN OPTIONS"),console.log(e),e.length){case 3:return"SELECT ".concat(e.fields,"\n               FROM ").concat(e.from.table,"\n               JOIN ").concat(e.tables[0],"\n                  ON ").concat(e.conditions[0],"\n               JOIN options.tables[1]\n                  ON ").concat(e.conditions[1],"\n               WHERE ").concat(e.from.condition,"\n               \n               ");case 4:return"SELECT ".concat(e.fields,"\n               FROM ").concat(e.from.table,"\n               JOIN ").concat(e.tables[0],"\n                  ON ").concat(e.conditions[0],"\n               JOIN options.tables[1]\n                  ON ").concat(e.conditions[1],"\n               JOIN options.tables[2]\n                  ON ").concat(e.conditions[2],"\n               WHERE ").concat(e.from.condition,"\n               \n               ");case 5:return"SELECT ".concat(e.fields,"\n               FROM ").concat(e.from.table,"\n               JOIN ").concat(e.tables[0],"\n                  ON ").concat(e.conditions[0],"\n               JOIN options.tables[1]\n                  ON ").concat(e.conditions[1],"\n               JOIN options.tables[2]\n                  ON ").concat(e.conditions[2]," \n               JOIN options.tables[3]\n                  ON ").concat(e.conditions[3],"\n               WHERE ").concat(e.from.condition,"\n               \n               ");default:return"SELECT ".concat(e.fields,"\n               FROM  ??\n               JOIN  ").concat(e.tables[0],"\n                  ON ").concat(e.joinPoints[0],"\n               WHERE ").concat(e.from.condition,"\n               ")}},Jt=function(e,t){var n=this,o=n.pao.pa_contains;return console.log("THE SEARCH"),console.log(e),new Promise((function(r,i){console.log("Executing the search promise");var s="",a=null,c=n.searchStatement(n.searchOptions(e));console.log("THE SQLKIKS OBJECT"),console.log(c),a=o(c.attribs,"tables")?[c.attribs.from.table].concat(ut(c.attribs.tables)):[c.attribs.from.table],s=c.statement;var l=a;console.log("THE SQL BEFORE FORMAT"),console.log(s),s=t.format(s,l),console.log(s),t.query(s,(function(e,t,n){e?(console.log("Promise is rejecting search"),console.log(e),i(e)):(console.log("Promise is Resolving search"),r(t))}))}))},Gt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("CONDITIONS"),console.log(e);var n=this;n.pao;if(t){var o=n.parseFormatCondition(e,t);return console.log("THE search ON CONDITION"),console.log(o),o}var r=e,i="";return r.forEach((function(e,t){e.indexOf("GROUP::")>=0?(console.log("CONDITION FROM SEARCHCONDITIONFORMAT"),console.log(e),i+=n.parseGroup(e)):i+=n.parseFormatCondition(e)})),console.log("THE search FROM CONDITION"),console.log(i),i.trim()},Wt=function(e){console.log("THE search OPTIONSSTATEMENT"),console.log(e);var t=this.pao.pa_contains;if(!e)return null;if(t(e,"length")){var n={};n.attribs={from:e.from,tables:e.tables},console.log("THE OPTIONS LENGTH"),console.log(e.length);var o=" ",r=e.sort?this.sort(e.sort):" ";switch(e.take?o=this.limit(e.take,"take"):!e.range||(o=this.limit(e.range,"range")),e.length){case 3:n.statement="SELECT ".concat(e.fields,"\n                FROM ??\n                JOIN ??\n                  ON ").concat(e.joinPoints[0],"\n                JOIN ??\n                  ON ").concat(e.joinPoints[1],"\n                WHERE ").concat(e.from.condition,"\n                ").concat(r,"\n                ").concat(o,"\n                \n                ");break;case 4:n.statement="SELECT ".concat(e.fields,"\n                FROM ").concat(e.from.table,"\n                JOIN ").concat(e.tables[0],"\n                  ON ").concat(e.joinPoints[0],"\n                JOIN ").concat(e.tables[1],"\n                  ON ").concat(e.joinPoints[1],"\n                JOIN ").concat(e.tables[2],"\n                  ON ").concat(e.joinPoints[2],"\n                WHERE ").concat(e.from.condition,"\n                ").concat(r,"\n                ").concat(o,"\n                ");break;case 5:n.statement="SELECT ".concat(e.fields,"\n                FROM ").concat(e.from.table,"\n                JOIN ").concat(e.tables[0],"\n                  ON ").concat(e.joinPoints[0],"\n                JOIN ").concat(e.tables[1],"\n                  ON ").concat(e.joinPoints[1],"\n                JOIN ").concat(e.tables[2],"\n                  ON ").concat(e.joinPoints[2]," \n                JOIN ").concat(e.tables[3],"\n                  ON ").concat(e.joinPoints[3],"\n                WHERE ").concat(e.from.condition,"\n                ").concat(r,"\n                ").concat(o,"\n                ");break;default:n.statement="SELECT ".concat(e.fields,"\n                FROM  ??\n                JOIN  ").concat(e.tables[0],"\n                  ON ").concat(e.joinPoints[0],"\n                WHERE ").concat(e.from.condition,"\n                ").concat(r,"\n                ").concat(o,"\n              ")}return n}var i={};i.attribs={from:e.from};var s=" ",a=e.sort?this.sort(e.sort):" ";return e.take?s=this.limit(e.take,"take"):!e.range||(s=this.limit(e.range,"range")),t(e.from,"condition")?i.statement="SELECT ".concat(e.fields,"\n              FROM  ??\n              WHERE ").concat(e.from.condition,"\n              ").concat(a,"\n              ").concat(s,"\n              "):i.statement="SELECT ".concat(e.fields,"\n                              FROM  ??\n                              ").concat(a,"\n                              ").concat(s,"\n                              "),i},Kt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,o=n.pao,r=o.pa_contains,i="";if(i=t?ut(e.tables):"",n.log("THE search BATCH ITEM"),n.log(e),console.log(e),r(e,["joins","conditions","joinPoints"])){console.log("THE SEARCH ITEM CONTAINS BOTH JOINS,CONDITIONS, AND JOINPOINTS");var s={};return s.from={table:e.tables[0],condition:n.searchConditionsFormat(e.conditions)},s.joinPoints=e.joinPoints?n.searchConditionsFormat(e.joinPoints,"ON"):null,s.length=e.tables.length,s.tables=e.tables.splice(1,e.tables.length),r(e,["returnFields","opiks"])?s.fields=n.searchFieldsFormat(e.opiks,e.returnFields):r(e,"opiks")?s.fields=n.searchFieldsFormat(e.opiks):r(e,"returnFields")&&(1===e.returnFields.length&&"all"===e.returnFields[0].trim()?s.fields="*":s.fields=e.returnFields),r(e,"type")&&(s.type=e.type),r(e,"take")&&(s.take=e.take),r(e,"range")&&(s.range=e.range),r(e,"soundex")&&(s.soundex=e.soundex),r(e,"sort")&&(s.sort=e.sort),r(e,"set")&&(s.set=t?n.set(e.set,i):n.set(e.set)),r(e,"takeFrom")&&(e.takeFrom.conditions?(s.takeFrom=e.takeFrom,s.takeFrom.condition=n.searchConditionsFormat(e.takeFrom.conditions)):s.takeFrom=e.takeFrom),s}if(r(e,["conditions"])){var a={};return a.from={table:e.tables[0],condition:n.searchConditionsFormat(e.conditions)},r(e,["returnFields","opiks"])?a.fields=n.searchFieldsFormat(e.opiks,e.returnFields):r(e,"opiks")?a.fields=n.searchFieldsFormat(e.opiks):r(e,"returnFields")&&(1===e.returnFields.length&&"all"===e.returnFields[0].trim()?a.fields="*":a.fields=e.returnFields),r(e,"type")&&(a.type=e.type),r(e,"take")&&(a.take=e.take),r(e,"range")&&(a.range=e.range),r(e,"soundex")&&(a.soundex=e.soundex),r(e,"sort")&&(a.sort=e.sort),r(e,"set")&&(a.set=t?n.set(e.set,i):n.set(e.set)),r(e,"takeFrom")&&(e.takeFrom.conditions?(a.takeFrom=e.takeFrom,a.takeFrom.condition=n.searchConditionsFormat(e.takeFrom.conditions)):a.takeFrom=e.takeFrom),a}if(r(e,"tables")&&e.tables instanceof Array){var c={};return c.from={table:e.tables[0]},r(e,["returnFields","opiks"])?c.fields=n.searchFieldsFormat(e.opiks,e.returnFields):r(e,"opiks")?c.fields=n.searchFieldsFormat(e.opiks):r(e,"returnFields")&&(1===e.returnFields.length&&"all"===e.returnFields[0].trim()?c.fields="*":c.fields=e.returnFields),r(e,"type")&&(c.type=e.type),r(e,"take")&&(c.take=e.take),r(e,"range")&&(c.range=e.range),r(e,"soundex")&&(c.soundex=e.soundex),r(e,"sort")&&(c.sort=e.sort),r(e,"set")&&(c.set=t?n.set(e.set,i):n.set(e.set)),r(e,"takeFrom")&&(e.takeFrom.conditions?(c.takeFrom=e.takeFrom,c.takeFrom.condition=n.searchConditionsFormat(e.takeFrom.conditions)):c.takeFrom=e.takeFrom),c}return null},Qt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("THE SELECT STATEMENT OPIKS OBJECT"),console.log(e),console.log(t);var n=this,o=(n.pao.pa_contains,e),r="",i=t?t.join(","):"",s="",a="",c=[],l=i.indexOf("all")>=0,u=!1;console.log("THE OTHER FIELDS"),console.log(i),console.log(i.indexOf("all")>=0);for(var h=0;h<o.length&&((o[h].indexOf("fuxin")>=0||o[h].indexOf("field")>=0)&&c.push(!0),!(c.length>1));h++);return o.forEach((function(e,s){var h=n.fieldFormat(e);h instanceof Object?r=h.value.toUpperCase():(console.log("THE FORMATED"),console.log(h),console.log(l),console.log(i),s===o.length-1&&(u=!0),a+=l?c&&s!==o.length-1?"".concat(h,","):h:u&&null===t?"".concat(h):"".concat(h,","))})),!0===l&&(s="*,"),l?"".concat(s," ").concat(r," ").concat(a):"".concat(s," ").concat(r," ").concat(a," ").concat(i)},Vt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("THE SELECT STATEMENT OPIKS OBJECT FIELD FORMAT"),console.log(e);var n=this,o=(n.pao.pa_contains,""),r=e.lastIndexOf(".as")>=0?e.lastIndexOf(".as"):e.length;e.indexOf(".options[fuxin")>=0&&(o=e.slice(e.indexOf(".options[fuxin"),r)),console.log("THE NESTEDINTFUXIN"),console.log(o),console.log(e),""!==o.trim()&&(e=e.substr(0,e.indexOf(o)));var i=e.trim().split(".");""!==o.trim()&&i.push(o),console.log("THE FIELD LIST"),console.log(i);var s=null,a="fuxin"===i[0]&&i.length>3?"AS ".concat(n.options("".concat(i[3]),"as")):" ";switch(console.log("THE as"),console.log(a),i[0]){case"keyword":s=t?i[1].toUpperCase():{statement:"keyword",value:i[1].toUpperCase()};break;case"fuxin":s=" ".concat(i[1].toUpperCase(),"(").concat(n.options("".concat(i[2]),"option"),") ").concat(a," ");break;case"field":3===i.length&&(s="".concat(i[1]," AS ").concat(n.options(i[2],"as")));break;default:s=""}return s.trim()},zt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this;n.pao.pa_contains;if(console.log("THE CURRENT OPTION"),console.log(e),"undefined"===e)return console.log("THE OPTION IS UNDEFINED"),console.log(e),"";var o=e.slice(e.indexOf("[")+1,e.lastIndexOf("]"));if(console.log("OPTIONS: STRIPEDOPTION"),console.log(o),"as"===t)return"".concat(o);if("option"===t){var r=o.split(",");return r instanceof Array&&r.length>1?r[0].indexOf("keyword")>=0?n.fieldFormat(r[0],!0):r[0].indexOf("fuxin")>=0?r[1]?"".concat(n.fieldFormat(r[0]),",").concat(r[1].trim()):n.fieldFormat(r[0]):"".concat(o):r.join(",")}},Yt=function(e){console.log("THE SORT GOT A RESPONSE"),console.log(e);var t=e.split("."),n=e.slice(e.indexOf("[")+1,e.lastIndexOf("]")),o="";return t[0].indexOf("order")>=0?o=t.length>1&&"DESC"===t[1].toUpperCase()?"ORDER BY ".concat(n," DESC"):"ORDER BY ".concat(n):t[0].indexOf("group")>=0&&(o=t.length>1&&"DESC"===t[1].toUpperCase()?"GROUP BY ".concat(n," DESC"):"GROUP BY ".concat(n," ASC")),o},Xt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="";if("take"===t)n="LIMIT ".concat(e);else if("range"===t){var o=e.split(","),r=o[0],i=o[1];n="LIMIT ".concat(i," OFFSET ").concat(r)}return n},Zt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this,o=n.pao,r=o.pa_isObject,i="",s="",a=n.conditionsConnector(e);if(console.log("THE RES VALUE"),console.log(a),r(a)&&(console.log("THE RES IS AN OBJECT"),console.log(a),e=a.condixion,s=a.connector),0===e.trim().indexOf("GROUP::")){console.log("THE GROUP:: string is the first");var c=e.replace("GROUP::","").trim(),l="",u="";if(console.log("THE extracted string"),console.log(c),"number"==typeof parseInt(c[0])&&(console.log("extStr type is a number"),parseInt(c[0]),0===(l=c.slice(1).trim()).indexOf("START")||0===l.indexOf("$"))){u=l.replace("START","").trim(),console.log(l);var h="",f=[];console.log("PARSEGROUP EXECUTES THIS FAR"),console.log(u),1===t?(h=u.split(";"),console.log("LEVEL 1 GROUPCONS"),console.log(h),f=h.map((function(e,t){return console.log("THE C CONDITION"),console.log(e),console.log(e.indexOf("GROUP::")),e.indexOf("GROUP::")>=0?n.parseGroup(e,2):n.parseFormatCondition(e)}))):2===t?(h=u.split(","),console.log("LEVEL 2 GROUPCONS"),console.log(h),f=h.map((function(e,t){return e.indexOf("GROUP::")>=0?n.parseGroup(e,3):n.parseFormatCondition(e)}))):3===t&&(f=(h=u.split("|")).map((function(e,t){return n.parseFormatCondition(e)}))),console.log("GROUPED"),console.log(f),console.log(h),i="".concat(s," (").concat(f.join(" "),")")}}return console.log("THE FULL GROUPED CONDITION TO BE RETURNED:"),console.log(i),i},$t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;n.pao;if(t){var o=e,r=[];return o.forEach((function(e,t){var n=e.trim().match(/(\[[^\]]+\]|\S+)/g);r.push("".concat(n[0]," ").concat("="," ").concat(n[2]))})),console.log("THE search ON CONDITION"),console.log(r),r}var i="";console.log("THE con ITEM"),console.log(e);var s=e.trim().match(/(\[[^\]]+\]|\S+)/g);console.log("THE CONLIST"),console.log(s);var a="",c="",l=!1,u=!1,h=!1,f=" ";if("MATCH"===s[0].trim()||"MATCH"===s[1].trim()||"FUXIN"===s[1].trim()||"FUXIN"===s[2].trim())if(s.indexOf("AGAINST")>0&&s.length>=5){var d=s.slice(0);console.log("THE O CON"),console.log(d);var p="",g="";(l="MATCH"!==d[0].trim().toUpperCase())?(p=d[2].trim(),g=d[4].trim()):(p=d[1].trim(),g=d[3].trim()),"["===p[0]&&(p=p.slice(1,p.length-1)),"["===g[0]&&(g=g.slice(1,g.length-1)),console.log("THE MATCH FIELDS"),console.log(p);var m="";a=l?d[3].trim():d[2].trim();var E=l?d[5]:d[4];switch(E){case"BOOLEAN":m='AGAINST ("'.concat(g,'"" IN BOOLEAN MODE) ');break;case"QUERY":m='AGAINST ("'.concat(g,'" IN QUERY EXPRESSION MODE) ');break;default:m='AGAINST ("'.concat(g,'" IN NATURAL LANGUAGE MODE) ')}s[0]=l?"".concat(d[0]," MATCH (").concat(p,") ").concat(m):"MATCH (".concat(p,") ").concat(m),u=!0}else{var v=s.slice(0);h=!0,console.log("THE O CON::FUXIN"),console.log(v);var O=(l="FUXIN"!==v[1].trim().toUpperCase())?3:2,y=v.splice(O);if(v.push(y.join(" ")),console.log(O),console.log(v),v[O].indexOf("[")>=0){console.log("OTHER CONTENT IS IN THE SQUARE BRACKETS");var b=v[O].slice(1,v[O].length-1);b=b.trim(),console.log("AFTER THE STRIPED HAS BEEN TRIMMED"),console.log(b);var T=b.substr(0,b.indexOf(" ")),S=b.substr(b.indexOf(" ")+1);console.log("THE SPLITFUXINCONS"),console.log(T),console.log(S);var R=n.getOperand(T),w=n.fieldFormat(S);console.log(R),console.log(w),i=l?"".concat(v[0]," ").concat(v[1]," ").concat(R," ").concat(w):"".concat(v[0]," ").concat(R," ").concat(w),console.log("THE CONDITION IN FUXIN TEST"),console.log(i)}}else{var N=s.slice(0);console.log("THE O CON"),console.log(N);var I=N[0].trim().toUpperCase(),k=(l="AND"===I||"OR"===I||"NOT"===I)?s[2]:s[1];console.log("THE MULTICON STATUS:::"),console.log(l),console.log(N),a=n.getOperand(k),c="["===(c=l?s[3]:s[2])[0]?"'".concat(c.slice(1,c.length-1),"'"):c.indexOf("KEY::")>=0?"".concat(c.replace("KEY::","").trim()):"'".concat(c,"'"),console.log("THE VALUE OF THE LEFFFFFT OPERAND"),console.log(c),console.log(c.indexOf("KEY::"))}return h||(i+=u?"".concat(s[0]):l?"".concat(f," ").concat(s[0]," ").concat(s[1]," ").concat(a," ").concat(c):"".concat(s[0]," ").concat(a," ").concat(c)),console.log("THE search FROM CONDITION"),console.log(i),i},en=function(e){var t="";switch(e){case"EQUALS":t="=";break;case"ISGREATEROREQUALS":t=">=";break;case"ISLESSOREQUALS":t="<=";break;case"ISLIKE":t="LIKE";break;case"ISIN":t="IN";break;case"ISREGEX":t="REGEXP";break;case"ISNOT":t="NOT";break;case"ISNOTNULL":t="IS NOT NULL";break;case"ISNULL":t="IS NULL";break;default:t="="}return t},tn=function(e){var t={};return console.log("THE INDEX OF GROUP:: IN CONDITIONS CONNECTOR"),console.log(e.trim().indexOf("GROUP::")),console.log(e),e.trim().indexOf("GROUP::")>0?(console.log("THE INDEX OF GROUP IS AT ONE"),0===e.trim().indexOf("AND")?(t.connector=" AND",t.condixion=e.replace("AND","").trim()):0===e.trim().indexOf("OR")?(t.connector=" OR",t.condixion=e.replace("OR","").trim()):0===e.trim().indexOf("NOT")&&(t.connector=" NOT",t.condixion=e.replace("NOT","").trim()),t):e},nn=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,o=n.pao,r=o.pa_objectToArray;n.log("THE SET"),n.log(e),n.log(t);var i="";return e.forEach((function(n,o){var s="",a=r(n,!0);console.log("THE CONVERTED SET OBJECT"),console.log(a),a.forEach((function(e,n){s+=t?n===a.length-1?"".concat(t[o],".").concat(e.key,' = "').concat(e.value,'"'):"".concat(t[o],".").concat(e.key,' = "').concat(e.value,'", '):n===a.length-1?"".concat(e.key,' = "').concat(e.value,'"'):"".concat(e.key,' = "').concat(e.value,'", ')})),i+=o===e.length-1?"".concat(s):"".concat(s,", ")})),console.log("THE SETSTRINGS"),console.log(i),i};var on=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.init=ft,this.handleMysqlDataRequest=dt,this.insertOne=pt,this.insertMany=gt,this.find=mt,this.remove=Nt,this.updateOne=Et,this.set=nn,this.queryOptions=It,this.queryTemplate=kt,this.TRANSACTION=_t,this.PROCEDURE=Ht,this.JOIN=Ft,this.SEARCH=Pt,this.procedure=Ct,this.transaction=At,this.join=Dt,this.joinExek=Mt,this.joinStatement=Bt,this.joinConditionsFormat=Ut,this.search=xt,this.searchExek=Jt,this.searchStatement=Wt,this.searchConditionsFormat=Gt,this.searchOptions=Kt,this.combineFields=Lt,this.insert=jt,this.rollback=qt,this.searchFieldsFormat=Qt,this.fieldFormat=Vt,this.options=zt,this.sort=Yt,this.limit=Xt,this.parseGroup=Zt,this.parseFormatCondition=$t,this.getOperand=en,this.conditionsConnector=tn,this.updateandtake=vt,this.insertandtake=Ot,this.deleteandtake=yt,this.updateJoinTemplate=bt,this.multiTableUpdate=Tt,this.take=St,this.takeSql=Rt,this.removeJoin=wt},rn=function(){console.log("Dao has been initialised"),this.listens({"dao-take-dbs":this.handleDaoTakeDbs.bind(this),"data-hive-request":this.handleDataHiveRequest.bind(this)})},sn=function(e){var t=this.pao;if(console.log("DAO"),console.log(e),!t.pa_contains(this.DBS,e.model.vendor))throw new Error("Specified database client is unknown");var n=e.model;this.emit({type:"".concat(n.vendor,"-data-request"),data:{conn:this.DBS[n.vendor],table:n.table,opi:n.operation,query:e.document,outComehandler:e.handler}})},an=function(e){this.log("Handling Hive Request"),null===this.DBS?(this.DBS={},this.DBS[e.vendor]=e.conn):this.DBS[e.vendor]=e.conn};var cn=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.DBS=null,this.init=rn,this.handleDataHiveRequest=sn,this.handleDaoTakeDbs=an},ln=function(){this.log("Dman has been initialised"),this.listens({"config-dman":this.handleConfigureDBMan.bind(this)})},un=function(e){var t=this,n=t.pao;if(console.log("THE DBMAN HANLDECONFIGURE"),console.log("THE SUPPORTED CLIENTS"),console.log(t.supportedClients),n.pa_isObject(e))if(n.pa_contains(e,"clients"))if(n.pa_isArray(e.clients)){var o=t.supportedClients;try{e.clients.forEach((function(e,r){n.pa_contains(o,e.name)?t.connectToClient(e):t.throwError('Client: "'.concat(e.name,' is not supported by the system"'))})),t.DBS.length>0&&(t.log("Sending databases to the dao"),t.emit({type:"dao-take-dbs",data:{dbs:t.DBS}}))}catch(e){}}else;else t.error("System requires clients property with valid config to interface with database clients");else t.log("No Client database client specified,System will use default","warn")},hn=function(e){this.log("System is about to connect to client: ".concat(e.name)),this.getClientDriver(e)},fn=function(e){console.log("System is getting a client driver"),console.log("THE OTHER DETAILS BELOW"),console.log(e.name),console.log("mysql"===e.name);try{"mysql"===e.name&&(this.supportedClients[e.name].driver=n(21)),this.supportedClients[e.name].driver||(console.log("THE DRIVER REQUIREMENT FAILED"),this.throwError("Failed to get client driver module")),this.connect(e)}catch(e){console.log("THE DRIVER CONNECT ERROR"),console.log(e.stack)}},dn=function(e){var t=this;t.log("System is connecting to client: ".concat(e.name));try{var n=t.supportedClients[e.name],o={host:e.connect.host,user:e.connect.user,password:e.connect.pass,database:e.connect.name},r=n.driver[n.connectMethod](o,(function(n,o){n?(console.log("THE ACTUAL CONNECTION ERROR"),console.log(n.stack)):(t.DBS[e.name]=o,t.log("System has successfully connected to client"),t.log("Client ready to serve queries"))}));r.connect((function(n){if(n)throw new Error(n);t.DBS[e.name]=r,t.log("System has successfully connected to client"),t.log("System is handing client connection"),t.emit({type:"dao-take-dbs",data:{vendor:e.name,conn:r}}),t.log("Client ready to serve queries")}))}catch(e){console.log("THE CONNECTION EROR"),console.log(e.stack)}};var pn=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.DBS=[],this.supportedClients={mysql:{protocol:"",connectMethod:"createConnection"}},this.init=ln,this.handleConfigureDBMan=un,this.connectToClient=hn,this.getClientDriver=fn,this.connect=dn},gn=function(){console.log("Global has been initialised"),this.listens({"request-global-request":this.handleRequestGlobalRequest.bind(this)})},mn=function(e){this.log("The Modules: ",this.globals),this.globals&&this.globals.length>0?this.globals.indexOf(e)>-1?this.emit({type:"request-global-request-response",data:!0}):this.emit({type:"request-global-request-response",data:!1}):this.emit({type:"request-global-request-error",data:!1})};var En=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pao=t,this.globals=[],this.init=gn,this.handleRequestGlobalRequest=mn};var vn=new function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Esm={Anziiloger:Je,Mysql:on,System:ot,Middleware:b,Parsers:I,Router:W,Request:ae,Dao:cn,Dman:pn,Server:Se,Config:Ce,Global:En}};function On(e){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var yn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=new this.ANZII.CORE(this.ANZII.PILLAR),n=new this.ANZII.PAO(t),o={Anziiloger:this.ESM.Esm.Anziiloger};delete this.ESM.Esm.Anziiloger,e.unshift(o),console.log("THE CORE"),console.log(e),e.push(this.ESM.Esm),e.forEach((function(e){for(var o in e){console.log("THE LIB MOCO"),console.log(On(e[o])),console.log(e[o]);var r=o.toLowerCase(),i=r;t.createModule(new e[o](n.create(r,null)),r,i),t.startModule(r,i)}}))};t.default=new function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);this.ANZII=f,this.ESM=vn,this.Activate=yn}}]);
>>>>>>> config
